04/23/2025 10:17:59 - INFO - Started script at: 2025-04-23-10-17
Current working dir: /workspace
Used data files: 
/workspace/data/datasets/cic_ids/cic-ids-2017/clean/all_benign.feather,
/workspace/data/datasets/cic_ids/cic-ids-2017/clean/all_malicious.feather
04/23/2025 10:17:59 - INFO - Setting up Attacker and Defender Agents...
04/23/2025 10:18:22 - INFO - One-vs-All Split ready (target: Web Attack):
04/23/2025 10:18:22 - INFO - Train: (50062, 67), Validation: (30119, 67), Test: (170676, 67)
04/23/2025 10:18:22 - INFO - [Init from split] Loaded 50062 train, 170676 test samples.
04/23/2025 10:18:24 - INFO - One-vs-All Split ready (target: Web Attack):
04/23/2025 10:18:24 - INFO - Train: (50049, 67), Validation: (60628, 67), Test: (141466, 67)
04/23/2025 10:18:24 - INFO - Initializing Attacker:CIC-2017-Web Attack's ReplayMemory with observation_size=67 and max_size=1000
04/23/2025 10:18:25 - WARNING - Skipping variable loading for optimizer 'Adam', because it has 25 variables whereas the saved optimizer has 1 variables. 
04/23/2025 10:18:25 - INFO - Initializing Defender's ReplayMemory with observation_size=67 and max_size=1000
04/23/2025 10:18:25 - WARNING - Skipping variable loading for optimizer 'Adam', because it has 17 variables whereas the saved optimizer has 1 variables. 
04/23/2025 10:18:25 - INFO - Creating environment...
04/23/2025 10:18:25 - INFO - Start Training with the following parameters:
-----------------------------------------------------------------------------------------------------------------------
Total episodes: 100 | Iterations in episode: 100 | Minibatch from mem size: 100 | Total Samples: 10000 | Data shape: (50062, 67)
-----------------------------------------------------------------------------------------------------------------------
Attacker<Attack-Type>: Num_actions=4 | gamma=0.001 | epsilon=1 | ANN hidden size=100 | ANN hidden layers=5 | Learning rate=0.001
-----------------------------------------------------------------------------------------------------------------------
Defender: Num_actions=2 | gamma=0.001 | epsilon=1 | ANN hidden size=100 | ANN hidden layers=3 | Learning rate=0.001
-----------------------------------------------------------------------------------------------------------------------
Used Attack types: '['Benign', 'Web Attack']' | Attack name(s): ['Benign', 'Brute Force Web', 'Brute Force XSS', 'SQL Injection']
-----------------------------------------------------------------------------------------------------------------------

04/23/2025 10:18:26 - INFO - End of Episode.
|Episode 000/100| time: 0.32|
|Def Loss 0.0000 | Def Reward in ep 043|
|Att Loss 0.0000 | Att Reward in ep 057|
|Def Estimated: [52 48]| Att Labels: [19 81]|
|Def Amount of true predicted attacks: [ 7 36]|
04/23/2025 10:18:29 - WARNING - 5 out of the last 5 calls to <function QNetwork.predict at 0x73f640773380> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
04/23/2025 10:18:30 - INFO - End of Episode.
|Episode 001/100| time: 3.76|
|Def Loss 1.4684 | Def Reward in ep 055|
|Att Loss 3.0119 | Att Reward in ep 045|
|Def Estimated: [36 64]| Att Labels: [31 69]|
|Def Amount of true predicted attacks: [11 44]|
04/23/2025 10:18:33 - INFO - End of Episode.
|Episode 002/100| time: 1.93|
|Def Loss 0.7313 | Def Reward in ep 072|
|Att Loss 2.7423 | Att Reward in ep 028|
|Def Estimated: [38 62]| Att Labels: [36 64]|
|Def Amount of true predicted attacks: [23 49]|
04/23/2025 10:18:35 - INFO - End of Episode.
|Episode 003/100| time: 1.99|
|Def Loss 0.6958 | Def Reward in ep 089|
|Att Loss 2.6339 | Att Reward in ep 011|
|Def Estimated: [42 58]| Att Labels: [39 61]|
|Def Amount of true predicted attacks: [35 54]|
04/23/2025 10:18:37 - INFO - End of Episode.
|Episode 004/100| time: 1.98|
|Def Loss 0.5819 | Def Reward in ep 090|
|Att Loss 2.4449 | Att Reward in ep 010|
|Def Estimated: [36 64]| Att Labels: [36 64]|
|Def Amount of true predicted attacks: [31 59]|
04/23/2025 10:18:39 - INFO - End of Episode.
|Episode 005/100| time: 2.02|
|Def Loss 0.5704 | Def Reward in ep 092|
|Att Loss 2.2112 | Att Reward in ep 008|
|Def Estimated: [26 74]| Att Labels: [34 66]|
|Def Amount of true predicted attacks: [26 66]|
04/23/2025 10:18:41 - INFO - End of Episode.
|Episode 006/100| time: 1.93|
|Def Loss 0.5033 | Def Reward in ep 098|
|Att Loss 1.9966 | Att Reward in ep 002|
|Def Estimated: [30 70]| Att Labels: [32 68]|
|Def Amount of true predicted attacks: [30 68]|
04/23/2025 10:18:43 - INFO - End of Episode.
|Episode 007/100| time: 1.87|
|Def Loss 0.3887 | Def Reward in ep 096|
|Att Loss 1.7972 | Att Reward in ep 004|
|Def Estimated: [25 75]| Att Labels: [27 73]|
|Def Amount of true predicted attacks: [24 72]|
04/23/2025 10:18:46 - INFO - End of Episode.
|Episode 008/100| time: 2.17|
|Def Loss 0.2346 | Def Reward in ep 099|
|Att Loss 1.6116 | Att Reward in ep 001|
|Def Estimated: [33 67]| Att Labels: [34 66]|
|Def Amount of true predicted attacks: [33 66]|
04/23/2025 10:18:48 - INFO - End of Episode.
|Episode 009/100| time: 1.99|
|Def Loss 0.1729 | Def Reward in ep 099|
|Att Loss 1.5267 | Att Reward in ep 001|
|Def Estimated: [29 71]| Att Labels: [30 70]|
|Def Amount of true predicted attacks: [29 70]|
04/23/2025 10:18:50 - INFO - End of Episode.
|Episode 010/100| time: 1.97|
|Def Loss 0.1653 | Def Reward in ep 095|
|Att Loss 1.2844 | Att Reward in ep 005|
|Def Estimated: [20 80]| Att Labels: [23 77]|
|Def Amount of true predicted attacks: [19 76]|
04/23/2025 10:18:52 - INFO - End of Episode.
|Episode 011/100| time: 2.18|
|Def Loss 0.1880 | Def Reward in ep 098|
|Att Loss 0.7654 | Att Reward in ep 002|
|Def Estimated: [39 61]| Att Labels: [37 63]|
|Def Amount of true predicted attacks: [37 61]|
04/23/2025 10:18:55 - INFO - End of Episode.
|Episode 012/100| time: 2.29|
|Def Loss 0.1795 | Def Reward in ep 100|
|Att Loss 0.4036 | Att Reward in ep 000|
|Def Estimated: [28 72]| Att Labels: [28 72]|
|Def Amount of true predicted attacks: [28 72]|
04/23/2025 10:18:57 - INFO - End of Episode.
|Episode 013/100| time: 2.12|
|Def Loss 0.1757 | Def Reward in ep 099|
|Att Loss 0.2582 | Att Reward in ep 001|
|Def Estimated: [30 70]| Att Labels: [29 71]|
|Def Amount of true predicted attacks: [29 70]|
04/23/2025 10:18:59 - INFO - End of Episode.
|Episode 014/100| time: 2.13|
|Def Loss 0.2023 | Def Reward in ep 100|
|Att Loss 0.1781 | Att Reward in ep 000|
|Def Estimated: [34 66]| Att Labels: [34 66]|
|Def Amount of true predicted attacks: [34 66]|
04/23/2025 10:19:02 - INFO - End of Episode.
|Episode 015/100| time: 2.05|
|Def Loss 0.1386 | Def Reward in ep 099|
|Att Loss 0.1198 | Att Reward in ep 001|
|Def Estimated: [34 66]| Att Labels: [33 67]|
|Def Amount of true predicted attacks: [33 66]|
04/23/2025 10:19:04 - INFO - End of Episode.
|Episode 016/100| time: 2.01|
|Def Loss 0.1177 | Def Reward in ep 100|
|Att Loss 0.1195 | Att Reward in ep 000|
|Def Estimated: [29 71]| Att Labels: [29 71]|
|Def Amount of true predicted attacks: [29 71]|
04/23/2025 10:19:06 - INFO - End of Episode.
|Episode 017/100| time: 1.98|
|Def Loss 0.1089 | Def Reward in ep 100|
|Att Loss 0.0693 | Att Reward in ep 000|
|Def Estimated: [26 74]| Att Labels: [26 74]|
|Def Amount of true predicted attacks: [26 74]|
04/23/2025 10:19:08 - INFO - End of Episode.
|Episode 018/100| time: 1.92|
|Def Loss 0.0892 | Def Reward in ep 100|
|Att Loss 0.0659 | Att Reward in ep 000|
|Def Estimated: [18 82]| Att Labels: [18 82]|
|Def Amount of true predicted attacks: [18 82]|
04/23/2025 10:19:11 - INFO - End of Episode.
|Episode 019/100| time: 1.98|
|Def Loss 0.0662 | Def Reward in ep 100|
|Att Loss 0.0491 | Att Reward in ep 000|
|Def Estimated: [33 67]| Att Labels: [33 67]|
|Def Amount of true predicted attacks: [33 67]|
04/23/2025 10:19:13 - INFO - End of Episode.
|Episode 020/100| time: 1.97|
|Def Loss 0.0688 | Def Reward in ep 098|
|Att Loss 0.0649 | Att Reward in ep 002|
|Def Estimated: [28 72]| Att Labels: [28 72]|
|Def Amount of true predicted attacks: [27 71]|
04/23/2025 10:19:15 - INFO - End of Episode.
|Episode 021/100| time: 1.99|
|Def Loss 0.0358 | Def Reward in ep 099|
|Att Loss 0.0453 | Att Reward in ep 001|
|Def Estimated: [30 70]| Att Labels: [31 69]|
|Def Amount of true predicted attacks: [30 69]|
04/23/2025 10:19:17 - INFO - End of Episode.
|Episode 022/100| time: 1.97|
|Def Loss 0.0706 | Def Reward in ep 098|
|Att Loss 0.0503 | Att Reward in ep 002|
|Def Estimated: [28 72]| Att Labels: [30 70]|
|Def Amount of true predicted attacks: [28 70]|
04/23/2025 10:19:20 - INFO - End of Episode.
|Episode 023/100| time: 1.98|
|Def Loss 0.0523 | Def Reward in ep 099|
|Att Loss 0.0471 | Att Reward in ep 001|
|Def Estimated: [26 74]| Att Labels: [25 75]|
|Def Amount of true predicted attacks: [25 74]|
04/23/2025 10:19:22 - INFO - End of Episode.
|Episode 024/100| time: 1.99|
|Def Loss 0.0613 | Def Reward in ep 100|
|Att Loss 0.0388 | Att Reward in ep 000|
|Def Estimated: [33 67]| Att Labels: [33 67]|
|Def Amount of true predicted attacks: [33 67]|
04/23/2025 10:19:24 - INFO - End of Episode.
|Episode 025/100| time: 2.00|
|Def Loss 0.0431 | Def Reward in ep 100|
|Att Loss 0.0369 | Att Reward in ep 000|
|Def Estimated: [24 76]| Att Labels: [24 76]|
|Def Amount of true predicted attacks: [24 76]|
04/23/2025 10:19:26 - INFO - End of Episode.
|Episode 026/100| time: 1.97|
|Def Loss 0.0350 | Def Reward in ep 100|
|Att Loss 0.0156 | Att Reward in ep 000|
|Def Estimated: [26 74]| Att Labels: [26 74]|
|Def Amount of true predicted attacks: [26 74]|
04/23/2025 10:19:29 - INFO - End of Episode.
|Episode 027/100| time: 2.03|
|Def Loss 0.0448 | Def Reward in ep 099|
|Att Loss 0.0352 | Att Reward in ep 001|
|Def Estimated: [28 72]| Att Labels: [27 73]|
|Def Amount of true predicted attacks: [27 72]|
04/23/2025 10:19:31 - INFO - End of Episode.
|Episode 028/100| time: 1.98|
|Def Loss 0.0337 | Def Reward in ep 099|
|Att Loss 0.0500 | Att Reward in ep 001|
|Def Estimated: [26 74]| Att Labels: [27 73]|
|Def Amount of true predicted attacks: [26 73]|
04/23/2025 10:19:33 - INFO - End of Episode.
|Episode 029/100| time: 2.01|
|Def Loss 0.0489 | Def Reward in ep 100|
|Att Loss 0.0486 | Att Reward in ep 000|
|Def Estimated: [30 70]| Att Labels: [30 70]|
|Def Amount of true predicted attacks: [30 70]|
04/23/2025 10:19:35 - INFO - End of Episode.
|Episode 030/100| time: 2.00|
|Def Loss 0.0544 | Def Reward in ep 100|
|Att Loss 0.0304 | Att Reward in ep 000|
|Def Estimated: [30 70]| Att Labels: [30 70]|
|Def Amount of true predicted attacks: [30 70]|
04/23/2025 10:19:38 - INFO - End of Episode.
|Episode 031/100| time: 1.96|
|Def Loss 0.0273 | Def Reward in ep 099|
|Att Loss 0.0415 | Att Reward in ep 001|
|Def Estimated: [25 75]| Att Labels: [24 76]|
|Def Amount of true predicted attacks: [24 75]|
04/23/2025 10:19:40 - INFO - End of Episode.
|Episode 032/100| time: 1.99|
|Def Loss 0.0222 | Def Reward in ep 100|
|Att Loss 0.0365 | Att Reward in ep 000|
|Def Estimated: [27 73]| Att Labels: [27 73]|
|Def Amount of true predicted attacks: [27 73]|
04/23/2025 10:19:42 - INFO - End of Episode.
|Episode 033/100| time: 1.97|
|Def Loss 0.0385 | Def Reward in ep 098|
|Att Loss 0.0446 | Att Reward in ep 002|
|Def Estimated: [25 75]| Att Labels: [27 73]|
|Def Amount of true predicted attacks: [25 73]|
04/23/2025 10:19:45 - INFO - End of Episode.
|Episode 034/100| time: 2.17|
|Def Loss 0.0644 | Def Reward in ep 098|
|Att Loss 0.0521 | Att Reward in ep 002|
|Def Estimated: [24 76]| Att Labels: [22 78]|
|Def Amount of true predicted attacks: [22 76]|
04/23/2025 10:19:47 - INFO - End of Episode.
|Episode 035/100| time: 2.16|
|Def Loss 0.0784 | Def Reward in ep 099|
|Att Loss 0.0621 | Att Reward in ep 001|
|Def Estimated: [26 74]| Att Labels: [27 73]|
|Def Amount of true predicted attacks: [26 73]|
04/23/2025 10:19:50 - INFO - End of Episode.
|Episode 036/100| time: 2.41|
|Def Loss 0.0845 | Def Reward in ep 100|
|Att Loss 0.0473 | Att Reward in ep 000|
|Def Estimated: [28 72]| Att Labels: [28 72]|
|Def Amount of true predicted attacks: [28 72]|
04/23/2025 10:19:53 - INFO - End of Episode.
|Episode 037/100| time: 2.40|
|Def Loss 0.0881 | Def Reward in ep 097|
|Att Loss 0.0932 | Att Reward in ep 003|
|Def Estimated: [28 72]| Att Labels: [27 73]|
|Def Amount of true predicted attacks: [26 71]|
04/23/2025 10:19:55 - INFO - End of Episode.
|Episode 038/100| time: 2.14|
|Def Loss 0.0882 | Def Reward in ep 097|
|Att Loss 0.0724 | Att Reward in ep 003|
|Def Estimated: [33 67]| Att Labels: [32 68]|
|Def Amount of true predicted attacks: [31 66]|
04/23/2025 10:19:58 - INFO - End of Episode.
|Episode 039/100| time: 2.19|
|Def Loss 0.1265 | Def Reward in ep 099|
|Att Loss 0.0969 | Att Reward in ep 001|
|Def Estimated: [31 69]| Att Labels: [32 68]|
|Def Amount of true predicted attacks: [31 68]|
04/23/2025 10:20:00 - INFO - End of Episode.
|Episode 040/100| time: 2.25|
|Def Loss 0.1147 | Def Reward in ep 100|
|Att Loss 0.0892 | Att Reward in ep 000|
|Def Estimated: [24 76]| Att Labels: [24 76]|
|Def Amount of true predicted attacks: [24 76]|
04/23/2025 10:20:03 - INFO - End of Episode.
|Episode 041/100| time: 2.11|
|Def Loss 0.1617 | Def Reward in ep 099|
|Att Loss 0.0868 | Att Reward in ep 001|
|Def Estimated: [29 71]| Att Labels: [30 70]|
|Def Amount of true predicted attacks: [29 70]|
04/23/2025 10:20:05 - INFO - End of Episode.
|Episode 042/100| time: 2.17|
|Def Loss 0.1442 | Def Reward in ep 098|
|Att Loss 0.0794 | Att Reward in ep 002|
|Def Estimated: [31 69]| Att Labels: [31 69]|
|Def Amount of true predicted attacks: [30 68]|
04/23/2025 10:20:08 - INFO - End of Episode.
|Episode 043/100| time: 2.15|
|Def Loss 0.1624 | Def Reward in ep 099|
|Att Loss 0.1085 | Att Reward in ep 001|
|Def Estimated: [30 70]| Att Labels: [31 69]|
|Def Amount of true predicted attacks: [30 69]|
04/23/2025 10:20:10 - INFO - End of Episode.
|Episode 044/100| time: 2.22|
|Def Loss 0.1741 | Def Reward in ep 099|
|Att Loss 0.1116 | Att Reward in ep 001|
|Def Estimated: [35 65]| Att Labels: [36 64]|
|Def Amount of true predicted attacks: [35 64]|
04/23/2025 10:20:13 - INFO - End of Episode.
|Episode 045/100| time: 2.14|
|Def Loss 0.1203 | Def Reward in ep 099|
|Att Loss 0.0920 | Att Reward in ep 001|
|Def Estimated: [36 64]| Att Labels: [35 65]|
|Def Amount of true predicted attacks: [35 64]|
04/23/2025 10:20:15 - INFO - End of Episode.
|Episode 046/100| time: 2.13|
|Def Loss 0.1266 | Def Reward in ep 099|
|Att Loss 0.0979 | Att Reward in ep 001|
|Def Estimated: [39 61]| Att Labels: [38 62]|
|Def Amount of true predicted attacks: [38 61]|
04/23/2025 10:20:18 - INFO - End of Episode.
|Episode 047/100| time: 2.13|
|Def Loss 0.1411 | Def Reward in ep 099|
|Att Loss 0.0920 | Att Reward in ep 001|
|Def Estimated: [35 65]| Att Labels: [36 64]|
|Def Amount of true predicted attacks: [35 64]|
04/23/2025 10:20:20 - INFO - End of Episode.
|Episode 048/100| time: 2.09|
|Def Loss 0.1165 | Def Reward in ep 099|
|Att Loss 0.0887 | Att Reward in ep 001|
|Def Estimated: [33 67]| Att Labels: [32 68]|
|Def Amount of true predicted attacks: [32 67]|
04/23/2025 10:20:23 - INFO - End of Episode.
|Episode 049/100| time: 2.07|
|Def Loss 0.0758 | Def Reward in ep 100|
|Att Loss 0.0544 | Att Reward in ep 000|
|Def Estimated: [28 72]| Att Labels: [28 72]|
|Def Amount of true predicted attacks: [28 72]|
04/23/2025 10:20:25 - INFO - End of Episode.
|Episode 050/100| time: 2.07|
|Def Loss 0.1281 | Def Reward in ep 099|
|Att Loss 0.0560 | Att Reward in ep 001|
|Def Estimated: [32 68]| Att Labels: [33 67]|
|Def Amount of true predicted attacks: [32 67]|
04/23/2025 10:20:28 - INFO - End of Episode.
|Episode 051/100| time: 2.09|
|Def Loss 0.0893 | Def Reward in ep 100|
|Att Loss 0.0737 | Att Reward in ep 000|
|Def Estimated: [27 73]| Att Labels: [27 73]|
|Def Amount of true predicted attacks: [27 73]|
04/23/2025 10:20:30 - INFO - End of Episode.
|Episode 052/100| time: 2.03|
|Def Loss 0.0745 | Def Reward in ep 100|
|Att Loss 0.0533 | Att Reward in ep 000|
|Def Estimated: [31 69]| Att Labels: [31 69]|
|Def Amount of true predicted attacks: [31 69]|
04/23/2025 10:20:33 - INFO - End of Episode.
|Episode 053/100| time: 2.06|
|Def Loss 0.0635 | Def Reward in ep 099|
|Att Loss 0.0275 | Att Reward in ep 001|
|Def Estimated: [34 66]| Att Labels: [35 65]|
|Def Amount of true predicted attacks: [34 65]|
04/23/2025 10:20:35 - INFO - End of Episode.
|Episode 054/100| time: 2.04|
|Def Loss 0.0525 | Def Reward in ep 098|
|Att Loss 0.0617 | Att Reward in ep 002|
|Def Estimated: [32 68]| Att Labels: [30 70]|
|Def Amount of true predicted attacks: [30 68]|
04/23/2025 10:20:38 - INFO - End of Episode.
|Episode 055/100| time: 2.02|
|Def Loss 0.0524 | Def Reward in ep 099|
|Att Loss 0.0482 | Att Reward in ep 001|
|Def Estimated: [26 74]| Att Labels: [27 73]|
|Def Amount of true predicted attacks: [26 73]|
04/23/2025 10:20:40 - INFO - End of Episode.
|Episode 056/100| time: 2.04|
|Def Loss 0.1566 | Def Reward in ep 096|
|Att Loss 0.0405 | Att Reward in ep 004|
|Def Estimated: [32 68]| Att Labels: [34 66]|
|Def Amount of true predicted attacks: [31 65]|
04/23/2025 10:20:42 - INFO - End of Episode.
|Episode 057/100| time: 2.07|
|Def Loss 0.1026 | Def Reward in ep 098|
|Att Loss 0.0612 | Att Reward in ep 002|
|Def Estimated: [42 58]| Att Labels: [44 56]|
|Def Amount of true predicted attacks: [42 56]|
04/23/2025 10:20:45 - INFO - End of Episode.
|Episode 058/100| time: 2.05|
|Def Loss 0.0523 | Def Reward in ep 100|
|Att Loss 0.0809 | Att Reward in ep 000|
|Def Estimated: [35 65]| Att Labels: [35 65]|
|Def Amount of true predicted attacks: [35 65]|
04/23/2025 10:20:47 - INFO - End of Episode.
|Episode 059/100| time: 2.09|
|Def Loss 0.0597 | Def Reward in ep 099|
|Att Loss 0.0859 | Att Reward in ep 001|
|Def Estimated: [35 65]| Att Labels: [34 66]|
|Def Amount of true predicted attacks: [34 65]|
04/23/2025 10:20:50 - INFO - End of Episode.
|Episode 060/100| time: 2.04|
|Def Loss 0.0605 | Def Reward in ep 098|
|Att Loss 0.1006 | Att Reward in ep 002|
|Def Estimated: [40 60]| Att Labels: [38 62]|
|Def Amount of true predicted attacks: [38 60]|
04/23/2025 10:20:52 - INFO - End of Episode.
|Episode 061/100| time: 2.02|
|Def Loss 0.0490 | Def Reward in ep 099|
|Att Loss 0.0990 | Att Reward in ep 001|
|Def Estimated: [28 72]| Att Labels: [29 71]|
|Def Amount of true predicted attacks: [28 71]|
04/23/2025 10:20:55 - INFO - End of Episode.
|Episode 062/100| time: 2.04|
|Def Loss 0.0558 | Def Reward in ep 100|
|Att Loss 0.1087 | Att Reward in ep 000|
|Def Estimated: [36 64]| Att Labels: [36 64]|
|Def Amount of true predicted attacks: [36 64]|
04/23/2025 10:20:57 - INFO - End of Episode.
|Episode 063/100| time: 2.16|
|Def Loss 0.0545 | Def Reward in ep 097|
|Att Loss 0.0815 | Att Reward in ep 003|
|Def Estimated: [24 76]| Att Labels: [27 73]|
|Def Amount of true predicted attacks: [24 73]|
04/23/2025 10:21:00 - INFO - End of Episode.
|Episode 064/100| time: 2.13|
|Def Loss 0.0791 | Def Reward in ep 099|
|Att Loss 0.1129 | Att Reward in ep 001|
|Def Estimated: [30 70]| Att Labels: [31 69]|
|Def Amount of true predicted attacks: [30 69]|
04/23/2025 10:21:03 - INFO - End of Episode.
|Episode 065/100| time: 2.15|
|Def Loss 0.1086 | Def Reward in ep 097|
|Att Loss 0.1114 | Att Reward in ep 003|
|Def Estimated: [32 68]| Att Labels: [35 65]|
|Def Amount of true predicted attacks: [32 65]|
04/23/2025 10:21:05 - INFO - End of Episode.
|Episode 066/100| time: 2.09|
|Def Loss 0.1207 | Def Reward in ep 099|
|Att Loss 0.1195 | Att Reward in ep 001|
|Def Estimated: [32 68]| Att Labels: [31 69]|
|Def Amount of true predicted attacks: [31 68]|
04/23/2025 10:21:08 - INFO - End of Episode.
|Episode 067/100| time: 1.98|
|Def Loss 0.1063 | Def Reward in ep 099|
|Att Loss 0.0864 | Att Reward in ep 001|
|Def Estimated: [30 70]| Att Labels: [29 71]|
|Def Amount of true predicted attacks: [29 70]|
04/23/2025 10:21:10 - INFO - End of Episode.
|Episode 068/100| time: 2.00|
|Def Loss 0.1199 | Def Reward in ep 099|
|Att Loss 0.0899 | Att Reward in ep 001|
|Def Estimated: [33 67]| Att Labels: [32 68]|
|Def Amount of true predicted attacks: [32 67]|
04/23/2025 10:21:13 - INFO - End of Episode.
|Episode 069/100| time: 2.01|
|Def Loss 0.1114 | Def Reward in ep 099|
|Att Loss 0.0764 | Att Reward in ep 001|
|Def Estimated: [33 67]| Att Labels: [34 66]|
|Def Amount of true predicted attacks: [33 66]|
04/23/2025 10:21:15 - INFO - End of Episode.
|Episode 070/100| time: 1.97|
|Def Loss 0.1478 | Def Reward in ep 100|
|Att Loss 0.0892 | Att Reward in ep 000|
|Def Estimated: [24 76]| Att Labels: [24 76]|
|Def Amount of true predicted attacks: [24 76]|
04/23/2025 10:21:17 - INFO - End of Episode.
|Episode 071/100| time: 2.00|
|Def Loss 0.1545 | Def Reward in ep 098|
|Att Loss 0.0631 | Att Reward in ep 002|
|Def Estimated: [30 70]| Att Labels: [30 70]|
|Def Amount of true predicted attacks: [29 69]|
04/23/2025 10:21:20 - INFO - End of Episode.
|Episode 072/100| time: 1.98|
|Def Loss 0.1554 | Def Reward in ep 098|
|Att Loss 0.1043 | Att Reward in ep 002|
|Def Estimated: [25 75]| Att Labels: [25 75]|
|Def Amount of true predicted attacks: [24 74]|
04/23/2025 10:21:22 - INFO - End of Episode.
|Episode 073/100| time: 1.99|
|Def Loss 0.1420 | Def Reward in ep 098|
|Att Loss 0.0954 | Att Reward in ep 002|
|Def Estimated: [26 74]| Att Labels: [28 72]|
|Def Amount of true predicted attacks: [26 72]|
04/23/2025 10:21:25 - INFO - End of Episode.
|Episode 074/100| time: 2.00|
|Def Loss 0.0895 | Def Reward in ep 098|
|Att Loss 0.1064 | Att Reward in ep 002|
|Def Estimated: [26 74]| Att Labels: [28 72]|
|Def Amount of true predicted attacks: [26 72]|
04/23/2025 10:21:27 - INFO - End of Episode.
|Episode 075/100| time: 2.01|
|Def Loss 0.0815 | Def Reward in ep 100|
|Att Loss 0.1015 | Att Reward in ep 000|
|Def Estimated: [36 64]| Att Labels: [36 64]|
|Def Amount of true predicted attacks: [36 64]|
04/23/2025 10:21:30 - INFO - End of Episode.
|Episode 076/100| time: 2.02|
|Def Loss 0.0705 | Def Reward in ep 096|
|Att Loss 0.0913 | Att Reward in ep 004|
|Def Estimated: [36 64]| Att Labels: [36 64]|
|Def Amount of true predicted attacks: [34 62]|
04/23/2025 10:21:32 - INFO - End of Episode.
|Episode 077/100| time: 2.03|
|Def Loss 0.0988 | Def Reward in ep 098|
|Att Loss 0.1033 | Att Reward in ep 002|
|Def Estimated: [35 65]| Att Labels: [35 65]|
|Def Amount of true predicted attacks: [34 64]|
04/23/2025 10:21:35 - INFO - End of Episode.
|Episode 078/100| time: 2.02|
|Def Loss 0.1331 | Def Reward in ep 100|
|Att Loss 0.1153 | Att Reward in ep 000|
|Def Estimated: [33 67]| Att Labels: [33 67]|
|Def Amount of true predicted attacks: [33 67]|
04/23/2025 10:21:38 - INFO - End of Episode.
|Episode 079/100| time: 2.03|
|Def Loss 0.0836 | Def Reward in ep 100|
|Att Loss 0.0884 | Att Reward in ep 000|
|Def Estimated: [36 64]| Att Labels: [36 64]|
|Def Amount of true predicted attacks: [36 64]|
04/23/2025 10:21:40 - INFO - End of Episode.
|Episode 080/100| time: 2.00|
|Def Loss 0.0959 | Def Reward in ep 099|
|Att Loss 0.1019 | Att Reward in ep 001|
|Def Estimated: [29 71]| Att Labels: [28 72]|
|Def Amount of true predicted attacks: [28 71]|
04/23/2025 10:21:43 - INFO - End of Episode.
|Episode 081/100| time: 2.01|
|Def Loss 0.1108 | Def Reward in ep 100|
|Att Loss 0.0853 | Att Reward in ep 000|
|Def Estimated: [33 67]| Att Labels: [33 67]|
|Def Amount of true predicted attacks: [33 67]|
04/23/2025 10:21:45 - INFO - End of Episode.
|Episode 082/100| time: 1.99|
|Def Loss 0.0983 | Def Reward in ep 100|
|Att Loss 0.0703 | Att Reward in ep 000|
|Def Estimated: [28 72]| Att Labels: [28 72]|
|Def Amount of true predicted attacks: [28 72]|
04/23/2025 10:21:48 - INFO - End of Episode.
|Episode 083/100| time: 2.00|
|Def Loss 0.1012 | Def Reward in ep 098|
|Att Loss 0.0624 | Att Reward in ep 002|
|Def Estimated: [29 71]| Att Labels: [29 71]|
|Def Amount of true predicted attacks: [28 70]|
04/23/2025 10:21:50 - INFO - End of Episode.
|Episode 084/100| time: 1.98|
|Def Loss 0.0777 | Def Reward in ep 100|
|Att Loss 0.0825 | Att Reward in ep 000|
|Def Estimated: [27 73]| Att Labels: [27 73]|
|Def Amount of true predicted attacks: [27 73]|
04/23/2025 10:21:53 - INFO - End of Episode.
|Episode 085/100| time: 1.96|
|Def Loss 0.0565 | Def Reward in ep 100|
|Att Loss 0.0749 | Att Reward in ep 000|
|Def Estimated: [22 78]| Att Labels: [22 78]|
|Def Amount of true predicted attacks: [22 78]|
04/23/2025 10:21:55 - INFO - End of Episode.
|Episode 086/100| time: 2.00|
|Def Loss 0.0319 | Def Reward in ep 100|
|Att Loss 0.0690 | Att Reward in ep 000|
|Def Estimated: [29 71]| Att Labels: [29 71]|
|Def Amount of true predicted attacks: [29 71]|
04/23/2025 10:21:58 - INFO - End of Episode.
|Episode 087/100| time: 2.01|
|Def Loss 0.0177 | Def Reward in ep 098|
|Att Loss 0.0604 | Att Reward in ep 002|
|Def Estimated: [36 64]| Att Labels: [34 66]|
|Def Amount of true predicted attacks: [34 64]|
04/23/2025 10:22:00 - INFO - End of Episode.
|Episode 088/100| time: 1.97|
|Def Loss 0.0001 | Def Reward in ep 100|
|Att Loss 0.0835 | Att Reward in ep 000|
|Def Estimated: [24 76]| Att Labels: [24 76]|
|Def Amount of true predicted attacks: [24 76]|
04/23/2025 10:22:03 - INFO - End of Episode.
|Episode 089/100| time: 1.98|
|Def Loss 0.0000 | Def Reward in ep 100|
|Att Loss 0.0585 | Att Reward in ep 000|
|Def Estimated: [29 71]| Att Labels: [29 71]|
|Def Amount of true predicted attacks: [29 71]|
04/23/2025 10:22:05 - INFO - End of Episode.
|Episode 090/100| time: 1.99|
|Def Loss 0.0001 | Def Reward in ep 100|
|Att Loss 0.0616 | Att Reward in ep 000|
|Def Estimated: [28 72]| Att Labels: [28 72]|
|Def Amount of true predicted attacks: [28 72]|
04/23/2025 10:22:08 - INFO - End of Episode.
|Episode 091/100| time: 1.96|
|Def Loss 0.0250 | Def Reward in ep 096|
|Att Loss 0.0713 | Att Reward in ep 004|
|Def Estimated: [25 75]| Att Labels: [23 77]|
|Def Amount of true predicted attacks: [22 74]|
04/23/2025 10:22:11 - INFO - End of Episode.
|Episode 092/100| time: 2.00|
|Def Loss 0.0282 | Def Reward in ep 099|
|Att Loss 0.0845 | Att Reward in ep 001|
|Def Estimated: [34 66]| Att Labels: [35 65]|
|Def Amount of true predicted attacks: [34 65]|
04/23/2025 10:22:13 - INFO - End of Episode.
|Episode 093/100| time: 1.98|
|Def Loss 0.0205 | Def Reward in ep 099|
|Att Loss 0.0888 | Att Reward in ep 001|
|Def Estimated: [25 75]| Att Labels: [26 74]|
|Def Amount of true predicted attacks: [25 74]|
04/23/2025 10:22:16 - INFO - End of Episode.
|Episode 094/100| time: 2.00|
|Def Loss 0.0323 | Def Reward in ep 099|
|Att Loss 0.0821 | Att Reward in ep 001|
|Def Estimated: [29 71]| Att Labels: [30 70]|
|Def Amount of true predicted attacks: [29 70]|
04/23/2025 10:22:18 - INFO - End of Episode.
|Episode 095/100| time: 1.99|
|Def Loss 0.0536 | Def Reward in ep 100|
|Att Loss 0.0943 | Att Reward in ep 000|
|Def Estimated: [30 70]| Att Labels: [30 70]|
|Def Amount of true predicted attacks: [30 70]|
04/23/2025 10:22:21 - INFO - End of Episode.
|Episode 096/100| time: 1.98|
|Def Loss 0.0446 | Def Reward in ep 100|
|Att Loss 0.0880 | Att Reward in ep 000|
|Def Estimated: [25 75]| Att Labels: [25 75]|
|Def Amount of true predicted attacks: [25 75]|
04/23/2025 10:22:23 - INFO - End of Episode.
|Episode 097/100| time: 2.04|
|Def Loss 0.0489 | Def Reward in ep 100|
|Att Loss 0.0774 | Att Reward in ep 000|
|Def Estimated: [39 61]| Att Labels: [39 61]|
|Def Amount of true predicted attacks: [39 61]|
04/23/2025 10:22:26 - INFO - End of Episode.
|Episode 098/100| time: 2.04|
|Def Loss 0.0556 | Def Reward in ep 099|
|Att Loss 0.0629 | Att Reward in ep 001|
|Def Estimated: [40 60]| Att Labels: [41 59]|
|Def Amount of true predicted attacks: [40 59]|
04/23/2025 10:22:29 - INFO - End of Episode.
|Episode 099/100| time: 2.06|
|Def Loss 0.0728 | Def Reward in ep 100|
|Att Loss 0.0653 | Att Reward in ep 000|
|Def Estimated: [44 56]| Att Labels: [44 56]|
|Def Amount of true predicted attacks: [44 56]|
04/23/2025 10:22:29 - INFO - Model 'attacker_model_cic_2017' saved in: /workspace/models/trained-models/2025-04-23-10-17-Linux-CIC-2018-17-WebAttack-2nd-Run/attacker_model_cic.keras
04/23/2025 10:22:29 - INFO - Model summary:
Model: "attacker_model_cic_2017"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense (Dense)               (None, 100)               6800      
                                                                 
 dense_1 (Dense)             (None, 100)               10100     
                                                                 
 dense_2 (Dense)             (None, 100)               10100     
                                                                 
 dense_3 (Dense)             (None, 100)               10100     
                                                                 
 dense_4 (Dense)             (None, 100)               10100     
                                                                 
 dense_5 (Dense)             (None, 4)                 404       
                                                                 
=================================================================
Total params: 47604 (185.95 KB)
Trainable params: 47604 (185.95 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________

04/23/2025 10:22:29 - INFO - Model 'defender_model' saved in: /workspace/models/trained-models/2025-04-23-10-17-Linux-CIC-2018-17-WebAttack-2nd-Run/defender_model.keras
04/23/2025 10:22:29 - INFO - Model summary:
Model: "defender_model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense_12 (Dense)            (None, 100)               6800      
                                                                 
 dense_13 (Dense)            (None, 100)               10100     
                                                                 
 dense_14 (Dense)            (None, 100)               10100     
                                                                 
 dense_15 (Dense)            (None, 2)                 202       
                                                                 
=================================================================
Total params: 27202 (106.26 KB)
Trainable params: 27202 (106.26 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________

04/23/2025 10:22:29 - INFO - Saved trained models.
04/23/2025 10:22:29 - INFO - Total runtime: 00:04:30
04/23/2025 10:22:29 - INFO - End of the script at: 2025-04-23 10:22:29.874362
04/23/2025 10:22:32 - INFO - Debug information saved to /workspace/models/trained-models/2025-04-23-10-17-Linux-CIC-2018-17-WebAttack-2nd-Run/logs/debug_info.json
04/23/2025 10:22:32 - INFO - Trying to save summary plots under: /workspace/models/trained-models/2025-04-23-10-17-Linux-CIC-2018-17-WebAttack-2nd-Run/plots/
04/23/2025 10:22:34 - INFO - Plotted attack distributions during training in: /workspace/models/trained-models/2025-04-23-10-17-Linux-CIC-2018-17-WebAttack-2nd-Run/plots/
04/23/2025 10:22:37 - INFO - Normalized confusion matrix
04/23/2025 10:22:37 - INFO - 
Confusion Matrix:
[[0.98124706 0.01875294]
 [0.01331361 0.98668639]]
04/23/2025 10:22:37 - INFO - Plotted confusion matrix in: /workspace/models/trained-models/2025-04-23-10-17-Linux-CIC-2018-17-WebAttack-2nd-Run/plots/intraset/
04/23/2025 10:22:37 - INFO - Model summary:
Model: "defender_model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense_12 (Dense)            (None, 100)               6800      
                                                                 
 dense_13 (Dense)            (None, 100)               10100     
                                                                 
 dense_14 (Dense)            (None, 100)               10100     
                                                                 
 dense_15 (Dense)            (None, 2)                 202       
                                                                 
=================================================================
Total params: 27202 (106.26 KB)
Trainable params: 27202 (106.26 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________

loaded from: /workspace/models/trained-models/2025-04-23-10-17-Linux-CIC-2018-17-WebAttack-2nd-Run/defender_model.keras
04/23/2025 10:22:37 - INFO - One vs All metric calculation: 
True positive: 667 | False positive: 3188 | 
True negative: 166812 | False negative: 9
Accuracy: 0.9813 | Recall: 0.9867 | Specificity: 0.9812 | Precision: 0.1730 | F1-Score: 0.2944 | False Positive Rate: 0.0188
04/23/2025 10:22:37 - INFO - Overall overview
Total reward: 167479 | Number of samples: 170676 | Accuracy = 98.13%
Overall overview per attack type
              Estimated Correct   Total Mismatch   F1_score
Benign           166821  166812  170000     3179  99.050831
Web Attack         3855     667     676     3179  29.441624
Weigthed Avg.                                     98.775129
04/23/2025 10:22:37 - INFO - 
     Class  Support  Accuracy  Precision  Recall  F1-Score
    Benign   170000    0.9812     0.9999  0.9812    0.9905
Web Attack      676    0.9867     0.1730  0.9867    0.2944
04/23/2025 10:22:37 - INFO - Overall weighted F1-score: 0.9878
04/23/2025 10:22:42 - INFO - 
One vs All metrics: 
         name  accuracy        f1  precision    recall
0      Benign  0.981269  0.990508   0.999946  0.981247
1  Web Attack  0.981269  0.294416   0.173022  0.986686
04/23/2025 10:22:42 - INFO - Classification report:
              precision    recall  f1-score   support

      Benign       1.00      0.98      0.99    170000
  Web Attack       0.17      0.99      0.29       676

    accuracy                           0.98    170676
   macro avg       0.59      0.98      0.64    170676
weighted avg       1.00      0.98      0.99    170676

04/23/2025 10:22:45 - INFO - Model metrics: 
loss=0.01846379227936268, mse=0.039031609892845154, mae=0.10230404883623123
04/23/2025 10:22:45 - INFO - Optimizer config: {'name': 'Adam', 'weight_decay': None, 'clipnorm': None, 'global_clipnorm': None, 'clipvalue': None, 'use_ema': False, 'ema_momentum': 0.99, 'ema_overwrite_frequency': None, 'jit_compile': False, 'is_legacy_optimizer': False, 'learning_rate': 0.001, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
04/23/2025 10:22:45 - INFO - Time needed for testing: 11.086048126220703
04/23/2025 10:22:45 - INFO - Metrics exported to: /workspace/models/trained-models/2025-04-23-10-17-Linux-CIC-2018-17-WebAttack-2nd-Run/logs/evaluation_metrics_defender_model.json
04/23/2025 10:22:47 - INFO - [Intra-Set] Accuracy: 0.9895, Recall: 0.0000, Precision: 0.0000, F1: 0.0000
04/23/2025 10:22:48 - INFO - Normalized confusion matrix
04/23/2025 10:22:48 - INFO - 
Confusion Matrix:
[[9.99828571e-01 1.71428571e-04]
 [1.00000000e+00 0.00000000e+00]]
04/23/2025 10:22:48 - INFO - Plotted confusion matrix in: /workspace/models/trained-models/2025-04-23-10-17-Linux-CIC-2018-17-WebAttack-2nd-Run/plots/interset/
04/23/2025 10:22:48 - INFO - [Intra-Set] Confusion matrix saved to /workspace/models/trained-models/2025-04-23-10-17-Linux-CIC-2018-17-WebAttack-2nd-Run/plots/
04/23/2025 10:22:50 - INFO - [Cross-Set] Model metrics: loss=0.036823466420173645, mse=0.07694586366415024, mae=0.17817039787769318
04/23/2025 10:22:50 - INFO - [Intra-Set] Evaluation completed. Metrics exported to: /workspace/models/trained-models/2025-04-23-10-17-Linux-CIC-2018-17-WebAttack-2nd-Run/logs/evaluation_metrics_cross_defender_model.json
04/23/2025 10:22:50 - INFO - [Intra-Set] Time needed: 5.16 seconds
04/23/2025 10:22:50 - INFO - Finished script at: 2025-04-23-10-22
Total runtime: 0:04:50.972617
