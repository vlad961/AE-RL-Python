03/24/2025 12:38:30 - INFO - Started script at: 2025-03-24-12-38
03/24/2025 12:38:30 - INFO - Current working dir: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python
03/24/2025 12:38:30 - INFO - Used data files: 
E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\data/datasets/origin-kaggle-com/nsl-kdd/KDDTrain+.txt,
E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\data/datasets/origin-kaggle-com/nsl-kdd/KDDTest+.txt
03/24/2025 12:38:30 - INFO - Creating enviroment...
03/24/2025 12:38:32 - INFO - Initializing Attacker's ReplayMemory with observation_size=122 and max_size=1000
03/24/2025 12:38:33 - DEBUG - Creating converter from 5 to 3
03/24/2025 12:38:33 - DEBUG - Creating converter from 3 to 5
03/24/2025 12:38:33 - INFO - Initializing Attacker's ReplayMemory with observation_size=122 and max_size=1000
03/24/2025 12:38:33 - INFO - Initializing Attacker's ReplayMemory with observation_size=122 and max_size=1000
03/24/2025 12:38:33 - INFO - Initializing Attacker's ReplayMemory with observation_size=122 and max_size=1000
03/24/2025 12:38:33 - INFO - Reading formated train data from: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\data/datasets/formated/balanced_training_data.csv
03/24/2025 12:38:34 - INFO - Initializing Defender's ReplayMemory with observation_size=122 and max_size=4000
03/24/2025 12:38:34 - INFO - Start Training with the following parameters:
-----------------------------------------------------------------------------------------------------------------------
Total epoch: 10 | Iterations in epoch: 100 | Minibatch from mem size: 100 | Total Samples: 1000 | Data shape: (127746, 162)
-----------------------------------------------------------------------------------------------------------------------
Attacker<Attack-Type>: Num_actions=23 | gamma=0.001 | epsilon=1 | ANN hidden size=100 | ANN hidden layers=5 | Learning rate=0.001
-----------------------------------------------------------------------------------------------------------------------
Defender: Num_actions=5 | gamma=0.001 | epsilon=1 | ANN hidden size=100 | ANN hidden layers=3 | Learning rate=0.001
-----------------------------------------------------------------------------------------------------------------------
Used Attack types: 'all: Normal, DoS, Probe, R2L, U2R' | Attack name(s): ['normal', 'back', 'land', 'neptune', 'pod', 'smurf', 'teardrop', 'ipsweep', 'nmap', 'portsweep', 'satan', 'ftp_write', 'guess_passwd', 'imap', 'multihop', 'phf', 'spy', 'warezclient', 'warezmaster', 'loadmodule', 'perl', 'rootkit', 'httptunnel']
-----------------------------------------------------------------------------------------------------------------------

03/24/2025 12:38:37 - INFO - End of Epoch.
|Epoch 000/010| time: 2.76|
|Def Loss 0.0000 | Def Reward in ep 076|
|Att Loss Dos 0.0000 | Att Reward in ep 079|
|Att Loss Probe 0.0000 | Att Reward in ep 082|
|Att Loss R2L 0.0000 | Att Reward in ep 079|
|Att Loss U2R 0.0000 | Att Reward in ep 084|
|Def Estimated: [81 84 86 80 69]| Att Labels: [63 90 78 87 82]|
|Def Amount of true predicted attacks: [10 18 15 19 14]|
03/24/2025 12:38:37 - WARNING - 5 out of the last 9 calls to <function Model.make_predict_function.<locals>.predict_function at 0x000002724AD380D0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
03/24/2025 12:38:39 - WARNING - 5 out of the last 5 calls to <function Model.make_predict_function.<locals>.predict_function at 0x0000027275318040> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
03/24/2025 12:38:39 - WARNING - 5 out of the last 5 calls to <function Model.make_train_function.<locals>.train_function at 0x0000027275318550> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
03/24/2025 12:39:55 - INFO - End of Epoch.
|Epoch 001/010| time: 78.25|
|Def Loss 0.2877 | Def Reward in ep 111|
|Att Loss Dos 1.6435 | Att Reward in ep 016|
|Att Loss Probe 1.4680 | Att Reward in ep 090|
|Att Loss R2L 0.8847 | Att Reward in ep 094|
|Att Loss U2R 1.7106 | Att Reward in ep 089|
|Def Estimated: [ 66 325   4   2   3]| Att Labels: [80 72 78 92 78]|
|Def Amount of true predicted attacks: [38 71  0  1  1]|
03/24/2025 12:41:12 - INFO - End of Epoch.
|Epoch 002/010| time: 77.16|
|Def Loss 0.1495 | Def Reward in ep 132|
|Att Loss Dos 1.2627 | Att Reward in ep 006|
|Att Loss Probe 0.7835 | Att Reward in ep 082|
|Att Loss R2L 0.4133 | Att Reward in ep 091|
|Att Loss U2R 0.9209 | Att Reward in ep 089|
|Def Estimated: [125 269   2   2   2]| Att Labels: [61 83 78 89 89]|
|Def Amount of true predicted attacks: [50 81  0  0  1]|
03/24/2025 12:42:30 - INFO - End of Epoch.
|Epoch 003/010| time: 77.16|
|Def Loss 0.0769 | Def Reward in ep 137|
|Att Loss Dos 1.0839 | Att Reward in ep 004|
|Att Loss Probe 0.6644 | Att Reward in ep 085|
|Att Loss R2L 0.3468 | Att Reward in ep 091|
|Att Loss U2R 0.7611 | Att Reward in ep 083|
|Def Estimated: [150 245   3   1   1]| Att Labels: [60 82 85 91 82]|
|Def Amount of true predicted attacks: [56 78  1  1  1]|
03/24/2025 12:43:47 - INFO - End of Epoch.
|Epoch 004/010| time: 77.39|
|Def Loss 0.0453 | Def Reward in ep 132|
|Att Loss Dos 0.9690 | Att Reward in ep 003|
|Att Loss Probe 0.5783 | Att Reward in ep 087|
|Att Loss R2L 0.2929 | Att Reward in ep 092|
|Att Loss U2R 0.6864 | Att Reward in ep 086|
|Def Estimated: [147 251   0   1   1]| Att Labels: [55 81 87 91 86]|
|Def Amount of true predicted attacks: [52 80  0  0  0]|
03/24/2025 12:45:05 - INFO - End of Epoch.
|Epoch 005/010| time: 77.88|
|Def Loss 0.0279 | Def Reward in ep 138|
|Att Loss Dos 0.8746 | Att Reward in ep 002|
|Att Loss Probe 0.4681 | Att Reward in ep 087|
|Att Loss R2L 0.2561 | Att Reward in ep 088|
|Att Loss U2R 0.5601 | Att Reward in ep 085|
|Def Estimated: [145 252   0   3   0]| Att Labels: [63 82 84 86 85]|
|Def Amount of true predicted attacks: [57 81  0  0  0]|
03/24/2025 12:46:22 - INFO - End of Epoch.
|Epoch 006/010| time: 77.01|
|Def Loss 0.0195 | Def Reward in ep 129|
|Att Loss Dos 0.7383 | Att Reward in ep 003|
|Att Loss Probe 0.3934 | Att Reward in ep 087|
|Att Loss R2L 0.2253 | Att Reward in ep 092|
|Att Loss U2R 0.4730 | Att Reward in ep 089|
|Def Estimated: [152 242   1   2   3]| Att Labels: [58 76 86 93 87]|
|Def Amount of true predicted attacks: [52 75  1  1  0]|
03/24/2025 12:47:39 - INFO - End of Epoch.
|Epoch 007/010| time: 77.36|
|Def Loss 0.0100 | Def Reward in ep 139|
|Att Loss Dos 0.6813 | Att Reward in ep 002|
|Att Loss Probe 0.3681 | Att Reward in ep 089|
|Att Loss R2L 0.2083 | Att Reward in ep 087|
|Att Loss U2R 0.4108 | Att Reward in ep 083|
|Def Estimated: [176 223   0   0   1]| Att Labels: [60 82 88 87 83]|
|Def Amount of true predicted attacks: [58 81  0  0  0]|
03/24/2025 12:48:56 - INFO - End of Epoch.
|Epoch 008/010| time: 76.70|
|Def Loss 0.0063 | Def Reward in ep 132|
|Att Loss Dos 0.5974 | Att Reward in ep 000|
|Att Loss Probe 0.3190 | Att Reward in ep 084|
|Att Loss R2L 0.1927 | Att Reward in ep 095|
|Att Loss U2R 0.3985 | Att Reward in ep 089|
|Def Estimated: [162 235   2   1   0]| Att Labels: [50 84 82 95 89]|
|Def Amount of true predicted attacks: [47 84  1  0  0]|
03/24/2025 12:50:14 - INFO - End of Epoch.
|Epoch 009/010| time: 77.72|
|Def Loss 0.0063 | Def Reward in ep 124|
|Att Loss Dos 0.5492 | Att Reward in ep 003|
|Att Loss Probe 0.2864 | Att Reward in ep 089|
|Att Loss R2L 0.1581 | Att Reward in ep 096|
|Att Loss U2R 0.3481 | Att Reward in ep 088|
|Def Estimated: [186 213   0   0   1]| Att Labels: [54 73 89 96 88]|
|Def Amount of true predicted attacks: [53 71  0  0  0]|
03/24/2025 12:50:14 - INFO - Model 'attacker_model_dos' saved in: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-03-24-12-38-WIN-multiple-attackers-att-5L-def-3L-lr-0.001/attacker_model_dos.keras
03/24/2025 12:50:14 - INFO - Model summary:
Model: "attacker_model_dos"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense (Dense)                (None, 100)               12300     
_________________________________________________________________
dense_1 (Dense)              (None, 100)               10100     
_________________________________________________________________
dense_2 (Dense)              (None, 100)               10100     
_________________________________________________________________
dense_3 (Dense)              (None, 100)               10100     
_________________________________________________________________
dense_4 (Dense)              (None, 100)               10100     
_________________________________________________________________
dense_5 (Dense)              (None, 7)                 707       
=================================================================
Total params: 53,407
Trainable params: 53,407
Non-trainable params: 0
_________________________________________________________________

03/24/2025 12:50:14 - INFO - Model 'attacker_model_probe' saved in: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-03-24-12-38-WIN-multiple-attackers-att-5L-def-3L-lr-0.001/attacker_model_probe.keras
03/24/2025 12:50:14 - INFO - Model summary:
Model: "attacker_model_probe"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_12 (Dense)             (None, 100)               12300     
_________________________________________________________________
dense_13 (Dense)             (None, 100)               10100     
_________________________________________________________________
dense_14 (Dense)             (None, 100)               10100     
_________________________________________________________________
dense_15 (Dense)             (None, 100)               10100     
_________________________________________________________________
dense_16 (Dense)             (None, 100)               10100     
_________________________________________________________________
dense_17 (Dense)             (None, 5)                 505       
=================================================================
Total params: 53,205
Trainable params: 53,205
Non-trainable params: 0
_________________________________________________________________

03/24/2025 12:50:14 - INFO - Model 'attacker_model_probe_r2l' saved in: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-03-24-12-38-WIN-multiple-attackers-att-5L-def-3L-lr-0.001/attacker_model_r2l.keras
03/24/2025 12:50:14 - INFO - Model summary:
Model: "attacker_model_probe_r2l"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_24 (Dense)             (None, 100)               12300     
_________________________________________________________________
dense_25 (Dense)             (None, 100)               10100     
_________________________________________________________________
dense_26 (Dense)             (None, 100)               10100     
_________________________________________________________________
dense_27 (Dense)             (None, 100)               10100     
_________________________________________________________________
dense_28 (Dense)             (None, 100)               10100     
_________________________________________________________________
dense_29 (Dense)             (None, 9)                 909       
=================================================================
Total params: 53,609
Trainable params: 53,609
Non-trainable params: 0
_________________________________________________________________

03/24/2025 12:50:14 - INFO - Model 'attacker_model_probe_u2r' saved in: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-03-24-12-38-WIN-multiple-attackers-att-5L-def-3L-lr-0.001/attacker_model_u2r.keras
03/24/2025 12:50:14 - INFO - Model summary:
Model: "attacker_model_probe_u2r"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_36 (Dense)             (None, 100)               12300     
_________________________________________________________________
dense_37 (Dense)             (None, 100)               10100     
_________________________________________________________________
dense_38 (Dense)             (None, 100)               10100     
_________________________________________________________________
dense_39 (Dense)             (None, 100)               10100     
_________________________________________________________________
dense_40 (Dense)             (None, 100)               10100     
_________________________________________________________________
dense_41 (Dense)             (None, 5)                 505       
=================================================================
Total params: 53,205
Trainable params: 53,205
Non-trainable params: 0
_________________________________________________________________

03/24/2025 12:50:14 - INFO - Model 'defender_model' saved in: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-03-24-12-38-WIN-multiple-attackers-att-5L-def-3L-lr-0.001/defender_model.keras
03/24/2025 12:50:14 - INFO - Model summary:
Model: "defender_model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_48 (Dense)             (None, 100)               12300     
_________________________________________________________________
dense_49 (Dense)             (None, 100)               10100     
_________________________________________________________________
dense_50 (Dense)             (None, 100)               10100     
_________________________________________________________________
dense_51 (Dense)             (None, 5)                 505       
=================================================================
Total params: 33,005
Trainable params: 33,005
Non-trainable params: 0
_________________________________________________________________

03/24/2025 12:50:14 - INFO - Saved trained models.
03/24/2025 12:50:14 - INFO - Total runtime: 00:11:43
03/24/2025 12:50:14 - INFO - End of the script at: 2025-03-24 12:50:14.287855
03/24/2025 12:50:14 - INFO - Debug information saved to E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-03-24-12-38-WIN-multiple-attackers-att-5L-def-3L-lr-0.001/logs/debug_info.json
03/24/2025 12:50:14 - INFO - Trying to save summary plots under: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-03-24-12-38-WIN-multiple-attackers-att-5L-def-3L-lr-0.001/plots/
03/24/2025 12:50:14 - INFO - Plotted rewards and losses during training in: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-03-24-12-38-WIN-multiple-attackers-att-5L-def-3L-lr-0.001/plots/
03/24/2025 12:50:16 - INFO - Plotted attack distributions during training in: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-03-24-12-38-WIN-multiple-attackers-att-5L-def-3L-lr-0.001/plots/
03/24/2025 12:50:19 - INFO - Start testing the trained model.
03/24/2025 12:50:19 - INFO - Model 'defender_model' loaded from: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-03-24-12-38-WIN-multiple-attackers-att-5L-def-3L-lr-0.001/defender_model.keras
03/24/2025 12:50:19 - INFO - Model summary:
Model: "defender_model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense_48 (Dense)            (None, 100)               12300     
                                                                 
 dense_49 (Dense)            (None, 100)               10100     
                                                                 
 dense_50 (Dense)            (None, 100)               10100     
                                                                 
 dense_51 (Dense)            (None, 5)                 505       
                                                                 
=================================================================
Total params: 33,005
Trainable params: 33,005
Non-trainable params: 0
_________________________________________________________________

03/24/2025 12:50:19 - INFO - Reading formated test data from: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\data/datasets/formated/balanced_test_data.csv
03/24/2025 12:50:20 - INFO - Overall overview
Total reward: 16485 | Number of samples: 20771 | Accuracy = 79.37%
03/24/2025 12:50:20 - INFO - Overall overview per attack type
        Estimated Correct Total   F1_score Mismatch
normal      12294    9489  9711  86.244035     2583
DoS          8477    6996  7458  87.806715     1019
Probe           0       0  2421        0.0     2421
R2L             0       0  1079        0.0     1079
U2R             0       0   102        0.0      102
General                          71.849131         
03/24/2025 12:50:20 - INFO - Performance measures on Test data
03/24/2025 12:50:20 - INFO - Accuracy =  0.7937
03/24/2025 12:50:20 - INFO - F1 =  0.7185
03/24/2025 12:50:21 - INFO - Precision_score =  0.6572
03/24/2025 12:50:21 - INFO - recall_score =  0.7937
03/24/2025 12:50:21 - INFO - Normalized confusion matrix
03/24/2025 12:50:21 - INFO - 
Confusion Matrix:
[[0.98 0.02 0.   0.   0.  ]
 [0.06 0.94 0.   0.   0.  ]
 [0.51 0.49 0.   0.   0.  ]
 [0.98 0.02 0.   0.   0.  ]
 [0.54 0.46 0.   0.   0.  ]]
03/24/2025 12:50:21 - INFO - Plotted confusion matrix in: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-03-24-12-38-WIN-multiple-attackers-att-5L-def-3L-lr-0.001/plots/
03/24/2025 12:50:22 - INFO - 
One vs All metrics: 
     name  accuracy        f1 precision    recall
0  normal  0.854268   0.86244   0.77184  0.977139
1     DoS  0.906456  0.878067  0.825292  0.938053
2   Probe  0.883443       0.0       0.0       0.0
3     R2L  0.948053       0.0       0.0       0.0
4     U2R  0.995089       0.0       0.0       0.0
03/24/2025 12:50:23 - INFO - Model metrics: 
loss=0.03632790967822075, mse=0.07299868762493134, mae=0.12256459146738052
03/24/2025 12:50:23 - INFO - Optimizer config: {'name': 'Adam', 'learning_rate': 0.001, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
03/24/2025 12:50:23 - INFO - Time needed for testing: 4.484457492828369
03/24/2025 12:50:23 - INFO - Classification report:
              precision    recall  f1-score   support

      normal       0.77      0.98      0.86      9711
         DoS       0.83      0.94      0.88      7458
       Probe       0.00      0.00      0.00      2421
         R2L       0.00      0.00      0.00      1079
         U2R       0.00      0.00      0.00       102

    accuracy                           0.79     20771
   macro avg       0.32      0.38      0.35     20771
weighted avg       0.66      0.79      0.72     20771

