02/07/2025 14:20:11 - INFO - Started script at: 2025-02-07-14-20
02/07/2025 14:20:11 - INFO - Current working dir: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python
02/07/2025 14:20:11 - INFO - Used data files: 
E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\data/datasets/origin-kaggle-com/nsl-kdd/KDDTrain+.txt,
E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\data/datasets/origin-kaggle-com/nsl-kdd/KDDTest+.txt
02/07/2025 14:20:11 - INFO - Creating enviroment...
02/07/2025 14:20:11 - INFO - Reading formated train data from: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\data/datasets/formated/formated_train_adv.csv
02/07/2025 14:20:13 - INFO - Initializing ReplayMemory with observation_size=122 and max_size=1000
02/07/2025 14:20:14 - DEBUG - Creating converter from 5 to 3
02/07/2025 14:20:14 - DEBUG - Creating converter from 3 to 5
02/07/2025 14:20:14 - INFO - Initializing ReplayMemory with observation_size=122 and max_size=1000
02/07/2025 14:20:14 - INFO - Start Training with the following parameters:
-----------------------------------------------------------------------------------------------------------------------
Total epoch: 100 | Iterations in epoch: 100 | Minibatch from mem size: 100 | Total Samples: 10000 | Data shape: (113270, 162)
-----------------------------------------------------------------------------------------------------------------------
Attacker: Num_actions=7 | gamma=0.001 | epsilon=1 | ANN hidden size=100 | ANN hidden layers=1 | Learning rate=0.001
-----------------------------------------------------------------------------------------------------------------------
Defender: Num_actions=5 | gamma=0.001 | epsilon=1 | ANN hidden size=100 | ANN hidden layers=3 | Learning rate=0.001
-----------------------------------------------------------------------------------------------------------------------
Used Attack types: '['normal', 'DoS']' | Attack name(s): ['normal', 'back', 'land', 'neptune', 'pod', 'smurf', 'teardrop']
-----------------------------------------------------------------------------------------------------------------------

02/07/2025 14:20:15 - INFO - End of Epoch.
|Epoch 000/100| time: 0.42|
|Def Loss 0.0000 | Def Reward in ep 024|
|Att Loss 0.0000 | Att Reward in ep 076|
|Def Estimated: [20 23 18 22 17]| Att Labels: [11 89  0  0  0]|
|Def Amount of true predicted attacks: [ 3 21  0  0  0]|
02/07/2025 14:20:16 - WARNING - 5 out of the last 5 calls to <function Model.make_predict_function.<locals>.predict_function at 0x000002CBB64D5430> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
02/07/2025 14:20:16 - WARNING - 6 out of the last 6 calls to <function Model.make_predict_function.<locals>.predict_function at 0x000002CBB6871550> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
02/07/2025 14:20:32 - INFO - End of Epoch.
|Epoch 001/100| time: 17.08|
|Def Loss 0.3442 | Def Reward in ep 055|
|Att Loss 1.9167 | Att Reward in ep 045|
|Def Estimated: [ 8 61 10 11 10]| Att Labels: [18 82  0  0  0]|
|Def Amount of true predicted attacks: [ 4 51  0  0  0]|
02/07/2025 14:20:49 - INFO - End of Epoch.
|Epoch 002/100| time: 17.20|
|Def Loss 0.1219 | Def Reward in ep 094|
|Att Loss 1.4493 | Att Reward in ep 006|
|Def Estimated: [17 82  0  1  0]| Att Labels: [23 77  0  0  0]|
|Def Amount of true predicted attacks: [17 77  0  0  0]|
02/07/2025 14:21:06 - INFO - End of Epoch.
|Epoch 003/100| time: 17.63|
|Def Loss 0.0651 | Def Reward in ep 096|
|Att Loss 1.3021 | Att Reward in ep 004|
|Def Estimated: [21 79  0  0  0]| Att Labels: [23 77  0  0  0]|
|Def Amount of true predicted attacks: [20 76  0  0  0]|
02/07/2025 14:21:24 - INFO - End of Epoch.
|Epoch 004/100| time: 17.63|
|Def Loss 0.0430 | Def Reward in ep 098|
|Att Loss 1.1516 | Att Reward in ep 002|
|Def Estimated: [25 75  0  0  0]| Att Labels: [27 73  0  0  0]|
|Def Amount of true predicted attacks: [25 73  0  0  0]|
02/07/2025 14:21:41 - INFO - End of Epoch.
|Epoch 005/100| time: 17.35|
|Def Loss 0.0455 | Def Reward in ep 100|
|Att Loss 1.0191 | Att Reward in ep 000|
|Def Estimated: [17 83  0  0  0]| Att Labels: [17 83  0  0  0]|
|Def Amount of true predicted attacks: [17 83  0  0  0]|
02/07/2025 14:21:59 - INFO - End of Epoch.
|Epoch 006/100| time: 17.18|
|Def Loss 0.0469 | Def Reward in ep 099|
|Att Loss 0.9150 | Att Reward in ep 001|
|Def Estimated: [20 80  0  0  0]| Att Labels: [21 79  0  0  0]|
|Def Amount of true predicted attacks: [20 79  0  0  0]|
02/07/2025 14:22:16 - INFO - End of Epoch.
|Epoch 007/100| time: 16.95|
|Def Loss 0.0481 | Def Reward in ep 099|
|Att Loss 0.8308 | Att Reward in ep 001|
|Def Estimated: [22 78  0  0  0]| Att Labels: [23 77  0  0  0]|
|Def Amount of true predicted attacks: [22 77  0  0  0]|
02/07/2025 14:22:33 - INFO - End of Epoch.
|Epoch 008/100| time: 16.98|
|Def Loss 0.0183 | Def Reward in ep 099|
|Att Loss 0.7561 | Att Reward in ep 001|
|Def Estimated: [19 80  1  0  0]| Att Labels: [19 81  0  0  0]|
|Def Amount of true predicted attacks: [19 80  0  0  0]|
02/07/2025 14:22:49 - INFO - End of Epoch.
|Epoch 009/100| time: 16.91|
|Def Loss 0.0221 | Def Reward in ep 099|
|Att Loss 0.7031 | Att Reward in ep 001|
|Def Estimated: [17 83  0  0  0]| Att Labels: [16 84  0  0  0]|
|Def Amount of true predicted attacks: [16 83  0  0  0]|
02/07/2025 14:23:07 - INFO - End of Epoch.
|Epoch 010/100| time: 17.29|
|Def Loss 0.0195 | Def Reward in ep 098|
|Att Loss 0.4935 | Att Reward in ep 002|
|Def Estimated: [28 72  0  0  0]| Att Labels: [28 72  0  0  0]|
|Def Amount of true predicted attacks: [27 71  0  0  0]|
02/07/2025 14:23:24 - INFO - End of Epoch.
|Epoch 011/100| time: 17.23|
|Def Loss 0.0179 | Def Reward in ep 099|
|Att Loss 0.1659 | Att Reward in ep 001|
|Def Estimated: [18 81  1  0  0]| Att Labels: [18 82  0  0  0]|
|Def Amount of true predicted attacks: [18 81  0  0  0]|
02/07/2025 14:23:41 - INFO - End of Epoch.
|Epoch 012/100| time: 16.99|
|Def Loss 0.0165 | Def Reward in ep 098|
|Att Loss 0.0704 | Att Reward in ep 002|
|Def Estimated: [19 79  0  1  1]| Att Labels: [19 81  0  0  0]|
|Def Amount of true predicted attacks: [19 79  0  0  0]|
02/07/2025 14:23:58 - INFO - End of Epoch.
|Epoch 013/100| time: 17.11|
|Def Loss 0.0200 | Def Reward in ep 100|
|Att Loss 0.0561 | Att Reward in ep 000|
|Def Estimated: [13 87  0  0  0]| Att Labels: [13 87  0  0  0]|
|Def Amount of true predicted attacks: [13 87  0  0  0]|
02/07/2025 14:24:15 - INFO - End of Epoch.
|Epoch 014/100| time: 16.94|
|Def Loss 0.0123 | Def Reward in ep 097|
|Att Loss 0.0591 | Att Reward in ep 003|
|Def Estimated: [15 84  1  0  0]| Att Labels: [15 85  0  0  0]|
|Def Amount of true predicted attacks: [14 83  0  0  0]|
02/07/2025 14:24:32 - INFO - End of Epoch.
|Epoch 015/100| time: 17.01|
|Def Loss 0.0101 | Def Reward in ep 100|
|Att Loss 0.0779 | Att Reward in ep 000|
|Def Estimated: [15 85  0  0  0]| Att Labels: [15 85  0  0  0]|
|Def Amount of true predicted attacks: [15 85  0  0  0]|
02/07/2025 14:24:49 - INFO - End of Epoch.
|Epoch 016/100| time: 17.12|
|Def Loss 0.0145 | Def Reward in ep 096|
|Att Loss 0.0701 | Att Reward in ep 004|
|Def Estimated: [20 78  0  1  1]| Att Labels: [23 77  0  0  0]|
|Def Amount of true predicted attacks: [20 76  0  0  0]|
02/07/2025 14:25:06 - INFO - End of Epoch.
|Epoch 017/100| time: 16.90|
|Def Loss 0.0177 | Def Reward in ep 098|
|Att Loss 0.0848 | Att Reward in ep 002|
|Def Estimated: [16 84  0  0  0]| Att Labels: [16 84  0  0  0]|
|Def Amount of true predicted attacks: [15 83  0  0  0]|
02/07/2025 14:25:23 - INFO - End of Epoch.
|Epoch 018/100| time: 17.11|
|Def Loss 0.0244 | Def Reward in ep 099|
|Att Loss 0.0875 | Att Reward in ep 001|
|Def Estimated: [23 76  1  0  0]| Att Labels: [23 77  0  0  0]|
|Def Amount of true predicted attacks: [23 76  0  0  0]|
02/07/2025 14:25:40 - INFO - End of Epoch.
|Epoch 019/100| time: 16.83|
|Def Loss 0.0189 | Def Reward in ep 096|
|Att Loss 0.0844 | Att Reward in ep 004|
|Def Estimated: [17 81  1  0  1]| Att Labels: [17 83  0  0  0]|
|Def Amount of true predicted attacks: [16 80  0  0  0]|
02/07/2025 14:25:57 - INFO - End of Epoch.
|Epoch 020/100| time: 17.11|
|Def Loss 0.0183 | Def Reward in ep 097|
|Att Loss 0.1125 | Att Reward in ep 003|
|Def Estimated: [17 81  0  2  0]| Att Labels: [16 84  0  0  0]|
|Def Amount of true predicted attacks: [16 81  0  0  0]|
02/07/2025 14:26:14 - INFO - End of Epoch.
|Epoch 021/100| time: 16.76|
|Def Loss 0.0122 | Def Reward in ep 098|
|Att Loss 0.1119 | Att Reward in ep 002|
|Def Estimated: [18 81  1  0  0]| Att Labels: [19 81  0  0  0]|
|Def Amount of true predicted attacks: [18 80  0  0  0]|
02/07/2025 14:26:31 - INFO - End of Epoch.
|Epoch 022/100| time: 16.97|
|Def Loss 0.0091 | Def Reward in ep 098|
|Att Loss 0.1100 | Att Reward in ep 002|
|Def Estimated: [20 78  0  0  2]| Att Labels: [20 80  0  0  0]|
|Def Amount of true predicted attacks: [20 78  0  0  0]|
02/07/2025 14:26:48 - INFO - End of Epoch.
|Epoch 023/100| time: 16.69|
|Def Loss 0.0097 | Def Reward in ep 099|
|Att Loss 0.1287 | Att Reward in ep 001|
|Def Estimated: [18 82  0  0  0]| Att Labels: [19 81  0  0  0]|
|Def Amount of true predicted attacks: [18 81  0  0  0]|
02/07/2025 14:27:04 - INFO - End of Epoch.
|Epoch 024/100| time: 16.95|
|Def Loss 0.0068 | Def Reward in ep 098|
|Att Loss 0.0969 | Att Reward in ep 002|
|Def Estimated: [22 77  0  1  0]| Att Labels: [23 77  0  0  0]|
|Def Amount of true predicted attacks: [22 76  0  0  0]|
02/07/2025 14:27:21 - INFO - End of Epoch.
|Epoch 025/100| time: 16.99|
|Def Loss 0.0063 | Def Reward in ep 100|
|Att Loss 0.0969 | Att Reward in ep 000|
|Def Estimated: [22 78  0  0  0]| Att Labels: [22 78  0  0  0]|
|Def Amount of true predicted attacks: [22 78  0  0  0]|
02/07/2025 14:27:38 - INFO - End of Epoch.
|Epoch 026/100| time: 16.66|
|Def Loss 0.0060 | Def Reward in ep 100|
|Att Loss 0.0747 | Att Reward in ep 000|
|Def Estimated: [23 77  0  0  0]| Att Labels: [23 77  0  0  0]|
|Def Amount of true predicted attacks: [23 77  0  0  0]|
02/07/2025 14:27:55 - INFO - End of Epoch.
|Epoch 027/100| time: 17.04|
|Def Loss 0.0138 | Def Reward in ep 099|
|Att Loss 0.0746 | Att Reward in ep 001|
|Def Estimated: [25 75  0  0  0]| Att Labels: [26 74  0  0  0]|
|Def Amount of true predicted attacks: [25 74  0  0  0]|
02/07/2025 14:28:12 - INFO - End of Epoch.
|Epoch 028/100| time: 17.05|
|Def Loss 0.0105 | Def Reward in ep 098|
|Att Loss 0.0661 | Att Reward in ep 002|
|Def Estimated: [17 83  0  0  0]| Att Labels: [17 83  0  0  0]|
|Def Amount of true predicted attacks: [16 82  0  0  0]|
02/07/2025 14:28:29 - INFO - End of Epoch.
|Epoch 029/100| time: 16.74|
|Def Loss 0.0086 | Def Reward in ep 099|
|Att Loss 0.0703 | Att Reward in ep 001|
|Def Estimated: [24 75  0  0  1]| Att Labels: [24 76  0  0  0]|
|Def Amount of true predicted attacks: [24 75  0  0  0]|
02/07/2025 14:28:46 - INFO - End of Epoch.
|Epoch 030/100| time: 17.08|
|Def Loss 0.0198 | Def Reward in ep 099|
|Att Loss 0.0590 | Att Reward in ep 001|
|Def Estimated: [23 77  0  0  0]| Att Labels: [22 78  0  0  0]|
|Def Amount of true predicted attacks: [22 77  0  0  0]|
02/07/2025 14:29:03 - INFO - End of Epoch.
|Epoch 031/100| time: 17.08|
|Def Loss 0.0101 | Def Reward in ep 100|
|Att Loss 0.0508 | Att Reward in ep 000|
|Def Estimated: [13 87  0  0  0]| Att Labels: [13 87  0  0  0]|
|Def Amount of true predicted attacks: [13 87  0  0  0]|
02/07/2025 14:29:20 - INFO - End of Epoch.
|Epoch 032/100| time: 17.06|
|Def Loss 0.0105 | Def Reward in ep 099|
|Att Loss 0.0453 | Att Reward in ep 001|
|Def Estimated: [17 83  0  0  0]| Att Labels: [16 84  0  0  0]|
|Def Amount of true predicted attacks: [16 83  0  0  0]|
02/07/2025 14:29:37 - INFO - End of Epoch.
|Epoch 033/100| time: 16.90|
|Def Loss 0.0061 | Def Reward in ep 098|
|Att Loss 0.0394 | Att Reward in ep 002|
|Def Estimated: [18 81  0  1  0]| Att Labels: [19 81  0  0  0]|
|Def Amount of true predicted attacks: [18 80  0  0  0]|
02/07/2025 14:29:54 - INFO - End of Epoch.
|Epoch 034/100| time: 16.91|
|Def Loss 0.0175 | Def Reward in ep 097|
|Att Loss 0.0370 | Att Reward in ep 003|
|Def Estimated: [20 78  0  1  1]| Att Labels: [21 79  0  0  0]|
|Def Amount of true predicted attacks: [20 77  0  0  0]|
02/07/2025 14:30:11 - INFO - End of Epoch.
|Epoch 035/100| time: 17.08|
|Def Loss 0.0251 | Def Reward in ep 099|
|Att Loss 0.0558 | Att Reward in ep 001|
|Def Estimated: [22 78  0  0  0]| Att Labels: [23 77  0  0  0]|
|Def Amount of true predicted attacks: [22 77  0  0  0]|
02/07/2025 14:30:28 - INFO - End of Epoch.
|Epoch 036/100| time: 16.88|
|Def Loss 0.0188 | Def Reward in ep 098|
|Att Loss 0.0655 | Att Reward in ep 002|
|Def Estimated: [17 82  1  0  0]| Att Labels: [16 84  0  0  0]|
|Def Amount of true predicted attacks: [16 82  0  0  0]|
02/07/2025 14:30:45 - INFO - End of Epoch.
|Epoch 037/100| time: 17.16|
|Def Loss 0.0053 | Def Reward in ep 098|
|Att Loss 0.0666 | Att Reward in ep 002|
|Def Estimated: [17 81  0  1  1]| Att Labels: [18 82  0  0  0]|
|Def Amount of true predicted attacks: [17 81  0  0  0]|
02/07/2025 14:31:02 - INFO - End of Epoch.
|Epoch 038/100| time: 17.20|
|Def Loss 0.0074 | Def Reward in ep 099|
|Att Loss 0.0765 | Att Reward in ep 001|
|Def Estimated: [22 78  0  0  0]| Att Labels: [23 77  0  0  0]|
|Def Amount of true predicted attacks: [22 77  0  0  0]|
02/07/2025 14:31:19 - INFO - End of Epoch.
|Epoch 039/100| time: 16.97|
|Def Loss 0.0082 | Def Reward in ep 100|
|Att Loss 0.0666 | Att Reward in ep 000|
|Def Estimated: [15 85  0  0  0]| Att Labels: [15 85  0  0  0]|
|Def Amount of true predicted attacks: [15 85  0  0  0]|
02/07/2025 14:31:36 - INFO - End of Epoch.
|Epoch 040/100| time: 17.04|
|Def Loss 0.0104 | Def Reward in ep 097|
|Att Loss 0.0630 | Att Reward in ep 003|
|Def Estimated: [21 78  0  1  0]| Att Labels: [24 76  0  0  0]|
|Def Amount of true predicted attacks: [21 76  0  0  0]|
02/07/2025 14:31:54 - INFO - End of Epoch.
|Epoch 041/100| time: 17.32|
|Def Loss 0.0074 | Def Reward in ep 098|
|Att Loss 0.0706 | Att Reward in ep 002|
|Def Estimated: [24 75  1  0  0]| Att Labels: [23 77  0  0  0]|
|Def Amount of true predicted attacks: [23 75  0  0  0]|
02/07/2025 14:32:11 - INFO - End of Epoch.
|Epoch 042/100| time: 16.91|
|Def Loss 0.0065 | Def Reward in ep 099|
|Att Loss 0.0783 | Att Reward in ep 001|
|Def Estimated: [10 89  1  0  0]| Att Labels: [11 89  0  0  0]|
|Def Amount of true predicted attacks: [10 89  0  0  0]|
02/07/2025 14:32:28 - INFO - End of Epoch.
|Epoch 043/100| time: 17.31|
|Def Loss 0.0043 | Def Reward in ep 098|
|Att Loss 0.0913 | Att Reward in ep 002|
|Def Estimated: [22 77  1  0  0]| Att Labels: [23 77  0  0  0]|
|Def Amount of true predicted attacks: [22 76  0  0  0]|
02/07/2025 14:32:45 - INFO - End of Epoch.
|Epoch 044/100| time: 17.33|
|Def Loss 0.0013 | Def Reward in ep 100|
|Att Loss 0.0816 | Att Reward in ep 000|
|Def Estimated: [21 79  0  0  0]| Att Labels: [21 79  0  0  0]|
|Def Amount of true predicted attacks: [21 79  0  0  0]|
02/07/2025 14:33:02 - INFO - End of Epoch.
|Epoch 045/100| time: 17.14|
|Def Loss 0.0003 | Def Reward in ep 100|
|Att Loss 0.0689 | Att Reward in ep 000|
|Def Estimated: [17 83  0  0  0]| Att Labels: [17 83  0  0  0]|
|Def Amount of true predicted attacks: [17 83  0  0  0]|
02/07/2025 14:33:19 - INFO - End of Epoch.
|Epoch 046/100| time: 17.15|
|Def Loss 0.0014 | Def Reward in ep 099|
|Att Loss 0.0591 | Att Reward in ep 001|
|Def Estimated: [24 76  0  0  0]| Att Labels: [23 77  0  0  0]|
|Def Amount of true predicted attacks: [23 76  0  0  0]|
02/07/2025 14:33:36 - INFO - End of Epoch.
|Epoch 047/100| time: 16.81|
|Def Loss 0.0002 | Def Reward in ep 099|
|Att Loss 0.0483 | Att Reward in ep 001|
|Def Estimated: [16 83  0  1  0]| Att Labels: [16 84  0  0  0]|
|Def Amount of true predicted attacks: [16 83  0  0  0]|
02/07/2025 14:33:53 - INFO - End of Epoch.
|Epoch 048/100| time: 16.98|
|Def Loss 0.0002 | Def Reward in ep 100|
|Att Loss 0.0444 | Att Reward in ep 000|
|Def Estimated: [14 86  0  0  0]| Att Labels: [14 86  0  0  0]|
|Def Amount of true predicted attacks: [14 86  0  0  0]|
02/07/2025 14:34:10 - INFO - End of Epoch.
|Epoch 049/100| time: 17.15|
|Def Loss 0.0002 | Def Reward in ep 099|
|Att Loss 0.0442 | Att Reward in ep 001|
|Def Estimated: [23 77  0  0  0]| Att Labels: [22 78  0  0  0]|
|Def Amount of true predicted attacks: [22 77  0  0  0]|
02/07/2025 14:34:27 - INFO - End of Epoch.
|Epoch 050/100| time: 17.04|
|Def Loss 0.0001 | Def Reward in ep 096|
|Att Loss 0.0373 | Att Reward in ep 004|
|Def Estimated: [22 74  0  2  2]| Att Labels: [22 78  0  0  0]|
|Def Amount of true predicted attacks: [22 74  0  0  0]|
02/07/2025 14:34:44 - INFO - End of Epoch.
|Epoch 051/100| time: 17.04|
|Def Loss 0.0001 | Def Reward in ep 100|
|Att Loss 0.0550 | Att Reward in ep 000|
|Def Estimated: [21 79  0  0  0]| Att Labels: [21 79  0  0  0]|
|Def Amount of true predicted attacks: [21 79  0  0  0]|
02/07/2025 14:35:02 - INFO - End of Epoch.
|Epoch 052/100| time: 17.34|
|Def Loss 0.0001 | Def Reward in ep 100|
|Att Loss 0.0473 | Att Reward in ep 000|
|Def Estimated: [18 82  0  0  0]| Att Labels: [18 82  0  0  0]|
|Def Amount of true predicted attacks: [18 82  0  0  0]|
02/07/2025 14:35:19 - INFO - End of Epoch.
|Epoch 053/100| time: 17.34|
|Def Loss 0.0005 | Def Reward in ep 100|
|Att Loss 0.0356 | Att Reward in ep 000|
|Def Estimated: [22 78  0  0  0]| Att Labels: [22 78  0  0  0]|
|Def Amount of true predicted attacks: [22 78  0  0  0]|
02/07/2025 14:35:36 - INFO - End of Epoch.
|Epoch 054/100| time: 16.71|
|Def Loss 0.0002 | Def Reward in ep 099|
|Att Loss 0.0432 | Att Reward in ep 001|
|Def Estimated: [21 78  0  1  0]| Att Labels: [21 79  0  0  0]|
|Def Amount of true predicted attacks: [21 78  0  0  0]|
02/07/2025 14:35:53 - INFO - End of Epoch.
|Epoch 055/100| time: 17.20|
|Def Loss 0.0001 | Def Reward in ep 100|
|Att Loss 0.0364 | Att Reward in ep 000|
|Def Estimated: [21 79  0  0  0]| Att Labels: [21 79  0  0  0]|
|Def Amount of true predicted attacks: [21 79  0  0  0]|
02/07/2025 14:36:10 - INFO - End of Epoch.
|Epoch 056/100| time: 17.22|
|Def Loss 0.0001 | Def Reward in ep 100|
|Att Loss 0.0386 | Att Reward in ep 000|
|Def Estimated: [17 83  0  0  0]| Att Labels: [17 83  0  0  0]|
|Def Amount of true predicted attacks: [17 83  0  0  0]|
02/07/2025 14:36:27 - INFO - End of Epoch.
|Epoch 057/100| time: 17.11|
|Def Loss 0.0001 | Def Reward in ep 100|
|Att Loss 0.0429 | Att Reward in ep 000|
|Def Estimated: [17 83  0  0  0]| Att Labels: [17 83  0  0  0]|
|Def Amount of true predicted attacks: [17 83  0  0  0]|
02/07/2025 14:36:45 - INFO - End of Epoch.
|Epoch 058/100| time: 17.21|
|Def Loss 0.0017 | Def Reward in ep 098|
|Att Loss 0.0384 | Att Reward in ep 002|
|Def Estimated: [17 82  0  0  1]| Att Labels: [16 84  0  0  0]|
|Def Amount of true predicted attacks: [16 82  0  0  0]|
02/07/2025 14:37:02 - INFO - End of Epoch.
|Epoch 059/100| time: 17.80|
|Def Loss 0.0042 | Def Reward in ep 099|
|Att Loss 0.0468 | Att Reward in ep 001|
|Def Estimated: [15 85  0  0  0]| Att Labels: [16 84  0  0  0]|
|Def Amount of true predicted attacks: [15 84  0  0  0]|
02/07/2025 14:37:20 - INFO - End of Epoch.
|Epoch 060/100| time: 17.68|
|Def Loss 0.0002 | Def Reward in ep 099|
|Att Loss 0.0494 | Att Reward in ep 001|
|Def Estimated: [19 80  0  1  0]| Att Labels: [19 81  0  0  0]|
|Def Amount of true predicted attacks: [19 80  0  0  0]|
02/07/2025 14:37:37 - INFO - End of Epoch.
|Epoch 061/100| time: 16.97|
|Def Loss 0.0002 | Def Reward in ep 096|
|Att Loss 0.0368 | Att Reward in ep 004|
|Def Estimated: [21 77  0  0  2]| Att Labels: [20 80  0  0  0]|
|Def Amount of true predicted attacks: [19 77  0  0  0]|
02/07/2025 14:37:54 - INFO - End of Epoch.
|Epoch 062/100| time: 17.08|
|Def Loss 0.0006 | Def Reward in ep 099|
|Att Loss 0.0551 | Att Reward in ep 001|
|Def Estimated: [19 81  0  0  0]| Att Labels: [18 82  0  0  0]|
|Def Amount of true predicted attacks: [18 81  0  0  0]|
02/07/2025 14:38:11 - INFO - End of Epoch.
|Epoch 063/100| time: 17.27|
|Def Loss 0.0002 | Def Reward in ep 100|
|Att Loss 0.0589 | Att Reward in ep 000|
|Def Estimated: [18 82  0  0  0]| Att Labels: [18 82  0  0  0]|
|Def Amount of true predicted attacks: [18 82  0  0  0]|
02/07/2025 14:38:29 - INFO - End of Epoch.
|Epoch 064/100| time: 17.17|
|Def Loss 0.0001 | Def Reward in ep 100|
|Att Loss 0.0602 | Att Reward in ep 000|
|Def Estimated: [15 85  0  0  0]| Att Labels: [15 85  0  0  0]|
|Def Amount of true predicted attacks: [15 85  0  0  0]|
02/07/2025 14:38:45 - INFO - End of Epoch.
|Epoch 065/100| time: 16.86|
|Def Loss 0.0001 | Def Reward in ep 098|
|Att Loss 0.0571 | Att Reward in ep 002|
|Def Estimated: [ 9 89  0  0  2]| Att Labels: [ 9 91  0  0  0]|
|Def Amount of true predicted attacks: [ 9 89  0  0  0]|
02/07/2025 14:39:03 - INFO - End of Epoch.
|Epoch 066/100| time: 17.17|
|Def Loss 0.0001 | Def Reward in ep 100|
|Att Loss 0.0732 | Att Reward in ep 000|
|Def Estimated: [17 83  0  0  0]| Att Labels: [17 83  0  0  0]|
|Def Amount of true predicted attacks: [17 83  0  0  0]|
02/07/2025 14:39:20 - INFO - End of Epoch.
|Epoch 067/100| time: 17.19|
|Def Loss 0.0001 | Def Reward in ep 099|
|Att Loss 0.0648 | Att Reward in ep 001|
|Def Estimated: [18 81  1  0  0]| Att Labels: [18 82  0  0  0]|
|Def Amount of true predicted attacks: [18 81  0  0  0]|
02/07/2025 14:39:37 - INFO - End of Epoch.
|Epoch 068/100| time: 16.96|
|Def Loss 0.0002 | Def Reward in ep 099|
|Att Loss 0.0638 | Att Reward in ep 001|
|Def Estimated: [15 85  0  0  0]| Att Labels: [14 86  0  0  0]|
|Def Amount of true predicted attacks: [14 85  0  0  0]|
02/07/2025 14:39:54 - INFO - End of Epoch.
|Epoch 069/100| time: 16.98|
|Def Loss 0.0077 | Def Reward in ep 097|
|Att Loss 0.0737 | Att Reward in ep 003|
|Def Estimated: [14 84  0  0  2]| Att Labels: [16 84  0  0  0]|
|Def Amount of true predicted attacks: [14 83  0  0  0]|
02/07/2025 14:40:11 - INFO - End of Epoch.
|Epoch 070/100| time: 17.06|
|Def Loss 0.0054 | Def Reward in ep 099|
|Att Loss 0.0900 | Att Reward in ep 001|
|Def Estimated: [16 84  0  0  0]| Att Labels: [17 83  0  0  0]|
|Def Amount of true predicted attacks: [16 83  0  0  0]|
02/07/2025 14:40:28 - INFO - End of Epoch.
|Epoch 071/100| time: 17.37|
|Def Loss 0.0041 | Def Reward in ep 098|
|Att Loss 0.0874 | Att Reward in ep 002|
|Def Estimated: [23 76  0  0  1]| Att Labels: [24 76  0  0  0]|
|Def Amount of true predicted attacks: [23 75  0  0  0]|
02/07/2025 14:40:46 - INFO - End of Epoch.
|Epoch 072/100| time: 17.45|
|Def Loss 0.0127 | Def Reward in ep 099|
|Att Loss 0.0588 | Att Reward in ep 001|
|Def Estimated: [20 79  0  1  0]| Att Labels: [20 80  0  0  0]|
|Def Amount of true predicted attacks: [20 79  0  0  0]|
02/07/2025 14:41:03 - INFO - End of Epoch.
|Epoch 073/100| time: 17.75|
|Def Loss 0.0211 | Def Reward in ep 095|
|Att Loss 0.0647 | Att Reward in ep 005|
|Def Estimated: [20 80  0  0  0]| Att Labels: [21 79  0  0  0]|
|Def Amount of true predicted attacks: [18 77  0  0  0]|
02/07/2025 14:41:21 - INFO - End of Epoch.
|Epoch 074/100| time: 17.40|
|Def Loss 0.0112 | Def Reward in ep 100|
|Att Loss 0.0896 | Att Reward in ep 000|
|Def Estimated: [19 81  0  0  0]| Att Labels: [19 81  0  0  0]|
|Def Amount of true predicted attacks: [19 81  0  0  0]|
02/07/2025 14:41:38 - INFO - End of Epoch.
|Epoch 075/100| time: 17.26|
|Def Loss 0.0014 | Def Reward in ep 099|
|Att Loss 0.0934 | Att Reward in ep 001|
|Def Estimated: [21 79  0  0  0]| Att Labels: [20 80  0  0  0]|
|Def Amount of true predicted attacks: [20 79  0  0  0]|
02/07/2025 14:41:55 - INFO - End of Epoch.
|Epoch 076/100| time: 17.45|
|Def Loss 0.0004 | Def Reward in ep 100|
|Att Loss 0.0888 | Att Reward in ep 000|
|Def Estimated: [13 87  0  0  0]| Att Labels: [13 87  0  0  0]|
|Def Amount of true predicted attacks: [13 87  0  0  0]|
02/07/2025 14:42:13 - INFO - End of Epoch.
|Epoch 077/100| time: 17.54|
|Def Loss 0.0002 | Def Reward in ep 100|
|Att Loss 0.0886 | Att Reward in ep 000|
|Def Estimated: [22 78  0  0  0]| Att Labels: [22 78  0  0  0]|
|Def Amount of true predicted attacks: [22 78  0  0  0]|
02/07/2025 14:42:30 - INFO - End of Epoch.
|Epoch 078/100| time: 17.44|
|Def Loss 0.0002 | Def Reward in ep 098|
|Att Loss 0.0747 | Att Reward in ep 002|
|Def Estimated: [28 70  2  0  0]| Att Labels: [30 70  0  0  0]|
|Def Amount of true predicted attacks: [28 70  0  0  0]|
02/07/2025 14:42:48 - INFO - End of Epoch.
|Epoch 079/100| time: 17.28|
|Def Loss 0.0008 | Def Reward in ep 100|
|Att Loss 0.0812 | Att Reward in ep 000|
|Def Estimated: [18 82  0  0  0]| Att Labels: [18 82  0  0  0]|
|Def Amount of true predicted attacks: [18 82  0  0  0]|
02/07/2025 14:43:05 - INFO - End of Epoch.
|Epoch 080/100| time: 17.52|
|Def Loss 0.0219 | Def Reward in ep 098|
|Att Loss 0.0633 | Att Reward in ep 002|
|Def Estimated: [20 80  0  0  0]| Att Labels: [22 78  0  0  0]|
|Def Amount of true predicted attacks: [20 78  0  0  0]|
02/07/2025 14:43:23 - INFO - End of Epoch.
|Epoch 081/100| time: 17.62|
|Def Loss 0.0552 | Def Reward in ep 097|
|Att Loss 0.0723 | Att Reward in ep 003|
|Def Estimated: [22 78  0  0  0]| Att Labels: [19 81  0  0  0]|
|Def Amount of true predicted attacks: [19 78  0  0  0]|
02/07/2025 14:43:40 - INFO - End of Epoch.
|Epoch 082/100| time: 17.24|
|Def Loss 0.0168 | Def Reward in ep 099|
|Att Loss 0.0746 | Att Reward in ep 001|
|Def Estimated: [25 75  0  0  0]| Att Labels: [24 76  0  0  0]|
|Def Amount of true predicted attacks: [24 75  0  0  0]|
02/07/2025 14:43:58 - INFO - End of Epoch.
|Epoch 083/100| time: 17.51|
|Def Loss 0.0223 | Def Reward in ep 099|
|Att Loss 0.0678 | Att Reward in ep 001|
|Def Estimated: [24 75  0  1  0]| Att Labels: [24 76  0  0  0]|
|Def Amount of true predicted attacks: [24 75  0  0  0]|
02/07/2025 14:44:15 - INFO - End of Epoch.
|Epoch 084/100| time: 17.71|
|Def Loss 0.0087 | Def Reward in ep 100|
|Att Loss 0.0633 | Att Reward in ep 000|
|Def Estimated: [16 84  0  0  0]| Att Labels: [16 84  0  0  0]|
|Def Amount of true predicted attacks: [16 84  0  0  0]|
02/07/2025 14:44:33 - INFO - End of Epoch.
|Epoch 085/100| time: 17.74|
|Def Loss 0.0141 | Def Reward in ep 100|
|Att Loss 0.0512 | Att Reward in ep 000|
|Def Estimated: [25 75  0  0  0]| Att Labels: [25 75  0  0  0]|
|Def Amount of true predicted attacks: [25 75  0  0  0]|
02/07/2025 14:44:50 - INFO - End of Epoch.
|Epoch 086/100| time: 17.26|
|Def Loss 0.0098 | Def Reward in ep 097|
|Att Loss 0.0682 | Att Reward in ep 003|
|Def Estimated: [20 77  0  3  0]| Att Labels: [21 79  0  0  0]|
|Def Amount of true predicted attacks: [20 77  0  0  0]|
02/07/2025 14:45:08 - INFO - End of Epoch.
|Epoch 087/100| time: 17.49|
|Def Loss 0.0061 | Def Reward in ep 100|
|Att Loss 0.0692 | Att Reward in ep 000|
|Def Estimated: [21 79  0  0  0]| Att Labels: [21 79  0  0  0]|
|Def Amount of true predicted attacks: [21 79  0  0  0]|
02/07/2025 14:45:25 - INFO - End of Epoch.
|Epoch 088/100| time: 17.36|
|Def Loss 0.0049 | Def Reward in ep 099|
|Att Loss 0.0609 | Att Reward in ep 001|
|Def Estimated: [14 85  0  1  0]| Att Labels: [14 86  0  0  0]|
|Def Amount of true predicted attacks: [14 85  0  0  0]|
02/07/2025 14:45:42 - INFO - End of Epoch.
|Epoch 089/100| time: 17.27|
|Def Loss 0.0039 | Def Reward in ep 098|
|Att Loss 0.0705 | Att Reward in ep 002|
|Def Estimated: [20 79  0  0  1]| Att Labels: [19 81  0  0  0]|
|Def Amount of true predicted attacks: [19 79  0  0  0]|
02/07/2025 14:46:00 - INFO - End of Epoch.
|Epoch 090/100| time: 17.63|
|Def Loss 0.0030 | Def Reward in ep 100|
|Att Loss 0.0747 | Att Reward in ep 000|
|Def Estimated: [14 86  0  0  0]| Att Labels: [14 86  0  0  0]|
|Def Amount of true predicted attacks: [14 86  0  0  0]|
02/07/2025 14:46:18 - INFO - End of Epoch.
|Epoch 091/100| time: 17.51|
|Def Loss 0.0002 | Def Reward in ep 100|
|Att Loss 0.0524 | Att Reward in ep 000|
|Def Estimated: [18 82  0  0  0]| Att Labels: [18 82  0  0  0]|
|Def Amount of true predicted attacks: [18 82  0  0  0]|
02/07/2025 14:46:35 - INFO - End of Epoch.
|Epoch 092/100| time: 17.78|
|Def Loss 0.0001 | Def Reward in ep 100|
|Att Loss 0.0504 | Att Reward in ep 000|
|Def Estimated: [28 72  0  0  0]| Att Labels: [28 72  0  0  0]|
|Def Amount of true predicted attacks: [28 72  0  0  0]|
02/07/2025 14:46:53 - INFO - End of Epoch.
|Epoch 093/100| time: 17.32|
|Def Loss 0.0001 | Def Reward in ep 099|
|Att Loss 0.0492 | Att Reward in ep 001|
|Def Estimated: [22 77  1  0  0]| Att Labels: [22 78  0  0  0]|
|Def Amount of true predicted attacks: [22 77  0  0  0]|
02/07/2025 14:47:11 - INFO - End of Epoch.
|Epoch 094/100| time: 17.99|
|Def Loss 0.0010 | Def Reward in ep 099|
|Att Loss 0.0467 | Att Reward in ep 001|
|Def Estimated: [20 80  0  0  0]| Att Labels: [21 79  0  0  0]|
|Def Amount of true predicted attacks: [20 79  0  0  0]|
02/07/2025 14:47:28 - INFO - End of Epoch.
|Epoch 095/100| time: 17.48|
|Def Loss 0.0006 | Def Reward in ep 100|
|Att Loss 0.0579 | Att Reward in ep 000|
|Def Estimated: [13 87  0  0  0]| Att Labels: [13 87  0  0  0]|
|Def Amount of true predicted attacks: [13 87  0  0  0]|
02/07/2025 14:47:46 - INFO - End of Epoch.
|Epoch 096/100| time: 17.54|
|Def Loss 0.0002 | Def Reward in ep 100|
|Att Loss 0.0437 | Att Reward in ep 000|
|Def Estimated: [20 80  0  0  0]| Att Labels: [20 80  0  0  0]|
|Def Amount of true predicted attacks: [20 80  0  0  0]|
02/07/2025 14:48:04 - INFO - End of Epoch.
|Epoch 097/100| time: 17.80|
|Def Loss 0.0001 | Def Reward in ep 099|
|Att Loss 0.0389 | Att Reward in ep 001|
|Def Estimated: [21 79  0  0  0]| Att Labels: [20 80  0  0  0]|
|Def Amount of true predicted attacks: [20 79  0  0  0]|
02/07/2025 14:48:21 - INFO - End of Epoch.
|Epoch 098/100| time: 17.45|
|Def Loss 0.0001 | Def Reward in ep 099|
|Att Loss 0.0396 | Att Reward in ep 001|
|Def Estimated: [ 9 90  0  1  0]| Att Labels: [ 9 91  0  0  0]|
|Def Amount of true predicted attacks: [ 9 90  0  0  0]|
02/07/2025 14:48:39 - INFO - End of Epoch.
|Epoch 099/100| time: 17.61|
|Def Loss 0.0000 | Def Reward in ep 100|
|Att Loss 0.0292 | Att Reward in ep 000|
|Def Estimated: [15 85  0  0  0]| Att Labels: [15 85  0  0  0]|
|Def Amount of true predicted attacks: [15 85  0  0  0]|
02/07/2025 14:48:39 - INFO - Model 'attacker_model' saved in: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-02-07-14-20-WIN-normal-DoS/attacker_model.keras
02/07/2025 14:48:39 - INFO - Model summary:
Model: "attacker_model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense (Dense)               (None, 100)               12300     
                                                                 
 dense_1 (Dense)             (None, 7)                 707       
                                                                 
=================================================================
Total params: 13,007
Trainable params: 13,007
Non-trainable params: 0
_________________________________________________________________

02/07/2025 14:48:39 - INFO - Model 'defender_model' saved in: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-02-07-14-20-WIN-normal-DoS/defender_model.keras
02/07/2025 14:48:39 - INFO - Model summary:
Model: "defender_model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense_4 (Dense)             (None, 100)               12300     
                                                                 
 dense_5 (Dense)             (None, 100)               10100     
                                                                 
 dense_6 (Dense)             (None, 100)               10100     
                                                                 
 dense_7 (Dense)             (None, 5)                 505       
                                                                 
=================================================================
Total params: 33,005
Trainable params: 33,005
Non-trainable params: 0
_________________________________________________________________

02/07/2025 14:48:39 - INFO - Saved trained models.
02/07/2025 14:48:39 - INFO - Total runtime: 00:28:27
02/07/2025 14:48:39 - INFO - End of the script at: 2025-02-07 14:48:39.217589
02/07/2025 14:48:39 - INFO - Trying to save summary plots under: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-02-07-14-20-WIN-normal-DoS/plots/
02/07/2025 14:48:40 - WARNING - The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
02/07/2025 14:48:40 - INFO - Plotted rewards and losses during training in: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-02-07-14-20-WIN-normal-DoS/plots/
02/07/2025 14:48:41 - INFO - Plotted attack distributions during training in: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-02-07-14-20-WIN-normal-DoS/plots/
02/07/2025 14:48:41 - INFO - Start testing the trained model.
02/07/2025 14:48:41 - INFO - Model 'defender_model' loaded from: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-02-07-14-20-WIN-normal-DoS/defender_model.keras
02/07/2025 14:48:41 - INFO - Model summary:
Model: "defender_model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense_4 (Dense)             (None, 100)               12300     
                                                                 
 dense_5 (Dense)             (None, 100)               10100     
                                                                 
 dense_6 (Dense)             (None, 100)               10100     
                                                                 
 dense_7 (Dense)             (None, 5)                 505       
                                                                 
=================================================================
Total params: 33,005
Trainable params: 33,005
Non-trainable params: 0
_________________________________________________________________

02/07/2025 14:48:41 - INFO - Reading formated test data from: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\data/datasets/formated/formated_test_adv.csv
02/07/2025 14:48:43 - INFO - Overall overview
Total reward: 15796 | Number of samples: 22544 | Accuracy = 70.07%
02/07/2025 14:48:43 - INFO - Overall overview per attack type
        Estimated Correct Total   F1_score Mismatch
normal      14524    9514  9711  78.514545     4813
DoS          8020    6282  7458  81.173278      562
Probe           0       0  2421        0.0     2421
R2L             0       0  2754        0.0     2754
U2R             0       0   200        0.0      200
General                          60.674461         
02/07/2025 14:48:43 - INFO - Performance measures on Test data
02/07/2025 14:48:43 - INFO - Accuracy =  0.7007
02/07/2025 14:48:43 - INFO - F1 =  0.6067
02/07/2025 14:48:43 - INFO - Precision_score =  0.5413
02/07/2025 14:48:43 - INFO - recall_score =  0.7007
02/07/2025 14:48:43 - INFO - Normalized confusion matrix
02/07/2025 14:48:43 - INFO - 
Confusion Matrix:
[[0.98 0.02 0.   0.   0.  ]
 [0.16 0.84 0.   0.   0.  ]
 [0.37 0.63 0.   0.   0.  ]
 [1.   0.   0.   0.   0.  ]
 [0.99 0.01 0.   0.   0.  ]]
02/07/2025 14:48:44 - INFO - Plotted confusion matrix in: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-02-07-14-20-WIN-normal-DoS/plots/
02/07/2025 14:48:45 - INFO - 
One vs All metrics: 
     name  accuracy        f1 precision    recall
0  normal  0.769029  0.785145  0.655054  0.979714
1     DoS  0.870742  0.811733  0.783292  0.842317
2     R2L  0.877839       0.0       0.0       0.0
3   Probe   0.89261       0.0       0.0       0.0
4     U2R  0.991128       0.0       0.0       0.0
02/07/2025 14:48:47 - INFO - Model metrics: 
loss=0.06819091737270355, accuracy=0.7006742358207703, precision=0.640424370765686, recall=0.7122959494590759
02/07/2025 14:48:47 - INFO - Time needed for testing: 5.278915166854858
