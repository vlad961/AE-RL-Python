04/23/2025 07:29:30 - INFO - Started script at: 2025-04-23-07-29
Current working dir: /workspace
Used data files: 
/workspace/data/datasets/cic_ids/cic-ids-2017/clean/all_benign.feather,
/workspace/data/datasets/cic_ids/cic-ids-2017/clean/all_malicious.feather
04/23/2025 07:29:30 - INFO - Setting up Attacker and Defender Agents...
04/23/2025 07:29:32 - INFO - One-vs-All Split ready (target: Web Attack):
04/23/2025 07:29:32 - INFO - Train: (50049, 67), Validation: (60628, 67), Test: (141466, 67)
04/23/2025 07:29:32 - INFO - [Init from split] Loaded 50049 train, 141466 test samples.
04/23/2025 07:29:55 - INFO - One-vs-All Split ready (target: Web Attack):
04/23/2025 07:29:55 - INFO - Train: (50059, 67), Validation: (75119, 67), Test: (425679, 67)
04/23/2025 07:29:55 - INFO - Initializing Attacker:CIC-2017-Web Attack's ReplayMemory with observation_size=67 and max_size=1000
04/23/2025 07:29:56 - WARNING - Skipping variable loading for optimizer 'Adam', because it has 25 variables whereas the saved optimizer has 1 variables. 
04/23/2025 07:29:56 - INFO - Initializing Defender's ReplayMemory with observation_size=67 and max_size=1000
04/23/2025 07:29:56 - WARNING - Skipping variable loading for optimizer 'Adam', because it has 17 variables whereas the saved optimizer has 1 variables. 
04/23/2025 07:29:56 - INFO - Creating environment...
04/23/2025 07:29:56 - INFO - Start Training with the following parameters:
-----------------------------------------------------------------------------------------------------------------------
Total episodes: 100 | Iterations in episode: 100 | Minibatch from mem size: 100 | Total Samples: 10000 | Data shape: (50049, 67)
-----------------------------------------------------------------------------------------------------------------------
Attacker<Attack-Type>: Num_actions=4 | gamma=0.001 | epsilon=1 | ANN hidden size=100 | ANN hidden layers=5 | Learning rate=0.001
-----------------------------------------------------------------------------------------------------------------------
Defender: Num_actions=2 | gamma=0.001 | epsilon=1 | ANN hidden size=100 | ANN hidden layers=3 | Learning rate=0.001
-----------------------------------------------------------------------------------------------------------------------
Used Attack types: '['Benign', 'Web Attack']' | Attack name(s): ['Benign', 'Web Attack Brute Force', 'Web Attack Sql Injection', 'Web Attack XSS']
-----------------------------------------------------------------------------------------------------------------------

04/23/2025 07:29:57 - INFO - End of Episode.
|Episode 000/100| time: 0.52|
|Def Loss 0.0000 | Def Reward in ep 043|
|Att Loss 0.0000 | Att Reward in ep 057|
|Def Estimated: [52 48]| Att Labels: [19 81]|
|Def Amount of true predicted attacks: [ 7 36]|
04/23/2025 07:30:00 - WARNING - 5 out of the last 5 calls to <function QNetwork.predict at 0x73972162f380> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
04/23/2025 07:30:02 - INFO - End of Episode.
|Episode 001/100| time: 4.04|
|Def Loss 1.5846 | Def Reward in ep 059|
|Att Loss 3.1129 | Att Reward in ep 041|
|Def Estimated: [39 61]| Att Labels: [28 72]|
|Def Amount of true predicted attacks: [13 46]|
04/23/2025 07:30:04 - INFO - End of Episode.
|Episode 002/100| time: 2.08|
|Def Loss 0.5484 | Def Reward in ep 071|
|Att Loss 2.8971 | Att Reward in ep 029|
|Def Estimated: [38 62]| Att Labels: [31 69]|
|Def Amount of true predicted attacks: [20 51]|
04/23/2025 07:30:07 - INFO - End of Episode.
|Episode 003/100| time: 2.15|
|Def Loss 0.4414 | Def Reward in ep 088|
|Att Loss 2.6582 | Att Reward in ep 012|
|Def Estimated: [38 62]| Att Labels: [36 64]|
|Def Amount of true predicted attacks: [31 57]|
04/23/2025 07:30:09 - INFO - End of Episode.
|Episode 004/100| time: 2.13|
|Def Loss 0.5115 | Def Reward in ep 088|
|Att Loss 2.4229 | Att Reward in ep 012|
|Def Estimated: [37 63]| Att Labels: [37 63]|
|Def Amount of true predicted attacks: [31 57]|
04/23/2025 07:30:11 - INFO - End of Episode.
|Episode 005/100| time: 2.04|
|Def Loss 0.5723 | Def Reward in ep 097|
|Att Loss 2.1669 | Att Reward in ep 003|
|Def Estimated: [32 68]| Att Labels: [35 65]|
|Def Amount of true predicted attacks: [32 65]|
04/23/2025 07:30:14 - INFO - End of Episode.
|Episode 006/100| time: 2.12|
|Def Loss 0.5664 | Def Reward in ep 097|
|Att Loss 1.9072 | Att Reward in ep 003|
|Def Estimated: [30 70]| Att Labels: [33 67]|
|Def Amount of true predicted attacks: [30 67]|
04/23/2025 07:30:16 - INFO - End of Episode.
|Episode 007/100| time: 2.09|
|Def Loss 0.5583 | Def Reward in ep 096|
|Att Loss 1.7217 | Att Reward in ep 004|
|Def Estimated: [25 75]| Att Labels: [27 73]|
|Def Amount of true predicted attacks: [24 72]|
04/23/2025 07:30:18 - INFO - End of Episode.
|Episode 008/100| time: 2.07|
|Def Loss 0.5481 | Def Reward in ep 096|
|Att Loss 1.5059 | Att Reward in ep 004|
|Def Estimated: [33 67]| Att Labels: [37 63]|
|Def Amount of true predicted attacks: [33 63]|
04/23/2025 07:30:20 - INFO - End of Episode.
|Episode 009/100| time: 2.07|
|Def Loss 0.4622 | Def Reward in ep 098|
|Att Loss 1.4474 | Att Reward in ep 002|
|Def Estimated: [29 71]| Att Labels: [31 69]|
|Def Amount of true predicted attacks: [29 69]|
04/23/2025 07:30:23 - INFO - End of Episode.
|Episode 010/100| time: 2.17|
|Def Loss 0.4322 | Def Reward in ep 095|
|Att Loss 1.2439 | Att Reward in ep 005|
|Def Estimated: [29 71]| Att Labels: [28 72]|
|Def Amount of true predicted attacks: [26 69]|
04/23/2025 07:30:25 - INFO - End of Episode.
|Episode 011/100| time: 1.98|
|Def Loss 0.4743 | Def Reward in ep 093|
|Att Loss 0.7876 | Att Reward in ep 007|
|Def Estimated: [35 65]| Att Labels: [38 62]|
|Def Amount of true predicted attacks: [33 60]|
04/23/2025 07:30:27 - INFO - End of Episode.
|Episode 012/100| time: 2.00|
|Def Loss 0.4924 | Def Reward in ep 096|
|Att Loss 0.4320 | Att Reward in ep 004|
|Def Estimated: [29 71]| Att Labels: [31 69]|
|Def Amount of true predicted attacks: [28 68]|
04/23/2025 07:30:29 - INFO - End of Episode.
|Episode 013/100| time: 1.98|
|Def Loss 0.4163 | Def Reward in ep 099|
|Att Loss 0.2813 | Att Reward in ep 001|
|Def Estimated: [30 70]| Att Labels: [29 71]|
|Def Amount of true predicted attacks: [29 70]|
04/23/2025 07:30:32 - INFO - End of Episode.
|Episode 014/100| time: 1.99|
|Def Loss 0.4081 | Def Reward in ep 099|
|Att Loss 0.2014 | Att Reward in ep 001|
|Def Estimated: [37 63]| Att Labels: [38 62]|
|Def Amount of true predicted attacks: [37 62]|
04/23/2025 07:30:34 - INFO - End of Episode.
|Episode 015/100| time: 2.05|
|Def Loss 0.3441 | Def Reward in ep 094|
|Att Loss 0.1394 | Att Reward in ep 006|
|Def Estimated: [32 68]| Att Labels: [36 64]|
|Def Amount of true predicted attacks: [31 63]|
04/23/2025 07:30:36 - INFO - End of Episode.
|Episode 016/100| time: 2.06|
|Def Loss 0.2891 | Def Reward in ep 099|
|Att Loss 0.1614 | Att Reward in ep 001|
|Def Estimated: [33 67]| Att Labels: [32 68]|
|Def Amount of true predicted attacks: [32 67]|
04/23/2025 07:30:39 - INFO - End of Episode.
|Episode 017/100| time: 2.17|
|Def Loss 0.2639 | Def Reward in ep 099|
|Att Loss 0.1429 | Att Reward in ep 001|
|Def Estimated: [33 67]| Att Labels: [32 68]|
|Def Amount of true predicted attacks: [32 67]|
04/23/2025 07:30:41 - INFO - End of Episode.
|Episode 018/100| time: 2.20|
|Def Loss 0.2519 | Def Reward in ep 098|
|Att Loss 0.1304 | Att Reward in ep 002|
|Def Estimated: [24 76]| Att Labels: [26 74]|
|Def Amount of true predicted attacks: [24 74]|
04/23/2025 07:30:44 - INFO - End of Episode.
|Episode 019/100| time: 2.30|
|Def Loss 0.3148 | Def Reward in ep 099|
|Att Loss 0.1283 | Att Reward in ep 001|
|Def Estimated: [37 63]| Att Labels: [38 62]|
|Def Amount of true predicted attacks: [37 62]|
04/23/2025 07:30:46 - INFO - End of Episode.
|Episode 020/100| time: 2.37|
|Def Loss 0.2780 | Def Reward in ep 095|
|Att Loss 0.1411 | Att Reward in ep 005|
|Def Estimated: [29 71]| Att Labels: [34 66]|
|Def Amount of true predicted attacks: [29 66]|
04/23/2025 07:30:49 - INFO - End of Episode.
|Episode 021/100| time: 2.39|
|Def Loss 0.3491 | Def Reward in ep 099|
|Att Loss 0.1188 | Att Reward in ep 001|
|Def Estimated: [38 62]| Att Labels: [39 61]|
|Def Amount of true predicted attacks: [38 61]|
04/23/2025 07:30:52 - INFO - End of Episode.
|Episode 022/100| time: 2.57|
|Def Loss 0.3078 | Def Reward in ep 098|
|Att Loss 0.0852 | Att Reward in ep 002|
|Def Estimated: [31 69]| Att Labels: [33 67]|
|Def Amount of true predicted attacks: [31 67]|
04/23/2025 07:30:54 - INFO - End of Episode.
|Episode 023/100| time: 2.32|
|Def Loss 0.2490 | Def Reward in ep 099|
|Att Loss 0.0891 | Att Reward in ep 001|
|Def Estimated: [28 72]| Att Labels: [27 73]|
|Def Amount of true predicted attacks: [27 72]|
04/23/2025 07:30:57 - INFO - End of Episode.
|Episode 024/100| time: 2.26|
|Def Loss 0.2544 | Def Reward in ep 098|
|Att Loss 0.0817 | Att Reward in ep 002|
|Def Estimated: [28 72]| Att Labels: [30 70]|
|Def Amount of true predicted attacks: [28 70]|
04/23/2025 07:30:59 - INFO - End of Episode.
|Episode 025/100| time: 2.31|
|Def Loss 0.2228 | Def Reward in ep 099|
|Att Loss 0.0866 | Att Reward in ep 001|
|Def Estimated: [26 74]| Att Labels: [25 75]|
|Def Amount of true predicted attacks: [25 74]|
04/23/2025 07:31:02 - INFO - End of Episode.
|Episode 026/100| time: 2.38|
|Def Loss 0.1722 | Def Reward in ep 099|
|Att Loss 0.0724 | Att Reward in ep 001|
|Def Estimated: [29 71]| Att Labels: [30 70]|
|Def Amount of true predicted attacks: [29 70]|
04/23/2025 07:31:05 - INFO - End of Episode.
|Episode 027/100| time: 2.28|
|Def Loss 0.1755 | Def Reward in ep 098|
|Att Loss 0.0879 | Att Reward in ep 002|
|Def Estimated: [35 65]| Att Labels: [35 65]|
|Def Amount of true predicted attacks: [34 64]|
04/23/2025 07:31:07 - INFO - End of Episode.
|Episode 028/100| time: 2.26|
|Def Loss 0.1812 | Def Reward in ep 099|
|Att Loss 0.0994 | Att Reward in ep 001|
|Def Estimated: [33 67]| Att Labels: [32 68]|
|Def Amount of true predicted attacks: [32 67]|
04/23/2025 07:31:10 - INFO - End of Episode.
|Episode 029/100| time: 2.38|
|Def Loss 0.1763 | Def Reward in ep 099|
|Att Loss 0.1399 | Att Reward in ep 001|
|Def Estimated: [27 73]| Att Labels: [28 72]|
|Def Amount of true predicted attacks: [27 72]|
04/23/2025 07:31:13 - INFO - End of Episode.
|Episode 030/100| time: 2.36|
|Def Loss 0.1686 | Def Reward in ep 100|
|Att Loss 0.1160 | Att Reward in ep 000|
|Def Estimated: [34 66]| Att Labels: [34 66]|
|Def Amount of true predicted attacks: [34 66]|
04/23/2025 07:31:16 - INFO - End of Episode.
|Episode 031/100| time: 2.56|
|Def Loss 0.1079 | Def Reward in ep 099|
|Att Loss 0.1052 | Att Reward in ep 001|
|Def Estimated: [28 72]| Att Labels: [27 73]|
|Def Amount of true predicted attacks: [27 72]|
04/23/2025 07:31:18 - INFO - End of Episode.
|Episode 032/100| time: 2.33|
|Def Loss 0.0783 | Def Reward in ep 099|
|Att Loss 0.1017 | Att Reward in ep 001|
|Def Estimated: [24 76]| Att Labels: [25 75]|
|Def Amount of true predicted attacks: [24 75]|
04/23/2025 07:31:21 - INFO - End of Episode.
|Episode 033/100| time: 2.27|
|Def Loss 0.0813 | Def Reward in ep 099|
|Att Loss 0.1287 | Att Reward in ep 001|
|Def Estimated: [25 75]| Att Labels: [24 76]|
|Def Amount of true predicted attacks: [24 75]|
04/23/2025 07:31:24 - INFO - End of Episode.
|Episode 034/100| time: 2.38|
|Def Loss 0.0962 | Def Reward in ep 098|
|Att Loss 0.1266 | Att Reward in ep 002|
|Def Estimated: [18 82]| Att Labels: [16 84]|
|Def Amount of true predicted attacks: [16 82]|
04/23/2025 07:31:26 - INFO - End of Episode.
|Episode 035/100| time: 2.29|
|Def Loss 0.1034 | Def Reward in ep 099|
|Att Loss 0.1309 | Att Reward in ep 001|
|Def Estimated: [22 78]| Att Labels: [23 77]|
|Def Amount of true predicted attacks: [22 77]|
04/23/2025 07:31:29 - INFO - End of Episode.
|Episode 036/100| time: 2.35|
|Def Loss 0.0918 | Def Reward in ep 099|
|Att Loss 0.0982 | Att Reward in ep 001|
|Def Estimated: [21 79]| Att Labels: [22 78]|
|Def Amount of true predicted attacks: [21 78]|
04/23/2025 07:31:32 - INFO - End of Episode.
|Episode 037/100| time: 2.34|
|Def Loss 0.0872 | Def Reward in ep 097|
|Att Loss 0.1194 | Att Reward in ep 003|
|Def Estimated: [22 78]| Att Labels: [21 79]|
|Def Amount of true predicted attacks: [20 77]|
04/23/2025 07:31:34 - INFO - End of Episode.
|Episode 038/100| time: 2.36|
|Def Loss 0.0911 | Def Reward in ep 098|
|Att Loss 0.1262 | Att Reward in ep 002|
|Def Estimated: [33 67]| Att Labels: [31 69]|
|Def Amount of true predicted attacks: [31 67]|
04/23/2025 07:31:37 - INFO - End of Episode.
|Episode 039/100| time: 2.26|
|Def Loss 0.1089 | Def Reward in ep 099|
|Att Loss 0.1284 | Att Reward in ep 001|
|Def Estimated: [32 68]| Att Labels: [31 69]|
|Def Amount of true predicted attacks: [31 68]|
04/23/2025 07:31:39 - INFO - End of Episode.
|Episode 040/100| time: 2.16|
|Def Loss 0.0980 | Def Reward in ep 100|
|Att Loss 0.1429 | Att Reward in ep 000|
|Def Estimated: [18 82]| Att Labels: [18 82]|
|Def Amount of true predicted attacks: [18 82]|
04/23/2025 07:31:42 - INFO - End of Episode.
|Episode 041/100| time: 2.27|
|Def Loss 0.0934 | Def Reward in ep 100|
|Att Loss 0.1189 | Att Reward in ep 000|
|Def Estimated: [26 74]| Att Labels: [26 74]|
|Def Amount of true predicted attacks: [26 74]|
04/23/2025 07:31:45 - INFO - End of Episode.
|Episode 042/100| time: 2.21|
|Def Loss 0.0892 | Def Reward in ep 098|
|Att Loss 0.1269 | Att Reward in ep 002|
|Def Estimated: [23 77]| Att Labels: [23 77]|
|Def Amount of true predicted attacks: [22 76]|
04/23/2025 07:31:47 - INFO - End of Episode.
|Episode 043/100| time: 2.18|
|Def Loss 0.0966 | Def Reward in ep 100|
|Att Loss 0.1385 | Att Reward in ep 000|
|Def Estimated: [27 73]| Att Labels: [27 73]|
|Def Amount of true predicted attacks: [27 73]|
04/23/2025 07:31:50 - INFO - End of Episode.
|Episode 044/100| time: 2.27|
|Def Loss 0.1129 | Def Reward in ep 099|
|Att Loss 0.1410 | Att Reward in ep 001|
|Def Estimated: [31 69]| Att Labels: [32 68]|
|Def Amount of true predicted attacks: [31 68]|
04/23/2025 07:31:52 - INFO - End of Episode.
|Episode 045/100| time: 2.37|
|Def Loss 0.1098 | Def Reward in ep 098|
|Att Loss 0.1287 | Att Reward in ep 002|
|Def Estimated: [34 66]| Att Labels: [34 66]|
|Def Amount of true predicted attacks: [33 65]|
04/23/2025 07:31:55 - INFO - End of Episode.
|Episode 046/100| time: 2.33|
|Def Loss 0.0765 | Def Reward in ep 098|
|Att Loss 0.1292 | Att Reward in ep 002|
|Def Estimated: [33 67]| Att Labels: [35 65]|
|Def Amount of true predicted attacks: [33 65]|
04/23/2025 07:31:58 - INFO - End of Episode.
|Episode 047/100| time: 2.23|
|Def Loss 0.0826 | Def Reward in ep 100|
|Att Loss 0.1289 | Att Reward in ep 000|
|Def Estimated: [34 66]| Att Labels: [34 66]|
|Def Amount of true predicted attacks: [34 66]|
04/23/2025 07:32:00 - INFO - End of Episode.
|Episode 048/100| time: 2.24|
|Def Loss 0.1233 | Def Reward in ep 098|
|Att Loss 0.0958 | Att Reward in ep 002|
|Def Estimated: [31 69]| Att Labels: [29 71]|
|Def Amount of true predicted attacks: [29 69]|
04/23/2025 07:32:03 - INFO - End of Episode.
|Episode 049/100| time: 2.37|
|Def Loss 0.1136 | Def Reward in ep 098|
|Att Loss 0.0956 | Att Reward in ep 002|
|Def Estimated: [26 74]| Att Labels: [28 72]|
|Def Amount of true predicted attacks: [26 72]|
04/23/2025 07:32:06 - INFO - End of Episode.
|Episode 050/100| time: 2.37|
|Def Loss 0.1586 | Def Reward in ep 099|
|Att Loss 0.0968 | Att Reward in ep 001|
|Def Estimated: [35 65]| Att Labels: [34 66]|
|Def Amount of true predicted attacks: [34 65]|
04/23/2025 07:32:09 - INFO - End of Episode.
|Episode 051/100| time: 2.29|
|Def Loss 0.1522 | Def Reward in ep 099|
|Att Loss 0.1171 | Att Reward in ep 001|
|Def Estimated: [29 71]| Att Labels: [28 72]|
|Def Amount of true predicted attacks: [28 71]|
04/23/2025 07:32:12 - INFO - End of Episode.
|Episode 052/100| time: 2.52|
|Def Loss 0.1435 | Def Reward in ep 100|
|Att Loss 0.0912 | Att Reward in ep 000|
|Def Estimated: [25 75]| Att Labels: [25 75]|
|Def Amount of true predicted attacks: [25 75]|
04/23/2025 07:32:14 - INFO - End of Episode.
|Episode 053/100| time: 2.28|
|Def Loss 0.1597 | Def Reward in ep 099|
|Att Loss 0.0898 | Att Reward in ep 001|
|Def Estimated: [33 67]| Att Labels: [34 66]|
|Def Amount of true predicted attacks: [33 66]|
04/23/2025 07:32:17 - INFO - End of Episode.
|Episode 054/100| time: 2.36|
|Def Loss 0.1752 | Def Reward in ep 098|
|Att Loss 0.1169 | Att Reward in ep 002|
|Def Estimated: [30 70]| Att Labels: [30 70]|
|Def Amount of true predicted attacks: [29 69]|
04/23/2025 07:32:20 - INFO - End of Episode.
|Episode 055/100| time: 2.28|
|Def Loss 0.1621 | Def Reward in ep 099|
|Att Loss 0.1116 | Att Reward in ep 001|
|Def Estimated: [31 69]| Att Labels: [30 70]|
|Def Amount of true predicted attacks: [30 69]|
04/23/2025 07:32:23 - INFO - End of Episode.
|Episode 056/100| time: 2.28|
|Def Loss 0.1626 | Def Reward in ep 096|
|Att Loss 0.1103 | Att Reward in ep 004|
|Def Estimated: [30 70]| Att Labels: [28 72]|
|Def Amount of true predicted attacks: [27 69]|
04/23/2025 07:32:25 - INFO - End of Episode.
|Episode 057/100| time: 2.23|
|Def Loss 0.1919 | Def Reward in ep 097|
|Att Loss 0.1308 | Att Reward in ep 003|
|Def Estimated: [37 63]| Att Labels: [38 62]|
|Def Amount of true predicted attacks: [36 61]|
04/23/2025 07:32:28 - INFO - End of Episode.
|Episode 058/100| time: 2.15|
|Def Loss 0.1727 | Def Reward in ep 100|
|Att Loss 0.1711 | Att Reward in ep 000|
|Def Estimated: [31 69]| Att Labels: [31 69]|
|Def Amount of true predicted attacks: [31 69]|
04/23/2025 07:32:30 - INFO - End of Episode.
|Episode 059/100| time: 2.18|
|Def Loss 0.1540 | Def Reward in ep 098|
|Att Loss 0.1838 | Att Reward in ep 002|
|Def Estimated: [34 66]| Att Labels: [34 66]|
|Def Amount of true predicted attacks: [33 65]|
04/23/2025 07:32:33 - INFO - End of Episode.
|Episode 060/100| time: 2.25|
|Def Loss 0.1144 | Def Reward in ep 098|
|Att Loss 0.1530 | Att Reward in ep 002|
|Def Estimated: [37 63]| Att Labels: [35 65]|
|Def Amount of true predicted attacks: [35 63]|
04/23/2025 07:32:36 - INFO - End of Episode.
|Episode 061/100| time: 2.15|
|Def Loss 0.1192 | Def Reward in ep 096|
|Att Loss 0.1855 | Att Reward in ep 004|
|Def Estimated: [28 72]| Att Labels: [30 70]|
|Def Amount of true predicted attacks: [27 69]|
04/23/2025 07:32:38 - INFO - End of Episode.
|Episode 062/100| time: 2.21|
|Def Loss 0.1638 | Def Reward in ep 099|
|Att Loss 0.2136 | Att Reward in ep 001|
|Def Estimated: [39 61]| Att Labels: [38 62]|
|Def Amount of true predicted attacks: [38 61]|
04/23/2025 07:32:41 - INFO - End of Episode.
|Episode 063/100| time: 2.19|
|Def Loss 0.1446 | Def Reward in ep 099|
|Att Loss 0.1948 | Att Reward in ep 001|
|Def Estimated: [32 68]| Att Labels: [31 69]|
|Def Amount of true predicted attacks: [31 68]|
04/23/2025 07:32:44 - INFO - End of Episode.
|Episode 064/100| time: 2.15|
|Def Loss 0.1422 | Def Reward in ep 099|
|Att Loss 0.2038 | Att Reward in ep 001|
|Def Estimated: [30 70]| Att Labels: [31 69]|
|Def Amount of true predicted attacks: [30 69]|
04/23/2025 07:32:46 - INFO - End of Episode.
|Episode 065/100| time: 2.21|
|Def Loss 0.1435 | Def Reward in ep 098|
|Att Loss 0.2248 | Att Reward in ep 002|
|Def Estimated: [32 68]| Att Labels: [34 66]|
|Def Amount of true predicted attacks: [32 66]|
04/23/2025 07:32:49 - INFO - End of Episode.
|Episode 066/100| time: 2.19|
|Def Loss 0.1410 | Def Reward in ep 097|
|Att Loss 0.2225 | Att Reward in ep 003|
|Def Estimated: [34 66]| Att Labels: [33 67]|
|Def Amount of true predicted attacks: [32 65]|
04/23/2025 07:32:52 - INFO - End of Episode.
|Episode 067/100| time: 2.17|
|Def Loss 0.1172 | Def Reward in ep 098|
|Att Loss 0.2029 | Att Reward in ep 002|
|Def Estimated: [30 70]| Att Labels: [28 72]|
|Def Amount of true predicted attacks: [28 70]|
04/23/2025 07:32:54 - INFO - End of Episode.
|Episode 068/100| time: 2.19|
|Def Loss 0.1328 | Def Reward in ep 098|
|Att Loss 0.2015 | Att Reward in ep 002|
|Def Estimated: [34 66]| Att Labels: [34 66]|
|Def Amount of true predicted attacks: [33 65]|
04/23/2025 07:32:57 - INFO - End of Episode.
|Episode 069/100| time: 2.33|
|Def Loss 0.1286 | Def Reward in ep 099|
|Att Loss 0.1700 | Att Reward in ep 001|
|Def Estimated: [33 67]| Att Labels: [34 66]|
|Def Amount of true predicted attacks: [33 66]|
04/23/2025 07:33:00 - INFO - End of Episode.
|Episode 070/100| time: 2.47|
|Def Loss 0.1283 | Def Reward in ep 099|
|Att Loss 0.2021 | Att Reward in ep 001|
|Def Estimated: [30 70]| Att Labels: [29 71]|
|Def Amount of true predicted attacks: [29 70]|
04/23/2025 07:33:03 - INFO - End of Episode.
|Episode 071/100| time: 2.17|
|Def Loss 0.1256 | Def Reward in ep 099|
|Att Loss 0.1690 | Att Reward in ep 001|
|Def Estimated: [28 72]| Att Labels: [29 71]|
|Def Amount of true predicted attacks: [28 71]|
04/23/2025 07:33:05 - INFO - End of Episode.
|Episode 072/100| time: 2.12|
|Def Loss 0.0776 | Def Reward in ep 098|
|Att Loss 0.1759 | Att Reward in ep 002|
|Def Estimated: [26 74]| Att Labels: [26 74]|
|Def Amount of true predicted attacks: [25 73]|
04/23/2025 07:33:08 - INFO - End of Episode.
|Episode 073/100| time: 2.16|
|Def Loss 0.0945 | Def Reward in ep 099|
|Att Loss 0.1847 | Att Reward in ep 001|
|Def Estimated: [28 72]| Att Labels: [29 71]|
|Def Amount of true predicted attacks: [28 71]|
04/23/2025 07:33:11 - INFO - End of Episode.
|Episode 074/100| time: 2.11|
|Def Loss 0.1018 | Def Reward in ep 096|
|Att Loss 0.1762 | Att Reward in ep 004|
|Def Estimated: [27 73]| Att Labels: [29 71]|
|Def Amount of true predicted attacks: [26 70]|
04/23/2025 07:33:13 - INFO - End of Episode.
|Episode 075/100| time: 2.19|
|Def Loss 0.1297 | Def Reward in ep 099|
|Att Loss 0.1879 | Att Reward in ep 001|
|Def Estimated: [35 65]| Att Labels: [34 66]|
|Def Amount of true predicted attacks: [34 65]|
04/23/2025 07:33:16 - INFO - End of Episode.
|Episode 076/100| time: 2.17|
|Def Loss 0.1378 | Def Reward in ep 095|
|Att Loss 0.1748 | Att Reward in ep 005|
|Def Estimated: [32 68]| Att Labels: [33 67]|
|Def Amount of true predicted attacks: [30 65]|
04/23/2025 07:33:19 - INFO - End of Episode.
|Episode 077/100| time: 2.14|
|Def Loss 0.0891 | Def Reward in ep 099|
|Att Loss 0.1619 | Att Reward in ep 001|
|Def Estimated: [36 64]| Att Labels: [35 65]|
|Def Amount of true predicted attacks: [35 64]|
04/23/2025 07:33:21 - INFO - End of Episode.
|Episode 078/100| time: 2.23|
|Def Loss 0.0959 | Def Reward in ep 096|
|Att Loss 0.2065 | Att Reward in ep 004|
|Def Estimated: [33 67]| Att Labels: [37 63]|
|Def Amount of true predicted attacks: [33 63]|
04/23/2025 07:33:24 - INFO - End of Episode.
|Episode 079/100| time: 2.21|
|Def Loss 0.1645 | Def Reward in ep 099|
|Att Loss 0.1864 | Att Reward in ep 001|
|Def Estimated: [41 59]| Att Labels: [42 58]|
|Def Amount of true predicted attacks: [41 58]|
04/23/2025 07:33:27 - INFO - End of Episode.
|Episode 080/100| time: 2.16|
|Def Loss 0.1534 | Def Reward in ep 098|
|Att Loss 0.1933 | Att Reward in ep 002|
|Def Estimated: [31 69]| Att Labels: [33 67]|
|Def Amount of true predicted attacks: [31 67]|
04/23/2025 07:33:29 - INFO - End of Episode.
|Episode 081/100| time: 2.17|
|Def Loss 0.1580 | Def Reward in ep 099|
|Att Loss 0.1624 | Att Reward in ep 001|
|Def Estimated: [35 65]| Att Labels: [34 66]|
|Def Amount of true predicted attacks: [34 65]|
04/23/2025 07:33:32 - INFO - End of Episode.
|Episode 082/100| time: 2.16|
|Def Loss 0.1731 | Def Reward in ep 098|
|Att Loss 0.1510 | Att Reward in ep 002|
|Def Estimated: [30 70]| Att Labels: [32 68]|
|Def Amount of true predicted attacks: [30 68]|
04/23/2025 07:33:35 - INFO - End of Episode.
|Episode 083/100| time: 2.22|
|Def Loss 0.1840 | Def Reward in ep 097|
|Att Loss 0.1657 | Att Reward in ep 003|
|Def Estimated: [33 67]| Att Labels: [34 66]|
|Def Amount of true predicted attacks: [32 65]|
04/23/2025 07:33:38 - INFO - End of Episode.
|Episode 084/100| time: 2.16|
|Def Loss 0.1994 | Def Reward in ep 099|
|Att Loss 0.1824 | Att Reward in ep 001|
|Def Estimated: [27 73]| Att Labels: [28 72]|
|Def Amount of true predicted attacks: [27 72]|
04/23/2025 07:33:40 - INFO - End of Episode.
|Episode 085/100| time: 2.09|
|Def Loss 0.1415 | Def Reward in ep 100|
|Att Loss 0.1267 | Att Reward in ep 000|
|Def Estimated: [24 76]| Att Labels: [24 76]|
|Def Amount of true predicted attacks: [24 76]|
04/23/2025 07:33:43 - INFO - End of Episode.
|Episode 086/100| time: 2.22|
|Def Loss 0.1047 | Def Reward in ep 099|
|Att Loss 0.1381 | Att Reward in ep 001|
|Def Estimated: [33 67]| Att Labels: [32 68]|
|Def Amount of true predicted attacks: [32 67]|
04/23/2025 07:33:46 - INFO - End of Episode.
|Episode 087/100| time: 2.18|
|Def Loss 0.1183 | Def Reward in ep 098|
|Att Loss 0.1165 | Att Reward in ep 002|
|Def Estimated: [39 61]| Att Labels: [37 63]|
|Def Amount of true predicted attacks: [37 61]|
04/23/2025 07:33:49 - INFO - End of Episode.
|Episode 088/100| time: 2.18|
|Def Loss 0.1068 | Def Reward in ep 099|
|Att Loss 0.1433 | Att Reward in ep 001|
|Def Estimated: [25 75]| Att Labels: [24 76]|
|Def Amount of true predicted attacks: [24 75]|
04/23/2025 07:33:51 - INFO - End of Episode.
|Episode 089/100| time: 2.15|
|Def Loss 0.0705 | Def Reward in ep 097|
|Att Loss 0.1082 | Att Reward in ep 003|
|Def Estimated: [28 72]| Att Labels: [29 71]|
|Def Amount of true predicted attacks: [27 70]|
04/23/2025 07:33:54 - INFO - End of Episode.
|Episode 090/100| time: 2.18|
|Def Loss 0.1037 | Def Reward in ep 098|
|Att Loss 0.1190 | Att Reward in ep 002|
|Def Estimated: [28 72]| Att Labels: [30 70]|
|Def Amount of true predicted attacks: [28 70]|
04/23/2025 07:33:57 - INFO - End of Episode.
|Episode 091/100| time: 2.10|
|Def Loss 0.0863 | Def Reward in ep 096|
|Att Loss 0.1255 | Att Reward in ep 004|
|Def Estimated: [25 75]| Att Labels: [23 77]|
|Def Amount of true predicted attacks: [22 74]|
04/23/2025 07:33:59 - INFO - End of Episode.
|Episode 092/100| time: 2.16|
|Def Loss 0.0770 | Def Reward in ep 099|
|Att Loss 0.1266 | Att Reward in ep 001|
|Def Estimated: [33 67]| Att Labels: [34 66]|
|Def Amount of true predicted attacks: [33 66]|
04/23/2025 07:34:02 - INFO - End of Episode.
|Episode 093/100| time: 2.13|
|Def Loss 0.0978 | Def Reward in ep 099|
|Att Loss 0.1413 | Att Reward in ep 001|
|Def Estimated: [25 75]| Att Labels: [26 74]|
|Def Amount of true predicted attacks: [25 74]|
04/23/2025 07:34:05 - INFO - End of Episode.
|Episode 094/100| time: 2.11|
|Def Loss 0.0793 | Def Reward in ep 099|
|Att Loss 0.1200 | Att Reward in ep 001|
|Def Estimated: [28 72]| Att Labels: [27 73]|
|Def Amount of true predicted attacks: [27 72]|
04/23/2025 07:34:08 - INFO - End of Episode.
|Episode 095/100| time: 2.12|
|Def Loss 0.0743 | Def Reward in ep 100|
|Att Loss 0.1495 | Att Reward in ep 000|
|Def Estimated: [28 72]| Att Labels: [28 72]|
|Def Amount of true predicted attacks: [28 72]|
04/23/2025 07:34:10 - INFO - End of Episode.
|Episode 096/100| time: 2.09|
|Def Loss 0.0589 | Def Reward in ep 099|
|Att Loss 0.1443 | Att Reward in ep 001|
|Def Estimated: [21 79]| Att Labels: [22 78]|
|Def Amount of true predicted attacks: [21 78]|
04/23/2025 07:34:13 - INFO - End of Episode.
|Episode 097/100| time: 2.15|
|Def Loss 0.0641 | Def Reward in ep 099|
|Att Loss 0.1201 | Att Reward in ep 001|
|Def Estimated: [34 66]| Att Labels: [35 65]|
|Def Amount of true predicted attacks: [34 65]|
04/23/2025 07:34:16 - INFO - End of Episode.
|Episode 098/100| time: 2.16|
|Def Loss 0.0849 | Def Reward in ep 100|
|Att Loss 0.0991 | Att Reward in ep 000|
|Def Estimated: [34 66]| Att Labels: [34 66]|
|Def Amount of true predicted attacks: [34 66]|
04/23/2025 07:34:18 - INFO - End of Episode.
|Episode 099/100| time: 2.17|
|Def Loss 0.0660 | Def Reward in ep 098|
|Att Loss 0.1068 | Att Reward in ep 002|
|Def Estimated: [35 65]| Att Labels: [35 65]|
|Def Amount of true predicted attacks: [34 64]|
04/23/2025 07:34:19 - INFO - Model 'attacker_model_cic_2017' saved in: /workspace/models/trained-models/2025-04-23-07-29-Linux-CIC-2017-18-WebAttack-1st-Run/attacker_model_cic.keras
04/23/2025 07:34:19 - INFO - Model summary:
Model: "attacker_model_cic_2017"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense (Dense)               (None, 100)               6800      
                                                                 
 dense_1 (Dense)             (None, 100)               10100     
                                                                 
 dense_2 (Dense)             (None, 100)               10100     
                                                                 
 dense_3 (Dense)             (None, 100)               10100     
                                                                 
 dense_4 (Dense)             (None, 100)               10100     
                                                                 
 dense_5 (Dense)             (None, 4)                 404       
                                                                 
=================================================================
Total params: 47604 (185.95 KB)
Trainable params: 47604 (185.95 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________

04/23/2025 07:34:19 - INFO - Model 'defender_model' saved in: /workspace/models/trained-models/2025-04-23-07-29-Linux-CIC-2017-18-WebAttack-1st-Run/defender_model.keras
04/23/2025 07:34:19 - INFO - Model summary:
Model: "defender_model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense_12 (Dense)            (None, 100)               6800      
                                                                 
 dense_13 (Dense)            (None, 100)               10100     
                                                                 
 dense_14 (Dense)            (None, 100)               10100     
                                                                 
 dense_15 (Dense)            (None, 2)                 202       
                                                                 
=================================================================
Total params: 27202 (106.26 KB)
Trainable params: 27202 (106.26 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________

04/23/2025 07:34:19 - INFO - Saved trained models.
04/23/2025 07:34:19 - INFO - Total runtime: 00:04:49
04/23/2025 07:34:19 - INFO - End of the script at: 2025-04-23 07:34:19.613795
04/23/2025 07:34:22 - INFO - Debug information saved to /workspace/models/trained-models/2025-04-23-07-29-Linux-CIC-2017-18-WebAttack-1st-Run/logs/debug_info.json
04/23/2025 07:34:22 - INFO - Trying to save summary plots under: /workspace/models/trained-models/2025-04-23-07-29-Linux-CIC-2017-18-WebAttack-1st-Run/plots/
04/23/2025 07:34:23 - INFO - Plotted attack distributions during training in: /workspace/models/trained-models/2025-04-23-07-29-Linux-CIC-2017-18-WebAttack-1st-Run/plots/
04/23/2025 07:34:27 - INFO - Normalized confusion matrix
04/23/2025 07:34:27 - INFO - 
Confusion Matrix:
[[0.98211429 0.01788571]
 [0.04774898 0.95225102]]
04/23/2025 07:34:28 - INFO - Plotted confusion matrix in: /workspace/models/trained-models/2025-04-23-07-29-Linux-CIC-2017-18-WebAttack-1st-Run/plots/intraset/
04/23/2025 07:34:28 - INFO - Model summary:
Model: "defender_model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense_12 (Dense)            (None, 100)               6800      
                                                                 
 dense_13 (Dense)            (None, 100)               10100     
                                                                 
 dense_14 (Dense)            (None, 100)               10100     
                                                                 
 dense_15 (Dense)            (None, 2)                 202       
                                                                 
=================================================================
Total params: 27202 (106.26 KB)
Trainable params: 27202 (106.26 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________

loaded from: /workspace/models/trained-models/2025-04-23-07-29-Linux-CIC-2017-18-WebAttack-1st-Run/defender_model.keras
04/23/2025 07:34:28 - INFO - One vs All metric calculation: 
True positive: 1396 | False positive: 2504 | 
True negative: 137496 | False negative: 70
Accuracy: 0.9818 | Recall: 0.9523 | Specificity: 0.9821 | Precision: 0.3579 | F1-Score: 0.5203 | False Positive Rate: 0.0179
04/23/2025 07:34:28 - INFO - Overall overview
Total reward: 138892 | Number of samples: 141466 | Accuracy = 98.18%
Overall overview per attack type
              Estimated Correct   Total Mismatch   F1_score
Benign           137566  137496  140000     2434  99.072653
Web Attack         3900    1396    1466     2434  52.031308
Weigthed Avg.                                     98.585168
04/23/2025 07:34:28 - INFO - 
     Class  Support  Accuracy  Precision  Recall  F1-Score
    Benign   140000    0.9821     0.9995  0.9821    0.9907
Web Attack     1466    0.9523     0.3579  0.9523    0.5203
04/23/2025 07:34:28 - INFO - Overall weighted F1-score: 0.9859
04/23/2025 07:34:32 - INFO - 
One vs All metrics: 
         name  accuracy        f1  precision    recall
0      Benign  0.981805  0.990727   0.999491  0.982114
1  Web Attack  0.981805  0.520313   0.357949  0.952251
04/23/2025 07:34:32 - INFO - Classification report:
              precision    recall  f1-score   support

      Benign       1.00      0.98      0.99    140000
  Web Attack       0.36      0.95      0.52      1466

    accuracy                           0.98    141466
   macro avg       0.68      0.97      0.76    141466
weighted avg       0.99      0.98      0.99    141466

04/23/2025 07:34:34 - INFO - Model metrics: 
loss=0.028584690764546394, mse=0.08035589009523392, mae=0.1086621955037117
04/23/2025 07:34:34 - INFO - Optimizer config: {'name': 'Adam', 'weight_decay': None, 'clipnorm': None, 'global_clipnorm': None, 'clipvalue': None, 'use_ema': False, 'ema_momentum': 0.99, 'ema_overwrite_frequency': None, 'jit_compile': False, 'is_legacy_optimizer': False, 'learning_rate': 0.001, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
04/23/2025 07:34:34 - INFO - Time needed for testing: 9.264267921447754
04/23/2025 07:34:34 - INFO - Metrics exported to: /workspace/models/trained-models/2025-04-23-07-29-Linux-CIC-2017-18-WebAttack-1st-Run/logs/evaluation_metrics_defender_model.json
04/23/2025 07:34:42 - INFO - [Intra-Set] Accuracy: 0.9133, Recall: 0.0103, Precision: 0.0002, F1: 0.0004
04/23/2025 07:34:42 - INFO - Normalized confusion matrix
04/23/2025 07:34:42 - INFO - 
Confusion Matrix:
[[0.91469882 0.08530118]
 [0.98969072 0.01030928]]
04/23/2025 07:34:42 - INFO - Plotted confusion matrix in: /workspace/models/trained-models/2025-04-23-07-29-Linux-CIC-2017-18-WebAttack-1st-Run/plots/interset/
04/23/2025 07:34:42 - INFO - [Intra-Set] Confusion matrix saved to /workspace/models/trained-models/2025-04-23-07-29-Linux-CIC-2017-18-WebAttack-1st-Run/plots/
04/23/2025 07:34:48 - INFO - [Cross-Set] Model metrics: loss=0.15787900984287262, mse=2436.48193359375, mae=0.33139821887016296
04/23/2025 07:34:48 - INFO - [Intra-Set] Evaluation completed. Metrics exported to: /workspace/models/trained-models/2025-04-23-07-29-Linux-CIC-2017-18-WebAttack-1st-Run/logs/evaluation_metrics_cross_defender_model.json
04/23/2025 07:34:48 - INFO - [Intra-Set] Time needed: 14.06 seconds
