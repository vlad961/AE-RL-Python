02/07/2025 11:32:39 - INFO - Started script at: 2025-02-07-11-32
02/07/2025 11:32:39 - INFO - Current working dir: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python
02/07/2025 11:32:39 - INFO - Used data files: 
E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\data/datasets/origin-kaggle-com/nsl-kdd/KDDTrain+.txt,
E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\data/datasets/origin-kaggle-com/nsl-kdd/KDDTest+.txt
02/07/2025 11:32:39 - INFO - Creating enviroment...
02/07/2025 11:32:41 - INFO - Initializing ReplayMemory with observation_size=122 and max_size=1000
02/07/2025 11:32:42 - DEBUG - Creating converter from 5 to 3
02/07/2025 11:32:42 - DEBUG - Creating converter from 3 to 5
02/07/2025 11:32:42 - INFO - Reading formated train data from: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\data/datasets/formated/formated_train_adv.csv
02/07/2025 11:32:43 - INFO - Initializing ReplayMemory with observation_size=122 and max_size=1000
02/07/2025 11:32:43 - INFO - Start Training with the following parameters:
-----------------------------------------------------------------------------------------------------------------------
Total epoch: 100 | Iterations in epoch: 100 | Minibatch from mem size: 100 | Total Samples: 10000 | Data shape: (125973, 162)
-----------------------------------------------------------------------------------------------------------------------
Attacker: Num_actions=23 | gamma=0.001 | epsilon=1 | ANN hidden size=100 | ANN hidden layers=1 | Learning rate=0.001
-----------------------------------------------------------------------------------------------------------------------
Defender: Num_actions=5 | gamma=0.001 | epsilon=1 | ANN hidden size=100 | ANN hidden layers=3 | Learning rate=0.001
-----------------------------------------------------------------------------------------------------------------------
Used Attack types: 'all: Normal, DoS, Probe, R2L, U2R' | Attack name(s): ['normal', 'back', 'land', 'neptune', 'pod', 'smurf', 'teardrop', 'ipsweep', 'nmap', 'portsweep', 'satan', 'ftp_write', 'guess_passwd', 'imap', 'multihop', 'phf', 'spy', 'warezclient', 'warezmaster', 'buffer_overflow', 'loadmodule', 'perl', 'rootkit']
-----------------------------------------------------------------------------------------------------------------------

02/07/2025 11:32:43 - INFO - End of Epoch.
|Epoch 000/100| time: 0.22|
|Def Loss 0.0000 | Def Reward in ep 024|
|Att Loss 0.0000 | Att Reward in ep 076|
|Def Estimated: [15 21 20 19 25]| Att Labels: [ 4 28 12 35 21]|
|Def Amount of true predicted attacks: [ 1 10  1  9  3]|
02/07/2025 11:32:45 - WARNING - 5 out of the last 5 calls to <function Model.make_predict_function.<locals>.predict_function at 0x000001DA5C5F0820> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
02/07/2025 11:32:45 - WARNING - 5 out of the last 11 calls to <function Model.make_predict_function.<locals>.predict_function at 0x000001DA5C5F0820> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
02/07/2025 11:33:01 - INFO - End of Epoch.
|Epoch 001/100| time: 17.19|
|Def Loss 0.6769 | Def Reward in ep 057|
|Att Loss 0.5260 | Att Reward in ep 043|
|Def Estimated: [ 6 23 22 33 16]| Att Labels: [ 2 22 26 34 16]|
|Def Amount of true predicted attacks: [ 0 14 14 22  7]|
02/07/2025 11:33:18 - INFO - End of Epoch.
|Epoch 002/100| time: 16.99|
|Def Loss 0.2885 | Def Reward in ep 080|
|Att Loss 0.3652 | Att Reward in ep 020|
|Def Estimated: [ 6 21 17 38 18]| Att Labels: [ 7 22 19 26 26]|
|Def Amount of true predicted attacks: [ 4 19 17 24 16]|
02/07/2025 11:33:35 - INFO - End of Epoch.
|Epoch 003/100| time: 17.17|
|Def Loss 0.2438 | Def Reward in ep 087|
|Att Loss 0.3523 | Att Reward in ep 013|
|Def Estimated: [ 6 24 23 33 14]| Att Labels: [ 9 24 25 29 13]|
|Def Amount of true predicted attacks: [ 5 23 22 27 10]|
02/07/2025 11:33:52 - INFO - End of Epoch.
|Epoch 004/100| time: 17.15|
|Def Loss 0.2449 | Def Reward in ep 088|
|Att Loss 0.3255 | Att Reward in ep 012|
|Def Estimated: [ 3 21 30 28 18]| Att Labels: [ 5 25 27 25 18]|
|Def Amount of true predicted attacks: [ 3 20 27 22 16]|
02/07/2025 11:34:09 - INFO - End of Epoch.
|Epoch 005/100| time: 17.16|
|Def Loss 0.1901 | Def Reward in ep 085|
|Att Loss 0.3055 | Att Reward in ep 015|
|Def Estimated: [ 6 27 25 25 17]| Att Labels: [10 23 23 24 20]|
|Def Amount of true predicted attacks: [ 5 22 21 20 17]|
02/07/2025 11:34:26 - INFO - End of Epoch.
|Epoch 006/100| time: 16.73|
|Def Loss 0.1601 | Def Reward in ep 096|
|Att Loss 0.2801 | Att Reward in ep 004|
|Def Estimated: [ 2 21 27 35 15]| Att Labels: [ 2 19 28 35 16]|
|Def Amount of true predicted attacks: [ 2 19 27 34 14]|
02/07/2025 11:34:43 - INFO - End of Epoch.
|Epoch 007/100| time: 17.13|
|Def Loss 0.1511 | Def Reward in ep 090|
|Att Loss 0.2555 | Att Reward in ep 010|
|Def Estimated: [ 8 29 17 29 17]| Att Labels: [12 26 17 28 17]|
|Def Amount of true predicted attacks: [ 7 26 16 26 15]|
02/07/2025 11:35:00 - INFO - End of Epoch.
|Epoch 008/100| time: 17.10|
|Def Loss 0.1641 | Def Reward in ep 089|
|Att Loss 0.2449 | Att Reward in ep 011|
|Def Estimated: [ 8 29 14 30 19]| Att Labels: [12 28 13 29 18]|
|Def Amount of true predicted attacks: [ 7 28 13 26 15]|
02/07/2025 11:35:17 - INFO - End of Epoch.
|Epoch 009/100| time: 17.06|
|Def Loss 0.1461 | Def Reward in ep 088|
|Att Loss 0.2320 | Att Reward in ep 012|
|Def Estimated: [ 6 28 23 27 16]| Att Labels: [12 26 19 26 17]|
|Def Amount of true predicted attacks: [ 4 25 19 24 16]|
02/07/2025 11:35:33 - INFO - End of Epoch.
|Epoch 010/100| time: 16.36|
|Def Loss 0.1528 | Def Reward in ep 093|
|Att Loss 0.1783 | Att Reward in ep 007|
|Def Estimated: [ 1 23 23 34 19]| Att Labels: [ 3 22 23 33 19]|
|Def Amount of true predicted attacks: [ 1 22 23 31 16]|
02/07/2025 11:35:50 - INFO - End of Epoch.
|Epoch 011/100| time: 16.68|
|Def Loss 0.1275 | Def Reward in ep 089|
|Att Loss 0.0920 | Att Reward in ep 011|
|Def Estimated: [ 5 27 22 30 16]| Att Labels: [10 25 20 36  9]|
|Def Amount of true predicted attacks: [ 5 25 20 30  9]|
02/07/2025 11:36:07 - INFO - End of Epoch.
|Epoch 012/100| time: 17.16|
|Def Loss 0.1490 | Def Reward in ep 092|
|Att Loss 0.0587 | Att Reward in ep 008|
|Def Estimated: [17 27 11 27 18]| Att Labels: [18 27 11 31 13]|
|Def Amount of true predicted attacks: [15 27 11 26 13]|
02/07/2025 11:36:24 - INFO - End of Epoch.
|Epoch 013/100| time: 16.59|
|Def Loss 0.1409 | Def Reward in ep 088|
|Att Loss 0.0486 | Att Reward in ep 012|
|Def Estimated: [13 20 17 35 15]| Att Labels: [16 18 17 37 12]|
|Def Amount of true predicted attacks: [11 16 17 32 12]|
02/07/2025 11:36:41 - INFO - End of Epoch.
|Epoch 014/100| time: 16.68|
|Def Loss 0.1145 | Def Reward in ep 094|
|Att Loss 0.0538 | Att Reward in ep 006|
|Def Estimated: [15 30 13 23 19]| Att Labels: [13 31 13 25 18]|
|Def Amount of true predicted attacks: [13 30 12 22 17]|
02/07/2025 11:36:57 - INFO - End of Epoch.
|Epoch 015/100| time: 16.64|
|Def Loss 0.1134 | Def Reward in ep 093|
|Att Loss 0.0524 | Att Reward in ep 007|
|Def Estimated: [ 9 31 19 27 14]| Att Labels: [11 32 16 29 12]|
|Def Amount of true predicted attacks: [ 9 30 16 26 12]|
02/07/2025 11:37:14 - INFO - End of Epoch.
|Epoch 016/100| time: 16.58|
|Def Loss 0.1132 | Def Reward in ep 093|
|Att Loss 0.0538 | Att Reward in ep 007|
|Def Estimated: [11 27 17 23 22]| Att Labels: [14 27 15 24 20]|
|Def Amount of true predicted attacks: [11 26 15 22 19]|
02/07/2025 11:37:31 - INFO - End of Epoch.
|Epoch 017/100| time: 17.06|
|Def Loss 0.0952 | Def Reward in ep 097|
|Att Loss 0.0526 | Att Reward in ep 003|
|Def Estimated: [14 27 19 24 16]| Att Labels: [16 24 20 24 16]|
|Def Amount of true predicted attacks: [14 24 19 24 16]|
02/07/2025 11:37:48 - INFO - End of Epoch.
|Epoch 018/100| time: 16.73|
|Def Loss 0.0695 | Def Reward in ep 098|
|Att Loss 0.0517 | Att Reward in ep 002|
|Def Estimated: [12 23 19 36 10]| Att Labels: [14 23 18 35 10]|
|Def Amount of true predicted attacks: [12 23 18 35 10]|
02/07/2025 11:38:04 - INFO - End of Epoch.
|Epoch 019/100| time: 16.75|
|Def Loss 0.0794 | Def Reward in ep 097|
|Att Loss 0.0517 | Att Reward in ep 003|
|Def Estimated: [11 20 21 30 18]| Att Labels: [11 19 22 29 19]|
|Def Amount of true predicted attacks: [11 19 21 28 18]|
02/07/2025 11:38:21 - INFO - End of Epoch.
|Epoch 020/100| time: 16.74|
|Def Loss 0.0521 | Def Reward in ep 092|
|Att Loss 0.0536 | Att Reward in ep 008|
|Def Estimated: [12 30 20 19 19]| Att Labels: [17 29 19 18 17]|
|Def Amount of true predicted attacks: [11 28 19 17 17]|
02/07/2025 11:38:38 - INFO - End of Epoch.
|Epoch 021/100| time: 16.86|
|Def Loss 0.0591 | Def Reward in ep 097|
|Att Loss 0.0471 | Att Reward in ep 003|
|Def Estimated: [17 19 17 35 12]| Att Labels: [16 19 17 38 10]|
|Def Amount of true predicted attacks: [16 19 17 35 10]|
02/07/2025 11:38:55 - INFO - End of Epoch.
|Epoch 022/100| time: 16.98|
|Def Loss 0.0410 | Def Reward in ep 099|
|Att Loss 0.0499 | Att Reward in ep 001|
|Def Estimated: [11 14 24 31 20]| Att Labels: [11 14 24 30 21]|
|Def Amount of true predicted attacks: [11 14 24 30 20]|
02/07/2025 11:39:12 - INFO - End of Epoch.
|Epoch 023/100| time: 16.76|
|Def Loss 0.0397 | Def Reward in ep 096|
|Att Loss 0.0471 | Att Reward in ep 004|
|Def Estimated: [ 8 19 21 35 17]| Att Labels: [ 8 20 21 34 17]|
|Def Amount of true predicted attacks: [ 7 19 21 33 16]|
02/07/2025 11:39:29 - INFO - End of Epoch.
|Epoch 024/100| time: 16.93|
|Def Loss 0.0657 | Def Reward in ep 094|
|Att Loss 0.0347 | Att Reward in ep 006|
|Def Estimated: [19 13 19 30 19]| Att Labels: [17 13 20 32 18]|
|Def Amount of true predicted attacks: [16 13 19 29 17]|
02/07/2025 11:39:45 - INFO - End of Epoch.
|Epoch 025/100| time: 16.67|
|Def Loss 0.0665 | Def Reward in ep 097|
|Att Loss 0.0354 | Att Reward in ep 003|
|Def Estimated: [ 9 20 21 34 16]| Att Labels: [ 8 20 22 36 14]|
|Def Amount of true predicted attacks: [ 8 20 21 34 14]|
02/07/2025 11:40:02 - INFO - End of Epoch.
|Epoch 026/100| time: 16.54|
|Def Loss 0.0844 | Def Reward in ep 098|
|Att Loss 0.0278 | Att Reward in ep 002|
|Def Estimated: [11 22 18 37 12]| Att Labels: [11 22 18 37 12]|
|Def Amount of true predicted attacks: [10 21 18 37 12]|
02/07/2025 11:40:19 - INFO - End of Epoch.
|Epoch 027/100| time: 16.72|
|Def Loss 0.0807 | Def Reward in ep 096|
|Att Loss 0.0248 | Att Reward in ep 004|
|Def Estimated: [ 9 28 19 22 22]| Att Labels: [ 8 28 19 23 22]|
|Def Amount of true predicted attacks: [ 8 28 18 21 21]|
02/07/2025 11:40:35 - INFO - End of Epoch.
|Epoch 028/100| time: 16.63|
|Def Loss 0.0786 | Def Reward in ep 098|
|Att Loss 0.0302 | Att Reward in ep 002|
|Def Estimated: [ 9 25 16 33 17]| Att Labels: [ 9 25 16 35 15]|
|Def Amount of true predicted attacks: [ 9 25 16 33 15]|
02/07/2025 11:40:52 - INFO - End of Epoch.
|Epoch 029/100| time: 16.98|
|Def Loss 0.0720 | Def Reward in ep 093|
|Att Loss 0.0271 | Att Reward in ep 007|
|Def Estimated: [10 17 22 32 19]| Att Labels: [12 16 23 32 17]|
|Def Amount of true predicted attacks: [ 9 15 21 31 17]|
02/07/2025 11:41:09 - INFO - End of Epoch.
|Epoch 030/100| time: 16.71|
|Def Loss 0.0846 | Def Reward in ep 091|
|Att Loss 0.0301 | Att Reward in ep 009|
|Def Estimated: [ 7 27 14 28 24]| Att Labels: [ 8 25 14 29 24]|
|Def Amount of true predicted attacks: [ 6 25 13 26 21]|
02/07/2025 11:41:26 - INFO - End of Epoch.
|Epoch 031/100| time: 16.91|
|Def Loss 0.0629 | Def Reward in ep 095|
|Att Loss 0.0224 | Att Reward in ep 005|
|Def Estimated: [ 9 19 15 36 21]| Att Labels: [11 20 15 36 18]|
|Def Amount of true predicted attacks: [ 8 19 15 35 18]|
02/07/2025 11:41:43 - INFO - End of Epoch.
|Epoch 032/100| time: 16.99|
|Def Loss 0.0749 | Def Reward in ep 096|
|Att Loss 0.0301 | Att Reward in ep 004|
|Def Estimated: [ 8 28 24 26 14]| Att Labels: [ 7 27 26 27 13]|
|Def Amount of true predicted attacks: [ 6 27 24 26 13]|
02/07/2025 11:42:00 - INFO - End of Epoch.
|Epoch 033/100| time: 16.80|
|Def Loss 0.0745 | Def Reward in ep 097|
|Att Loss 0.0252 | Att Reward in ep 003|
|Def Estimated: [10 19 23 34 14]| Att Labels: [10 19 23 34 14]|
|Def Amount of true predicted attacks: [ 9 19 22 33 14]|
02/07/2025 11:42:17 - INFO - End of Epoch.
|Epoch 034/100| time: 16.97|
|Def Loss 0.0663 | Def Reward in ep 099|
|Att Loss 0.0241 | Att Reward in ep 001|
|Def Estimated: [11 15 20 34 20]| Att Labels: [11 14 21 34 20]|
|Def Amount of true predicted attacks: [11 14 20 34 20]|
02/07/2025 11:42:33 - INFO - End of Epoch.
|Epoch 035/100| time: 16.89|
|Def Loss 0.0480 | Def Reward in ep 092|
|Att Loss 0.0247 | Att Reward in ep 008|
|Def Estimated: [ 7 19 18 35 21]| Att Labels: [ 6 17 20 34 23]|
|Def Amount of true predicted attacks: [ 4 17 18 32 21]|
02/07/2025 11:42:50 - INFO - End of Epoch.
|Epoch 036/100| time: 16.81|
|Def Loss 0.0598 | Def Reward in ep 100|
|Att Loss 0.0156 | Att Reward in ep 000|
|Def Estimated: [ 6 24 22 33 15]| Att Labels: [ 6 24 22 33 15]|
|Def Amount of true predicted attacks: [ 6 24 22 33 15]|
02/07/2025 11:43:07 - INFO - End of Epoch.
|Epoch 037/100| time: 16.99|
|Def Loss 0.0630 | Def Reward in ep 096|
|Att Loss 0.0224 | Att Reward in ep 004|
|Def Estimated: [10 27 20 24 19]| Att Labels: [10 27 19 25 19]|
|Def Amount of true predicted attacks: [ 9 27 19 23 18]|
02/07/2025 11:43:24 - INFO - End of Epoch.
|Epoch 038/100| time: 17.13|
|Def Loss 0.0683 | Def Reward in ep 094|
|Att Loss 0.0174 | Att Reward in ep 006|
|Def Estimated: [14 21 21 30 14]| Att Labels: [15 22 18 28 17]|
|Def Amount of true predicted attacks: [14 21 18 27 14]|
02/07/2025 11:43:41 - INFO - End of Epoch.
|Epoch 039/100| time: 16.96|
|Def Loss 0.0902 | Def Reward in ep 093|
|Att Loss 0.0165 | Att Reward in ep 007|
|Def Estimated: [ 8 25 25 25 17]| Att Labels: [12 24 24 23 17]|
|Def Amount of true predicted attacks: [ 8 22 24 23 16]|
02/07/2025 11:43:58 - INFO - End of Epoch.
|Epoch 040/100| time: 16.91|
|Def Loss 0.0679 | Def Reward in ep 096|
|Att Loss 0.0151 | Att Reward in ep 004|
|Def Estimated: [10 22 25 22 21]| Att Labels: [11 22 23 22 22]|
|Def Amount of true predicted attacks: [10 22 23 21 20]|
02/07/2025 11:44:15 - INFO - End of Epoch.
|Epoch 041/100| time: 16.80|
|Def Loss 0.0769 | Def Reward in ep 098|
|Att Loss 0.0194 | Att Reward in ep 002|
|Def Estimated: [10 21 18 33 18]| Att Labels: [ 9 22 18 33 18]|
|Def Amount of true predicted attacks: [ 9 21 18 33 17]|
02/07/2025 11:44:32 - INFO - End of Epoch.
|Epoch 042/100| time: 17.17|
|Def Loss 0.0726 | Def Reward in ep 094|
|Att Loss 0.0155 | Att Reward in ep 006|
|Def Estimated: [ 8 24 14 31 23]| Att Labels: [ 9 24 14 29 24]|
|Def Amount of true predicted attacks: [ 7 24 13 28 22]|
02/07/2025 11:44:49 - INFO - End of Epoch.
|Epoch 043/100| time: 16.88|
|Def Loss 0.0917 | Def Reward in ep 099|
|Att Loss 0.0198 | Att Reward in ep 001|
|Def Estimated: [ 7 25 18 33 17]| Att Labels: [ 8 25 18 32 17]|
|Def Amount of true predicted attacks: [ 7 25 18 32 17]|
02/07/2025 11:45:06 - INFO - End of Epoch.
|Epoch 044/100| time: 16.86|
|Def Loss 0.0799 | Def Reward in ep 097|
|Att Loss 0.0155 | Att Reward in ep 003|
|Def Estimated: [ 9 28 11 38 14]| Att Labels: [10 28 12 35 15]|
|Def Amount of true predicted attacks: [ 9 28 11 35 14]|
02/07/2025 11:45:23 - INFO - End of Epoch.
|Epoch 045/100| time: 16.79|
|Def Loss 0.0729 | Def Reward in ep 097|
|Att Loss 0.0186 | Att Reward in ep 003|
|Def Estimated: [10 27 17 33 13]| Att Labels: [10 27 17 34 12]|
|Def Amount of true predicted attacks: [10 27 16 32 12]|
02/07/2025 11:45:40 - INFO - End of Epoch.
|Epoch 046/100| time: 17.01|
|Def Loss 0.0655 | Def Reward in ep 099|
|Att Loss 0.0163 | Att Reward in ep 001|
|Def Estimated: [13 22 13 39 13]| Att Labels: [13 23 13 39 12]|
|Def Amount of true predicted attacks: [13 22 13 39 12]|
02/07/2025 11:45:57 - INFO - End of Epoch.
|Epoch 047/100| time: 16.88|
|Def Loss 0.0536 | Def Reward in ep 095|
|Att Loss 0.0184 | Att Reward in ep 005|
|Def Estimated: [11 30 11 33 15]| Att Labels: [11 29 12 33 15]|
|Def Amount of true predicted attacks: [11 28 11 32 13]|
02/07/2025 11:46:13 - INFO - End of Epoch.
|Epoch 048/100| time: 16.68|
|Def Loss 0.0409 | Def Reward in ep 097|
|Att Loss 0.0223 | Att Reward in ep 003|
|Def Estimated: [10 25 19 28 18]| Att Labels: [ 9 26 19 28 18]|
|Def Amount of true predicted attacks: [ 8 25 19 27 18]|
02/07/2025 11:46:30 - INFO - End of Epoch.
|Epoch 049/100| time: 16.88|
|Def Loss 0.0366 | Def Reward in ep 096|
|Att Loss 0.0273 | Att Reward in ep 004|
|Def Estimated: [12 17 18 37 16]| Att Labels: [11 18 17 36 18]|
|Def Amount of true predicted attacks: [11 17 17 35 16]|
02/07/2025 11:46:47 - INFO - End of Epoch.
|Epoch 050/100| time: 16.70|
|Def Loss 0.0306 | Def Reward in ep 098|
|Att Loss 0.0225 | Att Reward in ep 002|
|Def Estimated: [ 9 25 14 36 16]| Att Labels: [ 9 25 14 34 18]|
|Def Amount of true predicted attacks: [ 9 25 14 34 16]|
02/07/2025 11:47:04 - INFO - End of Epoch.
|Epoch 051/100| time: 16.70|
|Def Loss 0.0278 | Def Reward in ep 097|
|Att Loss 0.0239 | Att Reward in ep 003|
|Def Estimated: [ 8 22 18 33 19]| Att Labels: [ 9 22 17 32 20]|
|Def Amount of true predicted attacks: [ 8 22 17 31 19]|
02/07/2025 11:47:20 - INFO - End of Epoch.
|Epoch 052/100| time: 16.68|
|Def Loss 0.0258 | Def Reward in ep 096|
|Att Loss 0.0245 | Att Reward in ep 004|
|Def Estimated: [ 8 22 18 34 18]| Att Labels: [ 9 21 18 33 19]|
|Def Amount of true predicted attacks: [ 7 21 18 32 18]|
02/07/2025 11:47:37 - INFO - End of Epoch.
|Epoch 053/100| time: 16.83|
|Def Loss 0.0159 | Def Reward in ep 097|
|Att Loss 0.0236 | Att Reward in ep 003|
|Def Estimated: [ 8 12 17 40 23]| Att Labels: [ 7 12 18 38 25]|
|Def Amount of true predicted attacks: [ 7 12 17 38 23]|
02/07/2025 11:47:54 - INFO - End of Epoch.
|Epoch 054/100| time: 16.71|
|Def Loss 0.0177 | Def Reward in ep 098|
|Att Loss 0.0256 | Att Reward in ep 002|
|Def Estimated: [ 5 21 18 37 19]| Att Labels: [ 7 20 18 36 19]|
|Def Amount of true predicted attacks: [ 5 20 18 36 19]|
02/07/2025 11:48:11 - INFO - End of Epoch.
|Epoch 055/100| time: 17.42|
|Def Loss 0.0204 | Def Reward in ep 094|
|Att Loss 0.0321 | Att Reward in ep 006|
|Def Estimated: [11 18 23 28 20]| Att Labels: [12 17 22 31 18]|
|Def Amount of true predicted attacks: [10 16 22 28 18]|
02/07/2025 11:48:28 - INFO - End of Epoch.
|Epoch 056/100| time: 16.89|
|Def Loss 0.0280 | Def Reward in ep 096|
|Att Loss 0.0311 | Att Reward in ep 004|
|Def Estimated: [10 24 16 30 20]| Att Labels: [ 9 24 19 31 17]|
|Def Amount of true predicted attacks: [ 9 24 16 30 17]|
02/07/2025 11:48:45 - INFO - End of Epoch.
|Epoch 057/100| time: 16.87|
|Def Loss 0.0170 | Def Reward in ep 097|
|Att Loss 0.0271 | Att Reward in ep 003|
|Def Estimated: [11 28 19 25 17]| Att Labels: [10 29 20 26 15]|
|Def Amount of true predicted attacks: [10 28 19 25 15]|
02/07/2025 11:49:02 - INFO - End of Epoch.
|Epoch 058/100| time: 16.72|
|Def Loss 0.0208 | Def Reward in ep 095|
|Att Loss 0.0255 | Att Reward in ep 005|
|Def Estimated: [12 16 20 32 20]| Att Labels: [12 16 19 34 19]|
|Def Amount of true predicted attacks: [11 16 18 32 18]|
02/07/2025 11:49:19 - INFO - End of Epoch.
|Epoch 059/100| time: 16.89|
|Def Loss 0.0407 | Def Reward in ep 098|
|Att Loss 0.0249 | Att Reward in ep 002|
|Def Estimated: [10 24 23 24 19]| Att Labels: [10 25 22 25 18]|
|Def Amount of true predicted attacks: [10 24 22 24 18]|
02/07/2025 11:49:35 - INFO - End of Epoch.
|Epoch 060/100| time: 16.88|
|Def Loss 0.0373 | Def Reward in ep 097|
|Att Loss 0.0234 | Att Reward in ep 003|
|Def Estimated: [10 28 15 35 12]| Att Labels: [11 28 15 36 10]|
|Def Amount of true predicted attacks: [10 28 15 34 10]|
02/07/2025 11:49:52 - INFO - End of Epoch.
|Epoch 061/100| time: 16.89|
|Def Loss 0.0554 | Def Reward in ep 094|
|Att Loss 0.0249 | Att Reward in ep 006|
|Def Estimated: [10 18 23 37 12]| Att Labels: [10 19 21 41  9]|
|Def Amount of true predicted attacks: [ 9 18 21 37  9]|
02/07/2025 11:50:09 - INFO - End of Epoch.
|Epoch 062/100| time: 16.81|
|Def Loss 0.0568 | Def Reward in ep 094|
|Att Loss 0.0280 | Att Reward in ep 006|
|Def Estimated: [ 8 25 15 35 17]| Att Labels: [ 6 23 16 39 16]|
|Def Amount of true predicted attacks: [ 5 23 15 35 16]|
02/07/2025 11:50:26 - INFO - End of Epoch.
|Epoch 063/100| time: 16.80|
|Def Loss 0.0618 | Def Reward in ep 097|
|Att Loss 0.0287 | Att Reward in ep 003|
|Def Estimated: [ 9 29 17 30 15]| Att Labels: [ 9 29 18 30 14]|
|Def Amount of true predicted attacks: [ 8 29 17 29 14]|
02/07/2025 11:50:43 - INFO - End of Epoch.
|Epoch 064/100| time: 16.96|
|Def Loss 0.0525 | Def Reward in ep 098|
|Att Loss 0.0274 | Att Reward in ep 002|
|Def Estimated: [ 8 19 13 46 14]| Att Labels: [ 7 19 13 48 13]|
|Def Amount of true predicted attacks: [ 7 19 13 46 13]|
02/07/2025 11:51:00 - INFO - End of Epoch.
|Epoch 065/100| time: 16.73|
|Def Loss 0.0449 | Def Reward in ep 098|
|Att Loss 0.0215 | Att Reward in ep 002|
|Def Estimated: [ 8 20 22 33 17]| Att Labels: [ 8 19 22 34 17]|
|Def Amount of true predicted attacks: [ 8 19 22 33 16]|
02/07/2025 11:51:17 - INFO - End of Epoch.
|Epoch 066/100| time: 17.18|
|Def Loss 0.0559 | Def Reward in ep 097|
|Att Loss 0.0246 | Att Reward in ep 003|
|Def Estimated: [10 24 16 32 18]| Att Labels: [11 24 16 32 17]|
|Def Amount of true predicted attacks: [ 9 23 16 32 17]|
02/07/2025 11:51:34 - INFO - End of Epoch.
|Epoch 067/100| time: 17.09|
|Def Loss 0.0686 | Def Reward in ep 097|
|Att Loss 0.0315 | Att Reward in ep 003|
|Def Estimated: [10 28 13 37 12]| Att Labels: [11 28 12 35 14]|
|Def Amount of true predicted attacks: [10 28 12 35 12]|
02/07/2025 11:51:51 - INFO - End of Epoch.
|Epoch 068/100| time: 17.11|
|Def Loss 0.0601 | Def Reward in ep 098|
|Att Loss 0.0268 | Att Reward in ep 002|
|Def Estimated: [11 19 24 31 15]| Att Labels: [11 18 25 32 14]|
|Def Amount of true predicted attacks: [11 18 24 31 14]|
02/07/2025 11:52:08 - INFO - End of Epoch.
|Epoch 069/100| time: 16.91|
|Def Loss 0.0630 | Def Reward in ep 095|
|Att Loss 0.0257 | Att Reward in ep 005|
|Def Estimated: [ 6 26 19 37 12]| Att Labels: [ 7 26 18 36 13]|
|Def Amount of true predicted attacks: [ 6 26 18 34 11]|
02/07/2025 11:52:25 - INFO - End of Epoch.
|Epoch 070/100| time: 16.89|
|Def Loss 0.0693 | Def Reward in ep 097|
|Att Loss 0.0240 | Att Reward in ep 003|
|Def Estimated: [11 28 15 34 12]| Att Labels: [10 29 15 32 14]|
|Def Amount of true predicted attacks: [10 28 15 32 12]|
02/07/2025 11:52:42 - INFO - End of Epoch.
|Epoch 071/100| time: 17.54|
|Def Loss 0.0505 | Def Reward in ep 098|
|Att Loss 0.0264 | Att Reward in ep 002|
|Def Estimated: [10 24 12 38 16]| Att Labels: [11 24 12 38 15]|
|Def Amount of true predicted attacks: [10 24 12 37 15]|
02/07/2025 11:53:00 - INFO - End of Epoch.
|Epoch 072/100| time: 17.19|
|Def Loss 0.0585 | Def Reward in ep 097|
|Att Loss 0.0252 | Att Reward in ep 003|
|Def Estimated: [13 23 19 31 14]| Att Labels: [14 24 18 31 13]|
|Def Amount of true predicted attacks: [13 23 18 30 13]|
02/07/2025 11:53:17 - INFO - End of Epoch.
|Epoch 073/100| time: 17.18|
|Def Loss 0.0638 | Def Reward in ep 094|
|Att Loss 0.0240 | Att Reward in ep 006|
|Def Estimated: [13 21 18 27 21]| Att Labels: [14 20 18 29 19]|
|Def Amount of true predicted attacks: [12 19 17 27 19]|
02/07/2025 11:53:34 - INFO - End of Epoch.
|Epoch 074/100| time: 16.92|
|Def Loss 0.0452 | Def Reward in ep 097|
|Att Loss 0.0245 | Att Reward in ep 003|
|Def Estimated: [ 9 24 20 32 15]| Att Labels: [10 23 20 32 15]|
|Def Amount of true predicted attacks: [ 8 23 20 32 14]|
02/07/2025 11:53:51 - INFO - End of Epoch.
|Epoch 075/100| time: 17.00|
|Def Loss 0.0420 | Def Reward in ep 098|
|Att Loss 0.0320 | Att Reward in ep 002|
|Def Estimated: [15 26 14 34 11]| Att Labels: [14 26 14 35 11]|
|Def Amount of true predicted attacks: [14 26 14 34 10]|
02/07/2025 11:54:08 - INFO - End of Epoch.
|Epoch 076/100| time: 17.05|
|Def Loss 0.0539 | Def Reward in ep 094|
|Att Loss 0.0313 | Att Reward in ep 006|
|Def Estimated: [ 7 29 11 34 19]| Att Labels: [ 7 27 11 36 19]|
|Def Amount of true predicted attacks: [ 6 27 11 33 17]|
02/07/2025 11:54:25 - INFO - End of Epoch.
|Epoch 077/100| time: 17.63|
|Def Loss 0.0438 | Def Reward in ep 094|
|Att Loss 0.0318 | Att Reward in ep 006|
|Def Estimated: [10 17 19 42 12]| Att Labels: [12 16 19 42 11]|
|Def Amount of true predicted attacks: [ 9 16 18 41 10]|
02/07/2025 11:54:43 - INFO - End of Epoch.
|Epoch 078/100| time: 17.21|
|Def Loss 0.0557 | Def Reward in ep 097|
|Att Loss 0.0346 | Att Reward in ep 003|
|Def Estimated: [16 25 12 31 16]| Att Labels: [14 26 12 33 15]|
|Def Amount of true predicted attacks: [14 25 12 31 15]|
02/07/2025 11:55:00 - INFO - End of Epoch.
|Epoch 079/100| time: 17.05|
|Def Loss 0.0466 | Def Reward in ep 098|
|Att Loss 0.0290 | Att Reward in ep 002|
|Def Estimated: [ 9 24 14 36 17]| Att Labels: [11 23 14 36 16]|
|Def Amount of true predicted attacks: [ 9 23 14 36 16]|
02/07/2025 11:55:17 - INFO - End of Epoch.
|Epoch 080/100| time: 17.20|
|Def Loss 0.0445 | Def Reward in ep 098|
|Att Loss 0.0286 | Att Reward in ep 002|
|Def Estimated: [12 29 15 27 17]| Att Labels: [12 30 14 28 16]|
|Def Amount of true predicted attacks: [12 29 14 27 16]|
02/07/2025 11:55:34 - INFO - End of Epoch.
|Epoch 081/100| time: 17.08|
|Def Loss 0.0452 | Def Reward in ep 098|
|Att Loss 0.0302 | Att Reward in ep 002|
|Def Estimated: [10 29 13 32 16]| Att Labels: [10 28 13 32 17]|
|Def Amount of true predicted attacks: [10 28 13 31 16]|
02/07/2025 11:55:51 - INFO - End of Epoch.
|Epoch 082/100| time: 17.39|
|Def Loss 0.0551 | Def Reward in ep 097|
|Att Loss 0.0273 | Att Reward in ep 003|
|Def Estimated: [13 25 16 24 22]| Att Labels: [13 25 16 25 21]|
|Def Amount of true predicted attacks: [13 25 16 23 20]|
02/07/2025 11:56:09 - INFO - End of Epoch.
|Epoch 083/100| time: 17.32|
|Def Loss 0.0560 | Def Reward in ep 096|
|Att Loss 0.0278 | Att Reward in ep 004|
|Def Estimated: [16 22 14 32 16]| Att Labels: [17 23 14 31 15]|
|Def Amount of true predicted attacks: [15 22 14 30 15]|
02/07/2025 11:56:26 - INFO - End of Epoch.
|Epoch 084/100| time: 17.45|
|Def Loss 0.0603 | Def Reward in ep 098|
|Att Loss 0.0266 | Att Reward in ep 002|
|Def Estimated: [16 17 11 41 15]| Att Labels: [16 18 11 41 14]|
|Def Amount of true predicted attacks: [16 17 11 40 14]|
02/07/2025 11:56:44 - INFO - End of Epoch.
|Epoch 085/100| time: 17.55|
|Def Loss 0.0503 | Def Reward in ep 098|
|Att Loss 0.0196 | Att Reward in ep 002|
|Def Estimated: [14 16 24 28 18]| Att Labels: [14 16 25 29 16]|
|Def Amount of true predicted attacks: [14 16 24 28 16]|
02/07/2025 11:57:01 - INFO - End of Epoch.
|Epoch 086/100| time: 17.53|
|Def Loss 0.0446 | Def Reward in ep 100|
|Att Loss 0.0156 | Att Reward in ep 000|
|Def Estimated: [12 22 18 31 17]| Att Labels: [12 22 18 31 17]|
|Def Amount of true predicted attacks: [12 22 18 31 17]|
02/07/2025 11:57:19 - INFO - End of Epoch.
|Epoch 087/100| time: 17.87|
|Def Loss 0.0469 | Def Reward in ep 099|
|Att Loss 0.0179 | Att Reward in ep 001|
|Def Estimated: [17 19 18 32 14]| Att Labels: [16 19 18 33 14]|
|Def Amount of true predicted attacks: [16 19 18 32 14]|
02/07/2025 11:57:36 - INFO - End of Epoch.
|Epoch 088/100| time: 17.22|
|Def Loss 0.0526 | Def Reward in ep 096|
|Att Loss 0.0119 | Att Reward in ep 004|
|Def Estimated: [10 34 15 29 12]| Att Labels: [ 9 33 16 31 11]|
|Def Amount of true predicted attacks: [ 8 33 15 29 11]|
02/07/2025 11:57:54 - INFO - End of Epoch.
|Epoch 089/100| time: 17.38|
|Def Loss 0.0459 | Def Reward in ep 095|
|Att Loss 0.0191 | Att Reward in ep 005|
|Def Estimated: [12 18 22 35 13]| Att Labels: [12 18 21 37 12]|
|Def Amount of true predicted attacks: [10 18 21 34 12]|
02/07/2025 11:58:11 - INFO - End of Epoch.
|Epoch 090/100| time: 17.31|
|Def Loss 0.0458 | Def Reward in ep 092|
|Att Loss 0.0277 | Att Reward in ep 008|
|Def Estimated: [ 8 25 16 34 17]| Att Labels: [ 5 27 17 38 13]|
|Def Amount of true predicted attacks: [ 5 25 16 33 13]|
02/07/2025 11:58:28 - INFO - End of Epoch.
|Epoch 091/100| time: 17.35|
|Def Loss 0.0602 | Def Reward in ep 097|
|Att Loss 0.0274 | Att Reward in ep 003|
|Def Estimated: [10 15 27 28 20]| Att Labels: [10 14 27 29 20]|
|Def Amount of true predicted attacks: [ 9 14 27 28 19]|
02/07/2025 11:58:46 - INFO - End of Epoch.
|Epoch 092/100| time: 17.26|
|Def Loss 0.0386 | Def Reward in ep 098|
|Att Loss 0.0291 | Att Reward in ep 002|
|Def Estimated: [12 18 22 28 20]| Att Labels: [11 17 23 29 20]|
|Def Amount of true predicted attacks: [11 17 22 28 20]|
02/07/2025 11:59:03 - INFO - End of Epoch.
|Epoch 093/100| time: 17.39|
|Def Loss 0.0325 | Def Reward in ep 099|
|Att Loss 0.0230 | Att Reward in ep 001|
|Def Estimated: [ 5 24 16 40 15]| Att Labels: [ 4 24 16 41 15]|
|Def Amount of true predicted attacks: [ 4 24 16 40 15]|
02/07/2025 11:59:20 - INFO - End of Epoch.
|Epoch 094/100| time: 17.24|
|Def Loss 0.0246 | Def Reward in ep 096|
|Att Loss 0.0257 | Att Reward in ep 004|
|Def Estimated: [ 7 23 20 36 14]| Att Labels: [ 7 22 19 36 16]|
|Def Amount of true predicted attacks: [ 7 21 19 35 14]|
02/07/2025 11:59:37 - INFO - End of Epoch.
|Epoch 095/100| time: 17.36|
|Def Loss 0.0256 | Def Reward in ep 099|
|Att Loss 0.0291 | Att Reward in ep 001|
|Def Estimated: [ 7 19 25 28 21]| Att Labels: [ 6 19 26 28 21]|
|Def Amount of true predicted attacks: [ 6 19 25 28 21]|
02/07/2025 11:59:55 - INFO - End of Epoch.
|Epoch 096/100| time: 17.25|
|Def Loss 0.0298 | Def Reward in ep 093|
|Att Loss 0.0268 | Att Reward in ep 007|
|Def Estimated: [ 9 23 26 28 14]| Att Labels: [11 22 25 31 11]|
|Def Amount of true predicted attacks: [ 9 22 24 27 11]|
02/07/2025 12:00:12 - INFO - End of Epoch.
|Epoch 097/100| time: 17.48|
|Def Loss 0.0151 | Def Reward in ep 096|
|Att Loss 0.0354 | Att Reward in ep 004|
|Def Estimated: [14 20 22 31 13]| Att Labels: [14 21 20 32 13]|
|Def Amount of true predicted attacks: [13 20 20 30 13]|
02/07/2025 12:00:30 - INFO - End of Epoch.
|Epoch 098/100| time: 17.66|
|Def Loss 0.0135 | Def Reward in ep 097|
|Att Loss 0.0287 | Att Reward in ep 003|
|Def Estimated: [ 6 18 27 34 15]| Att Labels: [ 6 16 28 34 16]|
|Def Amount of true predicted attacks: [ 6 16 27 33 15]|
02/07/2025 12:00:47 - INFO - End of Epoch.
|Epoch 099/100| time: 17.36|
|Def Loss 0.0108 | Def Reward in ep 095|
|Att Loss 0.0313 | Att Reward in ep 005|
|Def Estimated: [12 17 22 26 23]| Att Labels: [14 17 23 25 21]|
|Def Amount of true predicted attacks: [12 17 22 24 20]|
02/07/2025 12:00:47 - INFO - Model 'attacker_model' saved in: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-02-07-11-32-WIN-all-attacks-lr-0.001/attacker_model.keras
02/07/2025 12:00:47 - INFO - Model summary:
Model: "attacker_model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense (Dense)               (None, 100)               12300     
                                                                 
 dense_1 (Dense)             (None, 23)                2323      
                                                                 
=================================================================
Total params: 14,623
Trainable params: 14,623
Non-trainable params: 0
_________________________________________________________________

02/07/2025 12:00:47 - INFO - Model 'defender_model' saved in: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-02-07-11-32-WIN-all-attacks-lr-0.001/defender_model.keras
02/07/2025 12:00:47 - INFO - Model summary:
Model: "defender_model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense_4 (Dense)             (None, 100)               12300     
                                                                 
 dense_5 (Dense)             (None, 100)               10100     
                                                                 
 dense_6 (Dense)             (None, 100)               10100     
                                                                 
 dense_7 (Dense)             (None, 5)                 505       
                                                                 
=================================================================
Total params: 33,005
Trainable params: 33,005
Non-trainable params: 0
_________________________________________________________________

02/07/2025 12:00:47 - INFO - Saved trained models.
02/07/2025 12:00:47 - INFO - Total runtime: 00:28:08
02/07/2025 12:00:47 - INFO - End of the script at: 2025-02-07 12:00:47.877438
02/07/2025 12:00:47 - INFO - Trying to save summary plots under: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-02-07-11-32-WIN-all-attacks-lr-0.001/plots/
02/07/2025 12:00:48 - WARNING - The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
02/07/2025 12:00:49 - INFO - Plotted rewards and losses during training in: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-02-07-11-32-WIN-all-attacks-lr-0.001/plots/
02/07/2025 12:00:51 - INFO - Plotted attack distributions during training in: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-02-07-11-32-WIN-all-attacks-lr-0.001/plots/
02/07/2025 12:00:51 - INFO - Start testing the trained model.
02/07/2025 12:00:51 - INFO - Model 'defender_model' loaded from: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-02-07-11-32-WIN-all-attacks-lr-0.001/defender_model.keras
02/07/2025 12:00:51 - INFO - Model summary:
Model: "defender_model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense_4 (Dense)             (None, 100)               12300     
                                                                 
 dense_5 (Dense)             (None, 100)               10100     
                                                                 
 dense_6 (Dense)             (None, 100)               10100     
                                                                 
 dense_7 (Dense)             (None, 5)                 505       
                                                                 
=================================================================
Total params: 33,005
Trainable params: 33,005
Non-trainable params: 0
_________________________________________________________________

02/07/2025 12:00:51 - INFO - Reading formated test data from: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\data/datasets/formated/formated_test_adv.csv
02/07/2025 12:00:53 - INFO - Overall overview
Total reward: 17836 | Number of samples: 22544 | Accuracy = 79.12%
02/07/2025 12:00:53 - INFO - Overall overview per attack type
        Estimated Correct Total   F1_score Mismatch
normal      11814    9129  9711    84.8223     2103
DoS          7044    6424  7458  88.594677      414
Probe        2414    1706  2421  70.568769        7
R2L          1031     537  2754  28.375165     1723
U2R           241      40   200   18.14059       41
General                          77.052376         
02/07/2025 12:00:53 - INFO - Performance measures on Test data
02/07/2025 12:00:53 - INFO - Accuracy =  0.7912
02/07/2025 12:00:53 - INFO - F1 =  0.7705
02/07/2025 12:00:53 - INFO - Precision_score =  0.7756
02/07/2025 12:00:53 - INFO - recall_score =  0.7912
02/07/2025 12:00:53 - INFO - Normalized confusion matrix
02/07/2025 12:00:53 - INFO - 
Confusion Matrix:
[[0.94 0.02 0.03 0.   0.01]
 [0.04 0.86 0.04 0.05 0.  ]
 [0.13 0.14 0.7  0.02 0.  ]
 [0.72 0.04 0.01 0.19 0.04]
 [0.43 0.01 0.26 0.1  0.2 ]]
02/07/2025 12:00:53 - INFO - Plotted confusion matrix in: E:\vlad9\Documents\VisualStudioCodeProjects\AE-RL-Python\models/trained-models/2025-02-07-11-32-WIN-all-attacks-lr-0.001/plots/
02/07/2025 12:00:55 - INFO - 
One vs All metrics: 
     name  accuracy        f1 precision    recall
0  normal  0.855083  0.848223  0.772727  0.940068
1     DoS  0.926632  0.885947  0.911982  0.861357
2     R2L  0.879746  0.283752  0.520854  0.194989
3   Probe  0.936879  0.705688  0.706711  0.704667
4     U2R  0.983987  0.181406  0.165975       0.2
02/07/2025 12:00:56 - INFO - Model metrics: 
loss=0.07143863290548325, accuracy=0.7911639213562012, precision=0.6656383275985718, recall=0.8231014609336853
02/07/2025 12:00:56 - INFO - Time needed for testing: 5.4097816944122314
