04/23/2025 14:22:58 - INFO - Started script at: 2025-04-23-14-22
Current working dir: /workspace
Used data files: 
/workspace/data/datasets/cic_ids/cic-ids-2017/clean/all_benign.feather,
/workspace/data/datasets/cic_ids/cic-ids-2017/clean/all_malicious.feather
04/23/2025 14:22:58 - INFO - Setting up Attacker and Defender Agents...
04/23/2025 14:23:23 - INFO - One-vs-All Split ready (target: (D)DOS):
04/23/2025 14:23:23 - INFO - Train: (58360, 67), Validation: (349248, 67), Test: (814915, 67)
04/23/2025 14:23:23 - INFO - [Init from split] Loaded 58360 train, 814915 test samples.
04/23/2025 14:23:26 - INFO - One-vs-All Split ready (target: (D)DOS):
04/23/2025 14:23:26 - INFO - Train: (56602, 67), Validation: (122271, 67), Test: (692869, 67)
04/23/2025 14:23:26 - INFO - Initializing Attacker:CIC-2017-(D)DOS's ReplayMemory with observation_size=67 and max_size=1000
04/23/2025 14:23:27 - WARNING - Skipping variable loading for optimizer 'Adam', because it has 25 variables whereas the saved optimizer has 1 variables. 
04/23/2025 14:23:27 - INFO - Initializing Defender's ReplayMemory with observation_size=67 and max_size=1000
04/23/2025 14:23:27 - WARNING - Skipping variable loading for optimizer 'Adam', because it has 17 variables whereas the saved optimizer has 1 variables. 
04/23/2025 14:23:27 - INFO - Creating environment...
04/23/2025 14:23:27 - INFO - Start Training with the following parameters:
-----------------------------------------------------------------------------------------------------------------------
Total episodes: 100 | Iterations in episode: 100 | Minibatch from mem size: 100 | Total Samples: 10000 | Data shape: (58360, 67)
-----------------------------------------------------------------------------------------------------------------------
Attacker<Attack-Type>: Num_actions=8 | gamma=0.001 | epsilon=1 | ANN hidden size=100 | ANN hidden layers=5 | Learning rate=0.001
-----------------------------------------------------------------------------------------------------------------------
Defender: Num_actions=2 | gamma=0.001 | epsilon=1 | ANN hidden size=100 | ANN hidden layers=3 | Learning rate=0.001
-----------------------------------------------------------------------------------------------------------------------
Used Attack types: '['Benign', '(D)DOS']' | Attack name(s): ['Benign', 'DDOS attack HOIC', 'DDOS attack LOIC UDP', 'DDoS attacks LOIC HTTP', 'DoS attacks GoldenEye', 'DoS attacks Hulk', 'DoS attacks SlowHTTPTest', 'DoS attacks Slowloris']
-----------------------------------------------------------------------------------------------------------------------

04/23/2025 14:23:27 - INFO - End of Episode.
|Episode 000/100| time: 0.34|
|Def Loss 0.0000 | Def Reward in ep 045|
|Att Loss 0.0000 | Att Reward in ep 055|
|Def Estimated: [52 48]| Att Labels: [ 7 93]|
|Def Amount of true predicted attacks: [ 2 43]|
04/23/2025 14:23:30 - WARNING - 5 out of the last 9 calls to <function QNetwork.predict at 0x750152b3c2c0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
04/23/2025 14:23:30 - WARNING - 6 out of the last 10 calls to <function QNetwork.predict at 0x7501522476a0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
04/23/2025 14:23:35 - INFO - End of Episode.
|Episode 001/100| time: 6.18|
|Def Loss 1.5559 | Def Reward in ep 062|
|Att Loss 1.6499 | Att Reward in ep 038|
|Def Estimated: [44 56]| Att Labels: [18 82]|
|Def Amount of true predicted attacks: [12 50]|
04/23/2025 14:23:39 - INFO - End of Episode.
|Episode 002/100| time: 4.38|
|Def Loss 0.0461 | Def Reward in ep 081|
|Att Loss 1.4233 | Att Reward in ep 019|
|Def Estimated: [28 72]| Att Labels: [11 89]|
|Def Amount of true predicted attacks: [10 71]|
04/23/2025 14:23:44 - INFO - End of Episode.
|Episode 003/100| time: 4.04|
|Def Loss 0.0651 | Def Reward in ep 089|
|Att Loss 1.2712 | Att Reward in ep 011|
|Def Estimated: [17 83]| Att Labels: [14 86]|
|Def Amount of true predicted attacks: [10 79]|
04/23/2025 14:23:48 - INFO - End of Episode.
|Episode 004/100| time: 4.21|
|Def Loss 0.0765 | Def Reward in ep 090|
|Att Loss 1.1613 | Att Reward in ep 010|
|Def Estimated: [26 74]| Att Labels: [22 78]|
|Def Amount of true predicted attacks: [19 71]|
04/23/2025 14:23:53 - INFO - End of Episode.
|Episode 005/100| time: 4.23|
|Def Loss 0.0706 | Def Reward in ep 097|
|Att Loss 1.0251 | Att Reward in ep 003|
|Def Estimated: [20 80]| Att Labels: [23 77]|
|Def Amount of true predicted attacks: [20 77]|
04/23/2025 14:23:57 - INFO - End of Episode.
|Episode 006/100| time: 4.19|
|Def Loss 0.0703 | Def Reward in ep 098|
|Att Loss 0.9244 | Att Reward in ep 002|
|Def Estimated: [14 86]| Att Labels: [16 84]|
|Def Amount of true predicted attacks: [14 84]|
04/23/2025 14:24:02 - INFO - End of Episode.
|Episode 007/100| time: 4.22|
|Def Loss 0.0494 | Def Reward in ep 099|
|Att Loss 0.8074 | Att Reward in ep 001|
|Def Estimated: [18 82]| Att Labels: [19 81]|
|Def Amount of true predicted attacks: [18 81]|
04/23/2025 14:24:06 - INFO - End of Episode.
|Episode 008/100| time: 4.35|
|Def Loss 0.0392 | Def Reward in ep 099|
|Att Loss 0.7646 | Att Reward in ep 001|
|Def Estimated: [14 86]| Att Labels: [15 85]|
|Def Amount of true predicted attacks: [14 85]|
04/23/2025 14:24:11 - INFO - End of Episode.
|Episode 009/100| time: 4.27|
|Def Loss 0.0499 | Def Reward in ep 099|
|Att Loss 0.6915 | Att Reward in ep 001|
|Def Estimated: [16 84]| Att Labels: [17 83]|
|Def Amount of true predicted attacks: [16 83]|
04/23/2025 14:24:16 - INFO - End of Episode.
|Episode 010/100| time: 4.33|
|Def Loss 0.0527 | Def Reward in ep 099|
|Att Loss 0.5394 | Att Reward in ep 001|
|Def Estimated: [25 75]| Att Labels: [24 76]|
|Def Amount of true predicted attacks: [24 75]|
04/23/2025 14:24:20 - INFO - End of Episode.
|Episode 011/100| time: 4.27|
|Def Loss 0.0419 | Def Reward in ep 099|
|Att Loss 0.3332 | Att Reward in ep 001|
|Def Estimated: [16 84]| Att Labels: [15 85]|
|Def Amount of true predicted attacks: [15 84]|
04/23/2025 14:24:25 - INFO - End of Episode.
|Episode 012/100| time: 4.29|
|Def Loss 0.0442 | Def Reward in ep 097|
|Att Loss 0.1657 | Att Reward in ep 003|
|Def Estimated: [18 82]| Att Labels: [19 81]|
|Def Amount of true predicted attacks: [17 80]|
04/23/2025 14:24:30 - INFO - End of Episode.
|Episode 013/100| time: 4.26|
|Def Loss 0.0328 | Def Reward in ep 100|
|Att Loss 0.0972 | Att Reward in ep 000|
|Def Estimated: [16 84]| Att Labels: [16 84]|
|Def Amount of true predicted attacks: [16 84]|
04/23/2025 14:24:35 - INFO - End of Episode.
|Episode 014/100| time: 4.24|
|Def Loss 0.0288 | Def Reward in ep 100|
|Att Loss 0.0591 | Att Reward in ep 000|
|Def Estimated: [15 85]| Att Labels: [15 85]|
|Def Amount of true predicted attacks: [15 85]|
04/23/2025 14:24:39 - INFO - End of Episode.
|Episode 015/100| time: 4.27|
|Def Loss 0.0215 | Def Reward in ep 100|
|Att Loss 0.0414 | Att Reward in ep 000|
|Def Estimated: [24 76]| Att Labels: [24 76]|
|Def Amount of true predicted attacks: [24 76]|
04/23/2025 14:24:44 - INFO - End of Episode.
|Episode 016/100| time: 4.33|
|Def Loss 0.0375 | Def Reward in ep 095|
|Att Loss 0.0320 | Att Reward in ep 005|
|Def Estimated: [19 81]| Att Labels: [20 80]|
|Def Amount of true predicted attacks: [17 78]|
04/23/2025 14:24:49 - INFO - End of Episode.
|Episode 017/100| time: 4.31|
|Def Loss 0.0304 | Def Reward in ep 100|
|Att Loss 0.0281 | Att Reward in ep 000|
|Def Estimated: [22 78]| Att Labels: [22 78]|
|Def Amount of true predicted attacks: [22 78]|
04/23/2025 14:24:54 - INFO - End of Episode.
|Episode 018/100| time: 4.28|
|Def Loss 0.0397 | Def Reward in ep 097|
|Att Loss 0.0410 | Att Reward in ep 003|
|Def Estimated: [22 78]| Att Labels: [21 79]|
|Def Amount of true predicted attacks: [20 77]|
04/23/2025 14:24:58 - INFO - End of Episode.
|Episode 019/100| time: 4.26|
|Def Loss 0.0403 | Def Reward in ep 099|
|Att Loss 0.0523 | Att Reward in ep 001|
|Def Estimated: [18 82]| Att Labels: [17 83]|
|Def Amount of true predicted attacks: [17 82]|
04/23/2025 14:25:03 - INFO - End of Episode.
|Episode 020/100| time: 4.33|
|Def Loss 0.0373 | Def Reward in ep 098|
|Att Loss 0.0530 | Att Reward in ep 002|
|Def Estimated: [25 75]| Att Labels: [23 77]|
|Def Amount of true predicted attacks: [23 75]|
04/23/2025 14:25:08 - INFO - End of Episode.
|Episode 021/100| time: 4.32|
|Def Loss 0.0295 | Def Reward in ep 096|
|Att Loss 0.0562 | Att Reward in ep 004|
|Def Estimated: [26 74]| Att Labels: [24 76]|
|Def Amount of true predicted attacks: [23 73]|
04/23/2025 14:25:13 - INFO - End of Episode.
|Episode 022/100| time: 4.32|
|Def Loss 0.0268 | Def Reward in ep 100|
|Att Loss 0.0386 | Att Reward in ep 000|
|Def Estimated: [17 83]| Att Labels: [17 83]|
|Def Amount of true predicted attacks: [17 83]|
04/23/2025 14:25:18 - INFO - End of Episode.
|Episode 023/100| time: 4.33|
|Def Loss 0.0286 | Def Reward in ep 099|
|Att Loss 0.0438 | Att Reward in ep 001|
|Def Estimated: [23 77]| Att Labels: [22 78]|
|Def Amount of true predicted attacks: [22 77]|
04/23/2025 14:25:23 - INFO - End of Episode.
|Episode 024/100| time: 4.37|
|Def Loss 0.0258 | Def Reward in ep 100|
|Att Loss 0.0550 | Att Reward in ep 000|
|Def Estimated: [26 74]| Att Labels: [26 74]|
|Def Amount of true predicted attacks: [26 74]|
04/23/2025 14:25:28 - INFO - End of Episode.
|Episode 025/100| time: 4.28|
|Def Loss 0.0310 | Def Reward in ep 099|
|Att Loss 0.0597 | Att Reward in ep 001|
|Def Estimated: [16 84]| Att Labels: [15 85]|
|Def Amount of true predicted attacks: [15 84]|
04/23/2025 14:25:33 - INFO - End of Episode.
|Episode 026/100| time: 4.32|
|Def Loss 0.0214 | Def Reward in ep 100|
|Att Loss 0.0378 | Att Reward in ep 000|
|Def Estimated: [19 81]| Att Labels: [19 81]|
|Def Amount of true predicted attacks: [19 81]|
04/23/2025 14:25:38 - INFO - End of Episode.
|Episode 027/100| time: 4.31|
|Def Loss 0.0197 | Def Reward in ep 100|
|Att Loss 0.0468 | Att Reward in ep 000|
|Def Estimated: [25 75]| Att Labels: [25 75]|
|Def Amount of true predicted attacks: [25 75]|
04/23/2025 14:25:43 - INFO - End of Episode.
|Episode 028/100| time: 4.35|
|Def Loss 0.0123 | Def Reward in ep 099|
|Att Loss 0.0363 | Att Reward in ep 001|
|Def Estimated: [25 75]| Att Labels: [24 76]|
|Def Amount of true predicted attacks: [24 75]|
04/23/2025 14:25:48 - INFO - End of Episode.
|Episode 029/100| time: 4.30|
|Def Loss 0.0084 | Def Reward in ep 098|
|Att Loss 0.0377 | Att Reward in ep 002|
|Def Estimated: [17 83]| Att Labels: [19 81]|
|Def Amount of true predicted attacks: [17 81]|
04/23/2025 14:25:53 - INFO - End of Episode.
|Episode 030/100| time: 4.38|
|Def Loss 0.0054 | Def Reward in ep 099|
|Att Loss 0.0306 | Att Reward in ep 001|
|Def Estimated: [22 78]| Att Labels: [23 77]|
|Def Amount of true predicted attacks: [22 77]|
04/23/2025 14:25:58 - INFO - End of Episode.
|Episode 031/100| time: 4.29|
|Def Loss 0.0037 | Def Reward in ep 100|
|Att Loss 0.0309 | Att Reward in ep 000|
|Def Estimated: [19 81]| Att Labels: [19 81]|
|Def Amount of true predicted attacks: [19 81]|
04/23/2025 14:26:03 - INFO - End of Episode.
|Episode 032/100| time: 4.32|
|Def Loss 0.0013 | Def Reward in ep 099|
|Att Loss 0.0232 | Att Reward in ep 001|
|Def Estimated: [19 81]| Att Labels: [18 82]|
|Def Amount of true predicted attacks: [18 81]|
04/23/2025 14:26:08 - INFO - End of Episode.
|Episode 033/100| time: 4.33|
|Def Loss 0.0008 | Def Reward in ep 099|
|Att Loss 0.0143 | Att Reward in ep 001|
|Def Estimated: [26 74]| Att Labels: [25 75]|
|Def Amount of true predicted attacks: [25 74]|
04/23/2025 14:26:13 - INFO - End of Episode.
|Episode 034/100| time: 4.30|
|Def Loss 0.0010 | Def Reward in ep 100|
|Att Loss 0.0251 | Att Reward in ep 000|
|Def Estimated: [22 78]| Att Labels: [22 78]|
|Def Amount of true predicted attacks: [22 78]|
04/23/2025 14:26:18 - INFO - End of Episode.
|Episode 035/100| time: 4.30|
|Def Loss 0.0004 | Def Reward in ep 096|
|Att Loss 0.0236 | Att Reward in ep 004|
|Def Estimated: [19 81]| Att Labels: [15 85]|
|Def Amount of true predicted attacks: [15 81]|
04/23/2025 14:26:23 - INFO - End of Episode.
|Episode 036/100| time: 4.30|
|Def Loss 0.0003 | Def Reward in ep 100|
|Att Loss 0.0300 | Att Reward in ep 000|
|Def Estimated: [17 83]| Att Labels: [17 83]|
|Def Amount of true predicted attacks: [17 83]|
04/23/2025 14:26:28 - INFO - End of Episode.
|Episode 037/100| time: 4.31|
|Def Loss 0.0002 | Def Reward in ep 100|
|Att Loss 0.0271 | Att Reward in ep 000|
|Def Estimated: [18 82]| Att Labels: [18 82]|
|Def Amount of true predicted attacks: [18 82]|
04/23/2025 14:26:33 - INFO - End of Episode.
|Episode 038/100| time: 4.36|
|Def Loss 0.0003 | Def Reward in ep 098|
|Att Loss 0.0337 | Att Reward in ep 002|
|Def Estimated: [19 81]| Att Labels: [19 81]|
|Def Amount of true predicted attacks: [18 80]|
04/23/2025 14:26:38 - INFO - End of Episode.
|Episode 039/100| time: 4.34|
|Def Loss 0.0050 | Def Reward in ep 099|
|Att Loss 0.0414 | Att Reward in ep 001|
|Def Estimated: [19 81]| Att Labels: [20 80]|
|Def Amount of true predicted attacks: [19 80]|
04/23/2025 14:26:43 - INFO - End of Episode.
|Episode 040/100| time: 4.30|
|Def Loss 0.0003 | Def Reward in ep 099|
|Att Loss 0.0372 | Att Reward in ep 001|
|Def Estimated: [18 82]| Att Labels: [17 83]|
|Def Amount of true predicted attacks: [17 82]|
04/23/2025 14:26:48 - INFO - End of Episode.
|Episode 041/100| time: 4.34|
|Def Loss 0.0002 | Def Reward in ep 100|
|Att Loss 0.0457 | Att Reward in ep 000|
|Def Estimated: [22 78]| Att Labels: [22 78]|
|Def Amount of true predicted attacks: [22 78]|
04/23/2025 14:26:54 - INFO - End of Episode.
|Episode 042/100| time: 4.34|
|Def Loss 0.0002 | Def Reward in ep 099|
|Att Loss 0.0426 | Att Reward in ep 001|
|Def Estimated: [22 78]| Att Labels: [21 79]|
|Def Amount of true predicted attacks: [21 78]|
04/23/2025 14:26:59 - INFO - End of Episode.
|Episode 043/100| time: 4.28|
|Def Loss 0.0002 | Def Reward in ep 100|
|Att Loss 0.0493 | Att Reward in ep 000|
|Def Estimated: [11 89]| Att Labels: [11 89]|
|Def Amount of true predicted attacks: [11 89]|
04/23/2025 14:27:04 - INFO - End of Episode.
|Episode 044/100| time: 4.33|
|Def Loss 0.0002 | Def Reward in ep 099|
|Att Loss 0.0463 | Att Reward in ep 001|
|Def Estimated: [16 84]| Att Labels: [17 83]|
|Def Amount of true predicted attacks: [16 83]|
04/23/2025 14:27:09 - INFO - End of Episode.
|Episode 045/100| time: 4.32|
|Def Loss 0.0055 | Def Reward in ep 099|
|Att Loss 0.0395 | Att Reward in ep 001|
|Def Estimated: [20 80]| Att Labels: [21 79]|
|Def Amount of true predicted attacks: [20 79]|
04/23/2025 14:27:14 - INFO - End of Episode.
|Episode 046/100| time: 4.33|
|Def Loss 0.0005 | Def Reward in ep 098|
|Att Loss 0.0309 | Att Reward in ep 002|
|Def Estimated: [17 83]| Att Labels: [15 85]|
|Def Amount of true predicted attacks: [15 83]|
04/23/2025 14:27:20 - INFO - End of Episode.
|Episode 047/100| time: 4.30|
|Def Loss 0.0001 | Def Reward in ep 099|
|Att Loss 0.0374 | Att Reward in ep 001|
|Def Estimated: [12 88]| Att Labels: [11 89]|
|Def Amount of true predicted attacks: [11 88]|
04/23/2025 14:27:25 - INFO - End of Episode.
|Episode 048/100| time: 4.33|
|Def Loss 0.0003 | Def Reward in ep 099|
|Att Loss 0.0317 | Att Reward in ep 001|
|Def Estimated: [25 75]| Att Labels: [26 74]|
|Def Amount of true predicted attacks: [25 74]|
04/23/2025 14:27:30 - INFO - End of Episode.
|Episode 049/100| time: 4.34|
|Def Loss 0.0005 | Def Reward in ep 100|
|Att Loss 0.0394 | Att Reward in ep 000|
|Def Estimated: [17 83]| Att Labels: [17 83]|
|Def Amount of true predicted attacks: [17 83]|
04/23/2025 14:27:35 - INFO - End of Episode.
|Episode 050/100| time: 4.29|
|Def Loss 0.0001 | Def Reward in ep 100|
|Att Loss 0.0373 | Att Reward in ep 000|
|Def Estimated: [13 87]| Att Labels: [13 87]|
|Def Amount of true predicted attacks: [13 87]|
04/23/2025 14:27:41 - INFO - End of Episode.
|Episode 051/100| time: 4.32|
|Def Loss 0.0029 | Def Reward in ep 099|
|Att Loss 0.0334 | Att Reward in ep 001|
|Def Estimated: [17 83]| Att Labels: [18 82]|
|Def Amount of true predicted attacks: [17 82]|
04/23/2025 14:27:46 - INFO - End of Episode.
|Episode 052/100| time: 4.34|
|Def Loss 0.0003 | Def Reward in ep 098|
|Att Loss 0.0325 | Att Reward in ep 002|
|Def Estimated: [21 79]| Att Labels: [19 81]|
|Def Amount of true predicted attacks: [19 79]|
04/23/2025 14:27:51 - INFO - End of Episode.
|Episode 053/100| time: 4.32|
|Def Loss 0.0003 | Def Reward in ep 099|
|Att Loss 0.0361 | Att Reward in ep 001|
|Def Estimated: [19 81]| Att Labels: [18 82]|
|Def Amount of true predicted attacks: [18 81]|
04/23/2025 14:27:57 - INFO - End of Episode.
|Episode 054/100| time: 4.30|
|Def Loss 0.0001 | Def Reward in ep 099|
|Att Loss 0.0357 | Att Reward in ep 001|
|Def Estimated: [13 87]| Att Labels: [14 86]|
|Def Amount of true predicted attacks: [13 86]|
04/23/2025 14:28:02 - INFO - End of Episode.
|Episode 055/100| time: 4.28|
|Def Loss 0.0006 | Def Reward in ep 100|
|Att Loss 0.0446 | Att Reward in ep 000|
|Def Estimated: [14 86]| Att Labels: [14 86]|
|Def Amount of true predicted attacks: [14 86]|
04/23/2025 14:28:07 - INFO - End of Episode.
|Episode 056/100| time: 4.31|
|Def Loss 0.0003 | Def Reward in ep 099|
|Att Loss 0.0397 | Att Reward in ep 001|
|Def Estimated: [16 84]| Att Labels: [17 83]|
|Def Amount of true predicted attacks: [16 83]|
04/23/2025 14:28:13 - INFO - End of Episode.
|Episode 057/100| time: 4.32|
|Def Loss 0.0001 | Def Reward in ep 100|
|Att Loss 0.0345 | Att Reward in ep 000|
|Def Estimated: [22 78]| Att Labels: [22 78]|
|Def Amount of true predicted attacks: [22 78]|
04/23/2025 14:28:18 - INFO - End of Episode.
|Episode 058/100| time: 4.24|
|Def Loss 0.0003 | Def Reward in ep 098|
|Att Loss 0.0409 | Att Reward in ep 002|
|Def Estimated: [27 73]| Att Labels: [25 75]|
|Def Amount of true predicted attacks: [25 73]|
04/23/2025 14:28:23 - INFO - End of Episode.
|Episode 059/100| time: 4.22|
|Def Loss 0.0017 | Def Reward in ep 099|
|Att Loss 0.0405 | Att Reward in ep 001|
|Def Estimated: [25 75]| Att Labels: [26 74]|
|Def Amount of true predicted attacks: [25 74]|
04/23/2025 14:28:28 - INFO - End of Episode.
|Episode 060/100| time: 4.20|
|Def Loss 0.0002 | Def Reward in ep 100|
|Att Loss 0.0424 | Att Reward in ep 000|
|Def Estimated: [17 83]| Att Labels: [17 83]|
|Def Amount of true predicted attacks: [17 83]|
04/23/2025 14:28:34 - INFO - End of Episode.
|Episode 061/100| time: 4.18|
|Def Loss 0.0001 | Def Reward in ep 099|
|Att Loss 0.0380 | Att Reward in ep 001|
|Def Estimated: [19 81]| Att Labels: [18 82]|
|Def Amount of true predicted attacks: [18 81]|
04/23/2025 14:28:39 - INFO - End of Episode.
|Episode 062/100| time: 4.18|
|Def Loss 0.0006 | Def Reward in ep 100|
|Att Loss 0.0430 | Att Reward in ep 000|
|Def Estimated: [19 81]| Att Labels: [19 81]|
|Def Amount of true predicted attacks: [19 81]|
04/23/2025 14:28:44 - INFO - End of Episode.
|Episode 063/100| time: 4.12|
|Def Loss 0.0013 | Def Reward in ep 099|
|Att Loss 0.0323 | Att Reward in ep 001|
|Def Estimated: [15 85]| Att Labels: [14 86]|
|Def Amount of true predicted attacks: [14 85]|
04/23/2025 14:28:50 - INFO - End of Episode.
|Episode 064/100| time: 4.16|
|Def Loss 0.0003 | Def Reward in ep 100|
|Att Loss 0.0337 | Att Reward in ep 000|
|Def Estimated: [17 83]| Att Labels: [17 83]|
|Def Amount of true predicted attacks: [17 83]|
04/23/2025 14:28:55 - INFO - End of Episode.
|Episode 065/100| time: 4.12|
|Def Loss 0.0032 | Def Reward in ep 099|
|Att Loss 0.0411 | Att Reward in ep 001|
|Def Estimated: [12 88]| Att Labels: [11 89]|
|Def Amount of true predicted attacks: [11 88]|
04/23/2025 14:29:00 - INFO - End of Episode.
|Episode 066/100| time: 4.15|
|Def Loss 0.0023 | Def Reward in ep 099|
|Att Loss 0.0314 | Att Reward in ep 001|
|Def Estimated: [12 88]| Att Labels: [11 89]|
|Def Amount of true predicted attacks: [11 88]|
04/23/2025 14:29:06 - INFO - End of Episode.
|Episode 067/100| time: 4.16|
|Def Loss 0.0076 | Def Reward in ep 099|
|Att Loss 0.0367 | Att Reward in ep 001|
|Def Estimated: [14 86]| Att Labels: [15 85]|
|Def Amount of true predicted attacks: [14 85]|
04/23/2025 14:29:11 - INFO - End of Episode.
|Episode 068/100| time: 4.16|
|Def Loss 0.0001 | Def Reward in ep 100|
|Att Loss 0.0300 | Att Reward in ep 000|
|Def Estimated: [14 86]| Att Labels: [14 86]|
|Def Amount of true predicted attacks: [14 86]|
04/23/2025 14:29:16 - INFO - End of Episode.
|Episode 069/100| time: 4.16|
|Def Loss 0.0002 | Def Reward in ep 100|
|Att Loss 0.0280 | Att Reward in ep 000|
|Def Estimated: [15 85]| Att Labels: [15 85]|
|Def Amount of true predicted attacks: [15 85]|
04/23/2025 14:29:22 - INFO - End of Episode.
|Episode 070/100| time: 4.14|
|Def Loss 0.0001 | Def Reward in ep 100|
|Att Loss 0.0250 | Att Reward in ep 000|
|Def Estimated: [13 87]| Att Labels: [13 87]|
|Def Amount of true predicted attacks: [13 87]|
04/23/2025 14:29:27 - INFO - End of Episode.
|Episode 071/100| time: 4.14|
|Def Loss 0.0002 | Def Reward in ep 099|
|Att Loss 0.0247 | Att Reward in ep 001|
|Def Estimated: [15 85]| Att Labels: [14 86]|
|Def Amount of true predicted attacks: [14 85]|
04/23/2025 14:29:32 - INFO - End of Episode.
|Episode 072/100| time: 4.15|
|Def Loss 0.0004 | Def Reward in ep 099|
|Att Loss 0.0280 | Att Reward in ep 001|
|Def Estimated: [10 90]| Att Labels: [ 9 91]|
|Def Amount of true predicted attacks: [ 9 90]|
04/23/2025 14:29:38 - INFO - End of Episode.
|Episode 073/100| time: 4.15|
|Def Loss 0.0003 | Def Reward in ep 100|
|Att Loss 0.0176 | Att Reward in ep 000|
|Def Estimated: [14 86]| Att Labels: [14 86]|
|Def Amount of true predicted attacks: [14 86]|
04/23/2025 14:29:43 - INFO - End of Episode.
|Episode 074/100| time: 4.15|
|Def Loss 0.0019 | Def Reward in ep 099|
|Att Loss 0.0233 | Att Reward in ep 001|
|Def Estimated: [17 83]| Att Labels: [16 84]|
|Def Amount of true predicted attacks: [16 83]|
04/23/2025 14:29:49 - INFO - End of Episode.
|Episode 075/100| time: 4.17|
|Def Loss 0.0026 | Def Reward in ep 098|
|Att Loss 0.0329 | Att Reward in ep 002|
|Def Estimated: [20 80]| Att Labels: [18 82]|
|Def Amount of true predicted attacks: [18 80]|
04/23/2025 14:29:54 - INFO - End of Episode.
|Episode 076/100| time: 4.14|
|Def Loss 0.0028 | Def Reward in ep 098|
|Att Loss 0.0406 | Att Reward in ep 002|
|Def Estimated: [17 83]| Att Labels: [17 83]|
|Def Amount of true predicted attacks: [16 82]|
04/23/2025 14:30:00 - INFO - End of Episode.
|Episode 077/100| time: 4.15|
|Def Loss 0.0002 | Def Reward in ep 100|
|Att Loss 0.0276 | Att Reward in ep 000|
|Def Estimated: [16 84]| Att Labels: [16 84]|
|Def Amount of true predicted attacks: [16 84]|
04/23/2025 14:30:05 - INFO - End of Episode.
|Episode 078/100| time: 4.14|
|Def Loss 0.0002 | Def Reward in ep 097|
|Att Loss 0.0405 | Att Reward in ep 003|
|Def Estimated: [18 82]| Att Labels: [17 83]|
|Def Amount of true predicted attacks: [16 81]|
04/23/2025 14:30:11 - INFO - End of Episode.
|Episode 079/100| time: 4.09|
|Def Loss 0.0001 | Def Reward in ep 100|
|Att Loss 0.0380 | Att Reward in ep 000|
|Def Estimated: [ 9 91]| Att Labels: [ 9 91]|
|Def Amount of true predicted attacks: [ 9 91]|
04/23/2025 14:30:16 - INFO - End of Episode.
|Episode 080/100| time: 4.20|
|Def Loss 0.0001 | Def Reward in ep 100|
|Att Loss 0.0406 | Att Reward in ep 000|
|Def Estimated: [14 86]| Att Labels: [14 86]|
|Def Amount of true predicted attacks: [14 86]|
04/23/2025 14:30:22 - INFO - End of Episode.
|Episode 081/100| time: 4.11|
|Def Loss 0.0047 | Def Reward in ep 099|
|Att Loss 0.0394 | Att Reward in ep 001|
|Def Estimated: [ 7 93]| Att Labels: [ 8 92]|
|Def Amount of true predicted attacks: [ 7 92]|
04/23/2025 14:30:27 - INFO - End of Episode.
|Episode 082/100| time: 4.15|
|Def Loss 0.0004 | Def Reward in ep 100|
|Att Loss 0.0398 | Att Reward in ep 000|
|Def Estimated: [21 79]| Att Labels: [21 79]|
|Def Amount of true predicted attacks: [21 79]|
04/23/2025 14:30:33 - INFO - End of Episode.
|Episode 083/100| time: 4.15|
|Def Loss 0.0002 | Def Reward in ep 100|
|Att Loss 0.0297 | Att Reward in ep 000|
|Def Estimated: [10 90]| Att Labels: [10 90]|
|Def Amount of true predicted attacks: [10 90]|
04/23/2025 14:30:39 - INFO - End of Episode.
|Episode 084/100| time: 4.15|
|Def Loss 0.0002 | Def Reward in ep 100|
|Att Loss 0.0375 | Att Reward in ep 000|
|Def Estimated: [20 80]| Att Labels: [20 80]|
|Def Amount of true predicted attacks: [20 80]|
04/23/2025 14:30:44 - INFO - End of Episode.
|Episode 085/100| time: 4.13|
|Def Loss 0.0002 | Def Reward in ep 099|
|Att Loss 0.0284 | Att Reward in ep 001|
|Def Estimated: [11 89]| Att Labels: [12 88]|
|Def Amount of true predicted attacks: [11 88]|
04/23/2025 14:30:50 - INFO - End of Episode.
|Episode 086/100| time: 4.19|
|Def Loss 0.0003 | Def Reward in ep 100|
|Att Loss 0.0271 | Att Reward in ep 000|
|Def Estimated: [19 81]| Att Labels: [19 81]|
|Def Amount of true predicted attacks: [19 81]|
04/23/2025 14:30:55 - INFO - End of Episode.
|Episode 087/100| time: 4.20|
|Def Loss 0.0002 | Def Reward in ep 100|
|Att Loss 0.0244 | Att Reward in ep 000|
|Def Estimated: [19 81]| Att Labels: [19 81]|
|Def Amount of true predicted attacks: [19 81]|
04/23/2025 14:31:01 - INFO - End of Episode.
|Episode 088/100| time: 4.18|
|Def Loss 0.0067 | Def Reward in ep 099|
|Att Loss 0.0130 | Att Reward in ep 001|
|Def Estimated: [21 79]| Att Labels: [22 78]|
|Def Amount of true predicted attacks: [21 78]|
04/23/2025 14:31:07 - INFO - End of Episode.
|Episode 089/100| time: 4.17|
|Def Loss 0.0002 | Def Reward in ep 100|
|Att Loss 0.0101 | Att Reward in ep 000|
|Def Estimated: [18 82]| Att Labels: [18 82]|
|Def Amount of true predicted attacks: [18 82]|
04/23/2025 14:31:13 - INFO - End of Episode.
|Episode 090/100| time: 4.21|
|Def Loss 0.0001 | Def Reward in ep 100|
|Att Loss 0.0063 | Att Reward in ep 000|
|Def Estimated: [23 77]| Att Labels: [23 77]|
|Def Amount of true predicted attacks: [23 77]|
04/23/2025 14:31:18 - INFO - End of Episode.
|Episode 091/100| time: 4.16|
|Def Loss 0.0001 | Def Reward in ep 100|
|Att Loss 0.0064 | Att Reward in ep 000|
|Def Estimated: [14 86]| Att Labels: [14 86]|
|Def Amount of true predicted attacks: [14 86]|
04/23/2025 14:31:24 - INFO - End of Episode.
|Episode 092/100| time: 4.15|
|Def Loss 0.0004 | Def Reward in ep 100|
|Att Loss 0.0047 | Att Reward in ep 000|
|Def Estimated: [20 80]| Att Labels: [20 80]|
|Def Amount of true predicted attacks: [20 80]|
04/23/2025 14:31:30 - INFO - End of Episode.
|Episode 093/100| time: 4.19|
|Def Loss 0.0001 | Def Reward in ep 098|
|Att Loss 0.0096 | Att Reward in ep 002|
|Def Estimated: [19 81]| Att Labels: [17 83]|
|Def Amount of true predicted attacks: [17 81]|
04/23/2025 14:31:35 - INFO - End of Episode.
|Episode 094/100| time: 4.15|
|Def Loss 0.0001 | Def Reward in ep 100|
|Att Loss 0.0175 | Att Reward in ep 000|
|Def Estimated: [15 85]| Att Labels: [15 85]|
|Def Amount of true predicted attacks: [15 85]|
04/23/2025 14:31:41 - INFO - End of Episode.
|Episode 095/100| time: 4.17|
|Def Loss 0.0058 | Def Reward in ep 099|
|Att Loss 0.0187 | Att Reward in ep 001|
|Def Estimated: [20 80]| Att Labels: [21 79]|
|Def Amount of true predicted attacks: [20 79]|
04/23/2025 14:31:47 - INFO - End of Episode.
|Episode 096/100| time: 4.22|
|Def Loss 0.0197 | Def Reward in ep 097|
|Att Loss 0.0152 | Att Reward in ep 003|
|Def Estimated: [22 78]| Att Labels: [23 77]|
|Def Amount of true predicted attacks: [21 76]|
04/23/2025 14:31:53 - INFO - End of Episode.
|Episode 097/100| time: 4.12|
|Def Loss 0.0163 | Def Reward in ep 100|
|Att Loss 0.0323 | Att Reward in ep 000|
|Def Estimated: [11 89]| Att Labels: [11 89]|
|Def Amount of true predicted attacks: [11 89]|
04/23/2025 14:31:59 - INFO - End of Episode.
|Episode 098/100| time: 4.17|
|Def Loss 0.0152 | Def Reward in ep 100|
|Att Loss 0.0247 | Att Reward in ep 000|
|Def Estimated: [17 83]| Att Labels: [17 83]|
|Def Amount of true predicted attacks: [17 83]|
04/23/2025 14:32:04 - INFO - End of Episode.
|Episode 099/100| time: 4.16|
|Def Loss 0.0129 | Def Reward in ep 100|
|Att Loss 0.0180 | Att Reward in ep 000|
|Def Estimated: [17 83]| Att Labels: [17 83]|
|Def Amount of true predicted attacks: [17 83]|
04/23/2025 14:32:06 - INFO - Model 'attacker_model_cic_2017' saved in: /workspace/models/trained-models/2025-04-23-14-22-Linux-CIC-2017-18-DDOS-3rd-Run/attacker_model_cic.keras
04/23/2025 14:32:06 - INFO - Model summary:
Model: "attacker_model_cic_2017"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense (Dense)               (None, 100)               6800      
                                                                 
 dense_1 (Dense)             (None, 100)               10100     
                                                                 
 dense_2 (Dense)             (None, 100)               10100     
                                                                 
 dense_3 (Dense)             (None, 100)               10100     
                                                                 
 dense_4 (Dense)             (None, 100)               10100     
                                                                 
 dense_5 (Dense)             (None, 8)                 808       
                                                                 
=================================================================
Total params: 48008 (187.53 KB)
Trainable params: 48008 (187.53 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________

04/23/2025 14:32:06 - INFO - Model 'defender_model' saved in: /workspace/models/trained-models/2025-04-23-14-22-Linux-CIC-2017-18-DDOS-3rd-Run/defender_model.keras
04/23/2025 14:32:06 - INFO - Model summary:
Model: "defender_model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense_12 (Dense)            (None, 100)               6800      
                                                                 
 dense_13 (Dense)            (None, 100)               10100     
                                                                 
 dense_14 (Dense)            (None, 100)               10100     
                                                                 
 dense_15 (Dense)            (None, 2)                 202       
                                                                 
=================================================================
Total params: 27202 (106.26 KB)
Trainable params: 27202 (106.26 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________

04/23/2025 14:32:06 - INFO - Saved trained models.
04/23/2025 14:32:06 - INFO - Total runtime: 00:09:07
04/23/2025 14:32:06 - INFO - End of the script at: 2025-04-23 14:32:06.545241
04/23/2025 14:32:31 - INFO - Debug information saved to /workspace/models/trained-models/2025-04-23-14-22-Linux-CIC-2017-18-DDOS-3rd-Run/logs/debug_info.json
04/23/2025 14:32:31 - INFO - Trying to save summary plots under: /workspace/models/trained-models/2025-04-23-14-22-Linux-CIC-2017-18-DDOS-3rd-Run/plots/
04/23/2025 14:32:33 - INFO - Plotted attack distributions during training in: /workspace/models/trained-models/2025-04-23-14-22-Linux-CIC-2017-18-DDOS-3rd-Run/plots/
04/23/2025 14:32:48 - INFO - Normalized confusion matrix
04/23/2025 14:32:48 - INFO - 
Confusion Matrix:
[[0.99074286 0.00925714]
 [0.00493247 0.99506753]]
04/23/2025 14:32:48 - INFO - Plotted confusion matrix in: /workspace/models/trained-models/2025-04-23-14-22-Linux-CIC-2017-18-DDOS-3rd-Run/plots/intraset/
04/23/2025 14:32:48 - INFO - Model summary:
Model: "defender_model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense_12 (Dense)            (None, 100)               6800      
                                                                 
 dense_13 (Dense)            (None, 100)               10100     
                                                                 
 dense_14 (Dense)            (None, 100)               10100     
                                                                 
 dense_15 (Dense)            (None, 2)                 202       
                                                                 
=================================================================
Total params: 27202 (106.26 KB)
Trainable params: 27202 (106.26 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________

loaded from: /workspace/models/trained-models/2025-04-23-14-22-Linux-CIC-2017-18-DDOS-3rd-Run/defender_model.keras
04/23/2025 14:32:49 - INFO - One vs All metric calculation: 
True positive: 671586 | False positive: 1296 | 
True negative: 138704 | False negative: 3329
Accuracy: 0.9943 | Recall: 0.9951 | Specificity: 0.9907 | Precision: 0.9981 | F1-Score: 0.9966 | False Positive Rate: 0.0093
04/23/2025 14:32:49 - INFO - Overall overview
Total reward: 810290 | Number of samples: 814915 | Accuracy = 99.43%
Overall overview per attack type
              Estimated Correct   Total Mismatch   F1_score
Benign           142033  138704  140000     2033  98.360121
(D)DOS           672882  671586  674915     2033  99.656847
Weigthed Avg.                                     99.434074
04/23/2025 14:32:50 - INFO - 
 Class  Support  Accuracy  Precision  Recall  F1-Score
Benign   140000    0.9907     0.9766  0.9907    0.9836
(D)DOS   674915    0.9951     0.9981  0.9951    0.9966
04/23/2025 14:32:50 - INFO - Overall weighted F1-score: 0.9943
04/23/2025 14:33:15 - INFO - 
One vs All metrics: 
     name  accuracy        f1  precision    recall
0  (D)DOS  0.994325  0.996568   0.998074  0.995068
1  Benign  0.994325  0.983601   0.976562  0.990743
04/23/2025 14:33:16 - INFO - Classification report:
              precision    recall  f1-score   support

      Benign       0.98      0.99      0.98    140000
      (D)DOS       1.00      1.00      1.00    674915

    accuracy                           0.99    814915
   macro avg       0.99      0.99      0.99    814915
weighted avg       0.99      0.99      0.99    814915

04/23/2025 14:33:27 - INFO - Model metrics: 
loss=0.011226843111217022, mse=0.030411411076784134, mae=0.07205791771411896
04/23/2025 14:33:27 - INFO - Optimizer config: {'name': 'Adam', 'weight_decay': None, 'clipnorm': None, 'global_clipnorm': None, 'clipvalue': None, 'use_ema': False, 'ema_momentum': 0.99, 'ema_overwrite_frequency': None, 'jit_compile': False, 'is_legacy_optimizer': False, 'learning_rate': 0.001, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
04/23/2025 14:33:27 - INFO - Time needed for testing: 54.10821604728699
04/23/2025 14:33:28 - INFO - Metrics exported to: /workspace/models/trained-models/2025-04-23-14-22-Linux-CIC-2017-18-DDOS-3rd-Run/logs/evaluation_metrics_defender_model.json
04/23/2025 14:33:41 - INFO - [Intra-Set] Accuracy: 0.5570, Recall: 0.1152, Precision: 0.3062, F1: 0.1675
04/23/2025 14:33:41 - INFO - Normalized confusion matrix
04/23/2025 14:33:41 - INFO - 
Confusion Matrix:
[[0.83539765 0.16460235]
 [0.88475337 0.11524663]]
04/23/2025 14:33:41 - INFO - Plotted confusion matrix in: /workspace/models/trained-models/2025-04-23-14-22-Linux-CIC-2017-18-DDOS-3rd-Run/plots/interset/
04/23/2025 14:33:41 - INFO - [Intra-Set] Confusion matrix saved to /workspace/models/trained-models/2025-04-23-14-22-Linux-CIC-2017-18-DDOS-3rd-Run/plots/
04/23/2025 14:33:51 - INFO - [Cross-Set] Model metrics: loss=0.20133274793624878, mse=1.8098878860473633, mae=0.5479625463485718
04/23/2025 14:33:51 - INFO - [Intra-Set] Evaluation completed. Metrics exported to: /workspace/models/trained-models/2025-04-23-14-22-Linux-CIC-2017-18-DDOS-3rd-Run/logs/evaluation_metrics_cross_defender_model.json
04/23/2025 14:33:51 - INFO - [Intra-Set] Time needed: 22.98 seconds
04/23/2025 14:33:51 - INFO - Finished script at: 2025-04-23-14-33
Total runtime: 0:10:52.614167
